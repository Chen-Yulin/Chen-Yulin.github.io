<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta name="theme-color" content="#123456"><title>Tag: AI - Chen Yulin&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#6495ed"><meta name="application-name" content="Icarus - Hexo Theme"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="msapplication-TileColor" content="#6495ed"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Icarus - Hexo Theme"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta property="og:type" content="blog"><meta property="og:title" content="Chen Yulin&#039;s Blog"><meta property="og:url" content="http://chen-yulin.github.io/"><meta property="og:site_name" content="Chen Yulin&#039;s Blog"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://chen-yulin.github.io/img/og_image.png"><meta property="article:author" content="Chen Yulin"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://chen-yulin.github.io/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://chen-yulin.github.io"},"headline":"Chen Yulin's Blog","image":["http://chen-yulin.github.io/img/og_image.png"],"author":{"@type":"Person","name":"Chen Yulin"},"publisher":{"@type":"Organization","name":"Chen Yulin's Blog","logo":{"@type":"ImageObject","url":{"light":"/img/cyllogo.png","dark":"/img/cyllogonight.png"}}},"description":""}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link data-pjax rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-3-column"><svg style="position:absolute;width:0;height:0;" aria-hidden="true"><defs><filter id="liquid-glass-sm" x="-10%" y="-10%" width="120%" height="120%"><feTurbulence type="fractalNoise" baseFrequency="0.015" numOctaves="2" result="noise" seed="5"></feTurbulence><feDisplacementMap in="SourceGraphic" in2="noise" scale="2" xchannelselector="R" ychannelselector="G"></feDisplacementMap></filter></defs></svg><script type="text/javascript" src="/js/imaegoo/night.js"></script><canvas id="universe"></canvas><canvas id="flower"></canvas><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img class="logo-img" src="/img/cyllogo.png" alt="Chen Yulin&#039;s Blog" height="28"><img class="logo-img-dark" src="/img/cyllogonight.png" alt="Chen Yulin&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item night" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/Chen-Yulin"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/tags/">Tags</a></li><li class="is-active"><a href="#" aria-current="page">AI</a></li></ul></nav></div></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2026/01/29/%5BOBS%5DAI-Bayes-Theorem/"><img class="fill" src="/gallery/AI.png" alt="贝叶斯公式详解" referrerpolicy="no-referrer"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2026-01-29T11:15:00.000Z" title="1/29/2026, 7:15:00 PM">2026-01-29</time></span><span class="level-item">Updated&nbsp;<time dateTime="2026-02-14T16:35:53.748Z" title="2/15/2026, 12:35:53 AM">2026-02-15</time></span><span class="level-item"><a class="link-muted" href="/categories/Note/">Note</a></span><span class="level-item">16 minutes read (About 2393 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2026/01/29/%5BOBS%5DAI-Bayes-Theorem/">贝叶斯公式详解</a></p><div class="content"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.0/dist/css/lightgallery.min.css" /><div class=".article-gallery"><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Bayes%27_theorem">Bayes’ Theorem</a> | <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Bayesian_inference">Bayesian Inference</a></p>
<hr>
<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>贝叶斯公式（Bayes’ Theorem）是概率论中的基本定理，描述了如何根据新证据更新对事件概率的信念。它是贝叶斯统计学、机器学习、人工智能等领域的理论基础，提供了一种系统化的方法来处理不确定性和进行推理。</p>
<hr>
<h2 id="公式形式"><a href="#公式形式" class="headerlink" title="公式形式"></a>公式形式</h2><h3 id="基本形式"><a href="#基本形式" class="headerlink" title="基本形式"></a>基本形式</h3><p>$$P(A|B) &#x3D; \frac{P(B|A) \times P(A)}{P(B)}$$</p>
<h3 id="参数估计形式"><a href="#参数估计形式" class="headerlink" title="参数估计形式"></a>参数估计形式</h3><p>$$P(\theta|D) &#x3D; \frac{P(D|\theta) \times P(\theta)}{P(D)}$$</p>
<p>或写成：</p>
<p>$$\text{后验概率} &#x3D; \frac{\text{似然} \times \text{先验}}{\text{证据}}$$</p>
<hr>
<h2 id="各项含义"><a href="#各项含义" class="headerlink" title="各项含义"></a>各项含义</h2><table>
<thead>
<tr>
<th>符号</th>
<th>名称</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>$P(\theta|D)$</td>
<td>后验概率</td>
<td>看到数据 $D$ 后，参数 $\theta$ 的概率</td>
</tr>
<tr>
<td>$P(D|\theta)$</td>
<td>似然</td>
<td>给定参数 $\theta$，观测到数据 $D$ 的概率</td>
</tr>
<tr>
<td>$P(\theta)$</td>
<td>先验概率</td>
<td>看到数据前，对参数 $\theta$ 的初始信念</td>
</tr>
<tr>
<td>$P(D)$</td>
<td>边缘似然&#x2F;证据</td>
<td>数据 $D$ 出现的总概率（归一化常数）</td>
</tr>
</tbody></table>
<h3 id="边缘似然的计算"><a href="#边缘似然的计算" class="headerlink" title="边缘似然的计算"></a>边缘似然的计算</h3><p>$$P(D) &#x3D; \int P(D|\theta)P(\theta)d\theta$$</p>
<p>或离散情况：</p>
<p>$$P(D) &#x3D; \sum_{\theta} P(D|\theta)P(\theta)$$</p>
<hr>
<h2 id="直观理解"><a href="#直观理解" class="headerlink" title="直观理解"></a>直观理解</h2><p>贝叶斯公式回答：**”看到证据后，我应该如何更新我的信念？”**</p>
<p>$$\text{新信念} &#x3D; \frac{\text{旧信念} \times \text{证据支持度}}{\text{归一化}}$$</p>
<p><strong>核心思想</strong>：</p>
<ul>
<li>从先验信念开始</li>
<li>根据观测到的证据调整信念</li>
<li>得到更新后的后验信念</li>
</ul>
<hr>
<h2 id="实际例子"><a href="#实际例子" class="headerlink" title="实际例子"></a>实际例子</h2><h3 id="例-1：医疗诊断"><a href="#例-1：医疗诊断" class="headerlink" title="例 1：医疗诊断"></a>例 1：医疗诊断</h3><p><strong>场景</strong>：</p>
<ul>
<li>某疾病患病率 1%（先验）</li>
<li>测试准确率：患病时阳性 95%，健康时阳性 5%</li>
<li>你测试呈阳性</li>
</ul>
<p><strong>问</strong>：你真的患病的概率是多少？</p>
<p><strong>解答</strong>：</p>
<p>设：</p>
<ul>
<li>$A$ &#x3D; 患病</li>
<li>$B$ &#x3D; 测试阳性</li>
</ul>
<p>已知：</p>
<ul>
<li>$P(A) &#x3D; 0.01$（先验）</li>
<li>$P(B|A) &#x3D; 0.95$（真阳性率）</li>
<li>$P(B|\neg A) &#x3D; 0.05$（假阳性率）</li>
</ul>
<p>计算边缘似然：</p>
<p>$$P(B) &#x3D; P(B|A)P(A) + P(B|\neg A)P(\neg A)$$<br>$$&#x3D; 0.95 \times 0.01 + 0.05 \times 0.99 &#x3D; 0.059$$</p>
<p>应用贝叶斯公式：</p>
<p>$$P(A|B) &#x3D; \frac{P(B|A) \times P(A)}{P(B)} &#x3D; \frac{0.95 \times 0.01}{0.059} \approx 0.16$$</p>
<p><strong>结论</strong>：即使测试阳性，患病概率只有 **16%**！</p>
<p><strong>反直觉原因</strong>：先验概率很低（1%），大部分阳性结果来自假阳性。</p>
<hr>
<h3 id="例-2：垃圾邮件过滤"><a href="#例-2：垃圾邮件过滤" class="headerlink" title="例 2：垃圾邮件过滤"></a>例 2：垃圾邮件过滤</h3><p><strong>场景</strong>：</p>
<ul>
<li>邮件中 30% 是垃圾邮件</li>
<li>垃圾邮件中 80% 含”中奖”</li>
<li>正常邮件中 5% 含”中奖”</li>
</ul>
<p><strong>问</strong>：含”中奖”的邮件是垃圾邮件的概率？</p>
<p><strong>解答</strong>：</p>
<p>设：</p>
<ul>
<li>$S$ &#x3D; 垃圾邮件</li>
<li>$W$ &#x3D; 含”中奖”</li>
</ul>
<p>已知：</p>
<ul>
<li>$P(S) &#x3D; 0.3$</li>
<li>$P(W|S) &#x3D; 0.8$</li>
<li>$P(W|\neg S) &#x3D; 0.05$</li>
</ul>
<p>计算：</p>
<p>$$P(W) &#x3D; 0.8 \times 0.3 + 0.05 \times 0.7 &#x3D; 0.275$$</p>
<p>$$P(S|W) &#x3D; \frac{0.8 \times 0.3}{0.275} \approx 0.87$$</p>
<p><strong>结论</strong>：含”中奖”的邮件有 <strong>87%</strong> 概率是垃圾邮件。</p>
<hr>
<h3 id="例-3：机器学习中的参数估计"><a href="#例-3：机器学习中的参数估计" class="headerlink" title="例 3：机器学习中的参数估计"></a>例 3：机器学习中的参数估计</h3><p><strong>场景</strong>：训练一个分类模型</p>
<p><strong>目标</strong>：找到最优参数 $\theta$</p>
<p>$$P(\theta|D) &#x3D; \frac{P(D|\theta) \times P(\theta)}{P(D)}$$</p>
<ul>
<li>**似然 $P(D|\theta)$**：模型拟合数据的好坏</li>
<li>**先验 $P(\theta)$**：对参数的正则化（如 L2 正则 &#x3D; 高斯先验）</li>
<li>**后验 $P(\theta|D)$**：综合考虑数据和先验的最优参数</li>
</ul>
<p><strong>最大后验估计（MAP）</strong>：</p>
<p>$$\theta_{MAP} &#x3D; \arg\max_{\theta} P(\theta|D) &#x3D; \arg\max_{\theta} P(D|\theta)P(\theta)$$</p>
<hr>
<h2 id="贝叶斯推断流程"><a href="#贝叶斯推断流程" class="headerlink" title="贝叶斯推断流程"></a>贝叶斯推断流程</h2><h3 id="1-指定先验"><a href="#1-指定先验" class="headerlink" title="1. 指定先验"></a>1. 指定先验</h3><p>根据领域知识或假设选择先验分布：</p>
<p>$$P(\theta)$$</p>
<p><strong>常见先验</strong>：</p>
<ul>
<li><strong>无信息先验</strong>：均匀分布（表示无知）</li>
<li><strong>共轭先验</strong>：使后验与先验同分布（计算方便）</li>
<li><strong>正则化先验</strong>：高斯分布（L2 正则）、拉普拉斯分布（L1 正则）</li>
</ul>
<h3 id="2-收集数据"><a href="#2-收集数据" class="headerlink" title="2. 收集数据"></a>2. 收集数据</h3><p>观测数据 $D &#x3D; {x_1, x_2, \ldots, x_N}$</p>
<h3 id="3-计算似然"><a href="#3-计算似然" class="headerlink" title="3. 计算似然"></a>3. 计算似然</h3><p>根据模型计算数据的似然：</p>
<p>$$P(D|\theta) &#x3D; \prod_{i&#x3D;1}^{N} P(x_i|\theta)$$</p>
<h3 id="4-应用贝叶斯公式"><a href="#4-应用贝叶斯公式" class="headerlink" title="4. 应用贝叶斯公式"></a>4. 应用贝叶斯公式</h3><p>计算后验分布：</p>
<p>$$P(\theta|D) &#x3D; \frac{P(D|\theta)P(\theta)}{P(D)}$$</p>
<h3 id="5-进行推断"><a href="#5-进行推断" class="headerlink" title="5. 进行推断"></a>5. 进行推断</h3><ul>
<li><strong>点估计</strong>：MAP 或后验均值</li>
<li><strong>区间估计</strong>：可信区间（credible interval）</li>
<li><strong>预测</strong>：$P(x_{new}|D) &#x3D; \int P(x_{new}|\theta)P(\theta|D)d\theta$</li>
</ul>
<hr>
<h2 id="贝叶斯-vs-频率学派"><a href="#贝叶斯-vs-频率学派" class="headerlink" title="贝叶斯 vs 频率学派"></a>贝叶斯 vs 频率学派</h2><table>
<thead>
<tr>
<th>方面</th>
<th>贝叶斯学派</th>
<th>频率学派</th>
</tr>
</thead>
<tbody><tr>
<td><strong>参数性质</strong></td>
<td>随机变量（有分布）</td>
<td>固定未知值</td>
</tr>
<tr>
<td><strong>概率含义</strong></td>
<td>信念程度</td>
<td>长期频率</td>
</tr>
<tr>
<td><strong>推断方法</strong></td>
<td>后验分布</td>
<td>点估计 + 置信区间</td>
</tr>
<tr>
<td><strong>先验知识</strong></td>
<td>必须指定先验</td>
<td>不使用先验</td>
</tr>
<tr>
<td><strong>不确定性</strong></td>
<td>参数的概率分布</td>
<td>估计的抽样分布</td>
</tr>
<tr>
<td><strong>小样本</strong></td>
<td>可利用先验</td>
<td>可能不稳定</td>
</tr>
</tbody></table>
<h3 id="例子对比"><a href="#例子对比" class="headerlink" title="例子对比"></a>例子对比</h3><p><strong>问题</strong>：抛硬币 10 次，8 次正面，估计正面概率 $\theta$</p>
<p><strong>频率学派</strong>：</p>
<p>$$\hat{\theta}_{MLE} &#x3D; \frac{8}{10} &#x3D; 0.8$$</p>
<p><strong>贝叶斯学派</strong>（假设先验 $\theta \sim \text{Beta}(2,2)$）：</p>
<p>$$P(\theta|D) &#x3D; \text{Beta}(2+8, 2+2) &#x3D; \text{Beta}(10, 4)$$</p>
<p>后验均值：</p>
<p>$$\mathbb{E}[\theta|D] &#x3D; \frac{10}{10+4} \approx 0.71$$</p>
<p><strong>差异</strong>：贝叶斯方法考虑了先验信念（硬币应该接近公平），结果更保守。</p>
<hr>
<h2 id="在机器学习中的应用"><a href="#在机器学习中的应用" class="headerlink" title="在机器学习中的应用"></a>在机器学习中的应用</h2><h3 id="1-朴素贝叶斯分类器"><a href="#1-朴素贝叶斯分类器" class="headerlink" title="1. 朴素贝叶斯分类器"></a>1. 朴素贝叶斯分类器</h3><p>$$P(y|x_1, \ldots, x_n) &#x3D; \frac{P(y) \prod_{i&#x3D;1}^{n} P(x_i|y)}{P(x_1, \ldots, x_n)}$$</p>
<p><strong>应用</strong>：文本分类、垃圾邮件过滤</p>
<h3 id="2-贝叶斯线性回归"><a href="#2-贝叶斯线性回归" class="headerlink" title="2. 贝叶斯线性回归"></a>2. 贝叶斯线性回归</h3><p>$$P(w|D) &#x3D; \frac{P(D|w)P(w)}{P(D)}$$</p>
<p><strong>优势</strong>：提供预测的不确定性</p>
<h3 id="3-贝叶斯神经网络"><a href="#3-贝叶斯神经网络" class="headerlink" title="3. 贝叶斯神经网络"></a>3. 贝叶斯神经网络</h3><p>对网络权重建模为分布而非点估计：</p>
<p>$$P(w|D) \propto P(D|w)P(w)$$</p>
<p><strong>应用</strong>：不确定性量化、主动学习</p>
<h3 id="4-变分推断"><a href="#4-变分推断" class="headerlink" title="4. 变分推断"></a>4. 变分推断</h3><p>当后验 $P(\theta|D)$ 难以计算时，用简单分布 $q(\theta)$ 近似：</p>
<p>$$\min_q D_{KL}(q(\theta)||P(\theta|D))$$</p>
<p><strong>应用</strong>：VAE、主题模型（LDA）</p>
<h3 id="5-马尔可夫链蒙特卡洛（MCMC）"><a href="#5-马尔可夫链蒙特卡洛（MCMC）" class="headerlink" title="5. 马尔可夫链蒙特卡洛（MCMC）"></a>5. 马尔可夫链蒙特卡洛（MCMC）</h3><p>通过采样近似后验分布：</p>
<p>$$\theta^{(t+1)} \sim P(\theta|D)$$</p>
<p><strong>应用</strong>：贝叶斯深度学习、概率编程</p>
<hr>
<h2 id="先验的选择"><a href="#先验的选择" class="headerlink" title="先验的选择"></a>先验的选择</h2><h3 id="1-无信息先验（Non-informative-Prior）"><a href="#1-无信息先验（Non-informative-Prior）" class="headerlink" title="1. 无信息先验（Non-informative Prior）"></a>1. 无信息先验（Non-informative Prior）</h3><p><strong>目的</strong>：表达”无知”</p>
<p><strong>例子</strong>：</p>
<ul>
<li>均匀分布：$P(\theta) &#x3D; \text{Uniform}(a, b)$</li>
<li>Jeffreys 先验：$P(\theta) \propto \sqrt{|I(\theta)|}$（基于 Fisher 信息）</li>
</ul>
<h3 id="2-共轭先验（Conjugate-Prior）"><a href="#2-共轭先验（Conjugate-Prior）" class="headerlink" title="2. 共轭先验（Conjugate Prior）"></a>2. 共轭先验（Conjugate Prior）</h3><p><strong>定义</strong>：后验与先验同分布族</p>
<p><strong>例子</strong>：</p>
<table>
<thead>
<tr>
<th>似然</th>
<th>共轭先验</th>
<th>后验</th>
</tr>
</thead>
<tbody><tr>
<td>伯努利</td>
<td>Beta</td>
<td>Beta</td>
</tr>
<tr>
<td>正态（已知方差）</td>
<td>正态</td>
<td>正态</td>
</tr>
<tr>
<td>泊松</td>
<td>Gamma</td>
<td>Gamma</td>
</tr>
<tr>
<td>多项式</td>
<td>Dirichlet</td>
<td>Dirichlet</td>
</tr>
</tbody></table>
<p><strong>优势</strong>：后验有闭式解，计算简单</p>
<h3 id="3-正则化先验"><a href="#3-正则化先验" class="headerlink" title="3. 正则化先验"></a>3. 正则化先验</h3><p><strong>目的</strong>：防止过拟合</p>
<p><strong>例子</strong>：</p>
<ul>
<li><strong>高斯先验</strong>：$P(w) &#x3D; \mathcal{N}(0, \lambda^{-1}I)$ → L2 正则化</li>
<li><strong>拉普拉斯先验</strong>：$P(w) &#x3D; \text{Laplace}(0, b)$ → L1 正则化</li>
</ul>
<h3 id="4-经验贝叶斯（Empirical-Bayes）"><a href="#4-经验贝叶斯（Empirical-Bayes）" class="headerlink" title="4. 经验贝叶斯（Empirical Bayes）"></a>4. 经验贝叶斯（Empirical Bayes）</h3><p>从数据中估计先验的超参数：</p>
<p>$$\hat{\alpha} &#x3D; \arg\max_{\alpha} P(D|\alpha)$$</p>
<hr>
<h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><h3 id="问题-1：先验是主观的吗？"><a href="#问题-1：先验是主观的吗？" class="headerlink" title="问题 1：先验是主观的吗？"></a>问题 1：先验是主观的吗？</h3><p><strong>回答</strong>：</p>
<ul>
<li><strong>是</strong>：先验反映了建模者的信念或假设</li>
<li><strong>但</strong>：可以通过以下方式减少主观性：<ul>
<li>使用无信息先验</li>
<li>使用领域知识</li>
<li>使用经验贝叶斯</li>
<li>数据足够多时，后验主要由似然决定</li>
</ul>
</li>
</ul>
<hr>
<h3 id="问题-2：贝叶斯方法计算复杂吗？"><a href="#问题-2：贝叶斯方法计算复杂吗？" class="headerlink" title="问题 2：贝叶斯方法计算复杂吗？"></a>问题 2：贝叶斯方法计算复杂吗？</h3><p><strong>回答</strong>：</p>
<ul>
<li><strong>共轭先验</strong>：后验有闭式解，计算简单</li>
<li><strong>非共轭情况</strong>：需要近似方法<ul>
<li>变分推断（快速但近似）</li>
<li>MCMC（精确但慢）</li>
<li>拉普拉斯近似（快速但粗糙）</li>
</ul>
</li>
</ul>
<hr>
<h3 id="问题-3：为什么-P-D-叫”证据”？"><a href="#问题-3：为什么-P-D-叫”证据”？" class="headerlink" title="问题 3：为什么 P(D) 叫”证据”？"></a>问题 3：为什么 P(D) 叫”证据”？</h3><p><strong>回答</strong>：</p>
<ul>
<li>$P(D)$ 是观测数据的边缘概率</li>
<li>在模型比较中，$P(D)$ 衡量模型对数据的解释能力</li>
<li>更高的 $P(D)$ 意味着模型更好地”证明”了数据的存在</li>
</ul>
<hr>
<h3 id="问题-4：贝叶斯公式可以连续更新吗？"><a href="#问题-4：贝叶斯公式可以连续更新吗？" class="headerlink" title="问题 4：贝叶斯公式可以连续更新吗？"></a>问题 4：贝叶斯公式可以连续更新吗？</h3><p><strong>回答</strong>：可以！这是贝叶斯方法的优势。</p>
<p><strong>顺序更新</strong>：</p>
<p>$$P(\theta|D_1, D_2) &#x3D; \frac{P(D_2|\theta)P(\theta|D_1)}{P(D_2|D_1)}$$</p>
<p>前一次的后验成为下一次的先验：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">先验 → [数据1] → 后验1 → [数据2] → 后验2 → ...</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h2><h3 id="1-选择合适的先验"><a href="#1-选择合适的先验" class="headerlink" title="1. 选择合适的先验"></a>1. 选择合适的先验</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 弱信息先验（数据主导）</span></span><br><span class="line">prior = Normal(<span class="number">0</span>, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 强信息先验（先验主导）</span></span><br><span class="line">prior = Normal(<span class="number">0</span>, <span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 正则化先验</span></span><br><span class="line">prior = Normal(<span class="number">0</span>, <span class="number">1</span>/<span class="keyword">lambda</span>)  <span class="comment"># 等价于 L2 正则</span></span><br></pre></td></tr></table></figure>

<h3 id="2-检查先验的影响"><a href="#2-检查先验的影响" class="headerlink" title="2. 检查先验的影响"></a>2. 检查先验的影响</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 先验预测检查</span></span><br><span class="line">prior_samples = prior.sample(<span class="number">1000</span>)</span><br><span class="line">prior_predictions = model(prior_samples)</span><br><span class="line"><span class="comment"># 检查先验预测是否合理</span></span><br></pre></td></tr></table></figure>

<h3 id="3-后验检查"><a href="#3-后验检查" class="headerlink" title="3. 后验检查"></a>3. 后验检查</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 后验预测检查</span></span><br><span class="line">posterior_samples = posterior.sample(<span class="number">1000</span>)</span><br><span class="line">posterior_predictions = model(posterior_samples)</span><br><span class="line"><span class="comment"># 与真实数据对比</span></span><br></pre></td></tr></table></figure>

<h3 id="4-使用对数空间计算"><a href="#4-使用对数空间计算" class="headerlink" title="4. 使用对数空间计算"></a>4. 使用对数空间计算</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 避免数值下溢</span></span><br><span class="line">log_posterior = log_likelihood + log_prior - log_evidence</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h2><h3 id="PyTorch-实现贝叶斯线性回归"><a href="#PyTorch-实现贝叶斯线性回归" class="headerlink" title="PyTorch 实现贝叶斯线性回归"></a>PyTorch 实现贝叶斯线性回归</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.distributions <span class="keyword">as</span> dist</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据</span></span><br><span class="line">X = torch.randn(<span class="number">100</span>, <span class="number">1</span>)</span><br><span class="line">y = <span class="number">3</span> * X + <span class="number">2</span> + torch.randn(<span class="number">100</span>, <span class="number">1</span>) * <span class="number">0.5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 先验</span></span><br><span class="line">prior_w = dist.Normal(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">prior_b = dist.Normal(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 似然</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">likelihood</span>(<span class="params">w, b, X, y, sigma=<span class="number">0.5</span></span>):</span><br><span class="line">    y_pred = w * X + b</span><br><span class="line">    <span class="keyword">return</span> dist.Normal(y_pred, sigma).log_prob(y).<span class="built_in">sum</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 后验（使用变分推断近似）</span></span><br><span class="line">q_w_mu = torch.nn.Parameter(torch.randn(<span class="number">1</span>))</span><br><span class="line">q_w_sigma = torch.nn.Parameter(torch.ones(<span class="number">1</span>))</span><br><span class="line">q_b_mu = torch.nn.Parameter(torch.randn(<span class="number">1</span>))</span><br><span class="line">q_b_sigma = torch.nn.Parameter(torch.ones(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">optimizer = torch.optim.Adam([q_w_mu, q_w_sigma, q_b_mu, q_b_sigma], lr=<span class="number">0.01</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 优化 ELBO</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    optimizer.zero_grad()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 从变分分布采样</span></span><br><span class="line">    w = q_w_mu + q_w_sigma * torch.randn(<span class="number">1</span>)</span><br><span class="line">    b = q_b_mu + q_b_sigma * torch.randn(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ELBO = 似然 - KL散度</span></span><br><span class="line">    log_lik = likelihood(w, b, X, y)</span><br><span class="line">    kl_w = dist.kl_divergence(</span><br><span class="line">        dist.Normal(q_w_mu, q_w_sigma),</span><br><span class="line">        prior_w</span><br><span class="line">    )</span><br><span class="line">    kl_b = dist.kl_divergence(</span><br><span class="line">        dist.Normal(q_b_mu, q_b_sigma),</span><br><span class="line">        prior_b</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    elbo = log_lik - kl_w - kl_b</span><br><span class="line">    loss = -elbo</span><br><span class="line"></span><br><span class="line">    loss.backward()</span><br><span class="line">    optimizer.step()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;后验均值: w=<span class="subst">&#123;q_w_mu.item():<span class="number">.2</span>f&#125;</span>, b=<span class="subst">&#123;q_b_mu.item():<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="参考资源"><a href="#参考资源" class="headerlink" title="参考资源"></a>参考资源</h2><ul>
<li><a target="_blank" rel="noopener" href="http://www.stat.columbia.edu/~gelman/book/">Bayesian Data Analysis - Andrew Gelman et al.</a></li>
<li><a target="_blank" rel="noopener" href="https://www.microsoft.com/en-us/research/publication/pattern-recognition-machine-learning/">Pattern Recognition and Machine Learning - Christopher Bishop</a></li>
<li><a target="_blank" rel="noopener" href="https://probml.github.io/pml-book/">Probabilistic Machine Learning: An Introduction - Kevin Murphy</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/CamDavidsonPilon/Probabilistic-Programming-and-Bayesian-Methods-for-Hackers">Bayesian Methods for Hackers</a></li>
</ul>
<hr>
</div><script src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.0/dist/js/lightgallery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-fullscreen.js@1.2.0/dist/lg-fullscreen.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.3.0/dist/lg-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-autoplay.js@1.2.0/dist/lg-autoplay.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-video.js@1.3.0/dist/lg-video.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-hash.js@1.0.0/dist/lg-hash.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-pager.js@1.0.0/dist/lg-pager.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script></div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2026/01/29/%5BOBS%5DAI-ELBO-Variational-Inference/"><img class="fill" src="/gallery/AI.png" alt="ELBO 与变分推断" referrerpolicy="no-referrer"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2026-01-29T11:15:00.000Z" title="1/29/2026, 7:15:00 PM">2026-01-29</time></span><span class="level-item">Updated&nbsp;<time dateTime="2026-02-14T16:35:53.755Z" title="2/15/2026, 12:35:53 AM">2026-02-15</time></span><span class="level-item"><a class="link-muted" href="/categories/Note/">Note</a></span><span class="level-item">19 minutes read (About 2779 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2026/01/29/%5BOBS%5DAI-ELBO-Variational-Inference/">ELBO 与变分推断</a></p><div class="content"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.0/dist/css/lightgallery.min.css" /><div class=".article-gallery"><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Variational_Bayesian_methods">Variational Inference</a> | <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Evidence_lower_bound">Evidence Lower Bound</a> | <a target="_blank" rel="noopener" href="https://arxiv.org/abs/1312.6114">VAE Paper</a></p>
<hr>
<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>ELBO（Evidence Lower Bound，证据下界）是变分推断中的核心概念，用于近似难以计算的边缘似然 $\log p(x)$。ELBO 提供了一个可优化的目标函数，使得复杂概率模型的训练变得可行，是现代深度生成模型（如 VAE）的理论基础。</p>
<hr>
<h2 id="核心概念"><a href="#核心概念" class="headerlink" title="核心概念"></a>核心概念</h2><h3 id="什么是-ELBO"><a href="#什么是-ELBO" class="headerlink" title="什么是 ELBO"></a>什么是 ELBO</h3><p>ELBO 是对数边缘似然 $\log p(x)$ 的下界：</p>
<p>$$\text{ELBO} &#x3D; \mathbb{E}<em>{q(z|x)}[\log p(x,z)] - \mathbb{E}</em>{q(z|x)}[\log q(z|x)]$$</p>
<p>或等价形式：</p>
<p>$$\text{ELBO} &#x3D; \mathbb{E}<em>{q(z|x)}[\log p(x|z)] - D</em>{KL}(q(z|x)||p(z))$$</p>
<p>其中：</p>
<ul>
<li>$x$ 是观测数据</li>
<li>$z$ 是隐变量</li>
<li>$q(z|x)$ 是近似后验分布（变分分布）</li>
<li>$p(z)$ 是先验分布</li>
<li>$p(x|z)$ 是似然函数</li>
</ul>
<h3 id="ELBO-的推导"><a href="#ELBO-的推导" class="headerlink" title="ELBO 的推导"></a>ELBO 的推导</h3><p><strong>目标</strong>：最大化边缘似然 $\log p(x)$</p>
<p>$$\log p(x) &#x3D; \log \int p(x,z)dz$$</p>
<p>这个积分通常难以计算。引入变分分布 $q(z|x)$：</p>
<p>$$\begin{align}<br>\log p(x) &amp;&#x3D; \log \int p(x,z)dz \<br>&amp;&#x3D; \log \int \frac{q(z|x)}{q(z|x)} p(x,z)dz \<br>&amp;&#x3D; \log \mathbb{E}<em>{q(z|x)}\left[\frac{p(x,z)}{q(z|x)}\right] \<br>&amp;\geq \mathbb{E}</em>{q(z|x)}\left[\log\frac{p(x,z)}{q(z|x)}\right] \quad \text{[Jensen 不等式]} \<br>&amp;&#x3D; \text{ELBO}<br>\end{align}$$</p>
<p><strong>关键关系</strong>：</p>
<p>$$\log p(x) &#x3D; \text{ELBO} + D_{KL}(q(z|x)||p(z|x))$$</p>
<p>由于 $D_{KL} \geq 0$，所以 ELBO 是 $\log p(x)$ 的下界。</p>
<h3 id="ELBO-的两种解释"><a href="#ELBO-的两种解释" class="headerlink" title="ELBO 的两种解释"></a>ELBO 的两种解释</h3><p><strong>解释 1：重构 + 正则化</strong></p>
<p>$$\text{ELBO} &#x3D; \underbrace{\mathbb{E}<em>{q(z|x)}[\log p(x|z)]}</em>{\text{重构项}} - \underbrace{D_{KL}(q(z|x)||p(z))}_{\text{正则化项}}$$</p>
<ul>
<li><strong>重构项</strong>：衡量模型拟合数据的能力</li>
<li><strong>正则化项</strong>：约束后验分布接近先验分布</li>
</ul>
<p><strong>解释 2：似然 - 复杂度</strong></p>
<p>$$\text{ELBO} &#x3D; \underbrace{\mathbb{E}<em>{q(z|x)}[\log p(x|z)]}</em>{\text{数据似然}} - \underbrace{D_{KL}(q(z|x)||p(z))}_{\text{模型复杂度惩罚}}$$</p>
<p>这体现了奥卡姆剃刀原则：在解释数据的同时保持模型简单。</p>
<hr>
<h2 id="为什么要优化-ELBO"><a href="#为什么要优化-ELBO" class="headerlink" title="为什么要优化 ELBO"></a>为什么要优化 ELBO</h2><h3 id="1-直接计算困难"><a href="#1-直接计算困难" class="headerlink" title="1. 直接计算困难"></a>1. 直接计算困难</h3><p>真实后验 $p(z|x) &#x3D; \frac{p(x|z)p(z)}{p(x)}$ 难以计算，因为：</p>
<p>$$p(x) &#x3D; \int p(x|z)p(z)dz$$</p>
<p>这个积分在高维空间中通常没有闭式解。</p>
<h3 id="2-等价优化"><a href="#2-等价优化" class="headerlink" title="2. 等价优化"></a>2. 等价优化</h3><p>最大化 ELBO 等价于最小化 $D_{KL}(q(z|x)||p(z|x))$：</p>
<p>$$\begin{align}<br>\log p(x) &amp;&#x3D; \text{ELBO} + D_{KL}(q(z|x)||p(z|x)) \<br>\max_q \text{ELBO} &amp;\Leftrightarrow \min_q D_{KL}(q(z|x)||p(z|x))<br>\end{align}$$</p>
<p>因为 $\log p(x)$ 不依赖于 $q$，最大化 ELBO 就是让 $q(z|x)$ 尽可能接近真实后验 $p(z|x)$。</p>
<h3 id="3-可计算性"><a href="#3-可计算性" class="headerlink" title="3. 可计算性"></a>3. 可计算性</h3><p>ELBO 可以通过蒙特卡洛采样估计：</p>
<p>$$\text{ELBO} \approx \frac{1}{L}\sum_{i&#x3D;1}^{L} \log p(x|z_i) - D_{KL}(q(z|x)||p(z))$$</p>
<p>其中 $z_i \sim q(z|x)$。</p>
<hr>
<h2 id="ELBO-在-VAE-中的应用"><a href="#ELBO-在-VAE-中的应用" class="headerlink" title="ELBO 在 VAE 中的应用"></a>ELBO 在 VAE 中的应用</h2><h3 id="VAE-架构"><a href="#VAE-架构" class="headerlink" title="VAE 架构"></a>VAE 架构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">输入 x → Encoder → μ(x), σ(x) → 采样 z ~ N(μ,σ²) → Decoder → 重构 x̂</span><br></pre></td></tr></table></figure>

<h3 id="VAE-的假设"><a href="#VAE-的假设" class="headerlink" title="VAE 的假设"></a>VAE 的假设</h3><ul>
<li><strong>先验</strong>：$p(z) &#x3D; \mathcal{N}(0, I)$（标准正态分布）</li>
<li><strong>后验</strong>：$q(z|x) &#x3D; \mathcal{N}(\mu(x), \sigma^2(x)I)$（编码器输出）</li>
<li><strong>似然</strong>：$p(x|z) &#x3D; \mathcal{N}(\text{Decoder}(z), I)$（解码器输出）</li>
</ul>
<h3 id="ELBO-的具体形式"><a href="#ELBO-的具体形式" class="headerlink" title="ELBO 的具体形式"></a>ELBO 的具体形式</h3><p>$$\text{ELBO} &#x3D; \mathbb{E}<em>{q(z|x)}[\log p(x|z)] - D</em>{KL}(q(z|x)||p(z))$$</p>
<p><strong>重构项</strong>（需要采样估计）：</p>
<p>$$\mathbb{E}<em>{q(z|x)}[\log p(x|z)] \approx \frac{1}{L}\sum</em>{i&#x3D;1}^{L} \log p(x|z_i), \quad z_i \sim q(z|x)$$</p>
<p>通常 $L&#x3D;1$（单样本估计）。对于伯努利分布的似然，这等价于二元交叉熵。</p>
<p><strong>KL 项</strong>（有闭式解）：</p>
<p>$$D_{KL}(q(z|x)||p(z)) &#x3D; -\frac{1}{2}\sum_{j&#x3D;1}^{J}\left(1 + \log\sigma_j^2 - \mu_j^2 - \sigma_j^2\right)$$</p>
<p>其中 $J$ 是隐变量维度。</p>
<h3 id="损失函数"><a href="#损失函数" class="headerlink" title="损失函数"></a>损失函数</h3><p>VAE 的损失函数是 <strong>负 ELBO</strong>（因为要最小化）：</p>
<p>$$\mathcal{L} &#x3D; -\text{ELBO} &#x3D; \underbrace{-\mathbb{E}<em>{q(z|x)}[\log p(x|z)]}</em>{\text{重构损失}} + \underbrace{D_{KL}(q(z|x)||p(z))}_{\text{KL 损失}}$$</p>
<hr>
<h2 id="重参数化技巧"><a href="#重参数化技巧" class="headerlink" title="重参数化技巧"></a>重参数化技巧</h2><h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><p>直接从 $z \sim \mathcal{N}(\mu(x), \sigma^2(x))$ 采样<strong>不可微</strong>，无法反向传播。</p>
<h3 id="解决方案：重参数化"><a href="#解决方案：重参数化" class="headerlink" title="解决方案：重参数化"></a>解决方案：重参数化</h3><p><strong>核心思想</strong>：将随机性外部化</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">原始：z ~ N(μ, σ²)  ❌ 不可微</span><br><span class="line"></span><br><span class="line">重参数化：</span><br><span class="line">ε ~ N(0, I)         ✓ 随机性独立于参数</span><br><span class="line">z = μ + σ ⊙ ε       ✓ 可微变换</span><br></pre></td></tr></table></figure>

<h3 id="梯度流"><a href="#梯度流" class="headerlink" title="梯度流"></a>梯度流</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">损失 → Decoder → z = μ + σε → μ, σ → Encoder</span><br><span class="line">                  ↑ 可微！</span><br></pre></td></tr></table></figure>

<ul>
<li>$\varepsilon$ 是常数（从参数角度），梯度不经过它</li>
<li>$\mu$ 和 $\sigma$ 的梯度可以正常计算</li>
</ul>
<hr>
<h2 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h2><h3 id="PyTorch-实现"><a href="#PyTorch-实现" class="headerlink" title="PyTorch 实现"></a>PyTorch 实现</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">VAE</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, input_dim=<span class="number">784</span>, hidden_dim=<span class="number">400</span>, latent_dim=<span class="number">20</span></span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Encoder</span></span><br><span class="line">        <span class="variable language_">self</span>.fc1 = nn.Linear(input_dim, hidden_dim)</span><br><span class="line">        <span class="variable language_">self</span>.fc_mu = nn.Linear(hidden_dim, latent_dim)</span><br><span class="line">        <span class="variable language_">self</span>.fc_logvar = nn.Linear(hidden_dim, latent_dim)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Decoder</span></span><br><span class="line">        <span class="variable language_">self</span>.fc3 = nn.Linear(latent_dim, hidden_dim)</span><br><span class="line">        <span class="variable language_">self</span>.fc4 = nn.Linear(hidden_dim, input_dim)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;编码器：x → μ, log(σ²)&quot;&quot;&quot;</span></span><br><span class="line">        h = torch.relu(<span class="variable language_">self</span>.fc1(x))</span><br><span class="line">        mu = <span class="variable language_">self</span>.fc_mu(h)</span><br><span class="line">        logvar = <span class="variable language_">self</span>.fc_logvar(h)  <span class="comment"># log(σ²) 数值稳定</span></span><br><span class="line">        <span class="keyword">return</span> mu, logvar</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">reparameterize</span>(<span class="params">self, mu, logvar</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;重参数化技巧：z = μ + σε&quot;&quot;&quot;</span></span><br><span class="line">        std = torch.exp(<span class="number">0.5</span> * logvar)  <span class="comment"># σ = exp(0.5*log(σ²))</span></span><br><span class="line">        eps = torch.randn_like(std)     <span class="comment"># ε ~ N(0,I)</span></span><br><span class="line">        z = mu + eps * std              <span class="comment"># z = μ + σε</span></span><br><span class="line">        <span class="keyword">return</span> z</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">self, z</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;解码器：z → x��&quot;&quot;&quot;</span></span><br><span class="line">        h = torch.relu(<span class="variable language_">self</span>.fc3(z))</span><br><span class="line">        <span class="keyword">return</span> torch.sigmoid(<span class="variable language_">self</span>.fc4(h))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        mu, logvar = <span class="variable language_">self</span>.encode(x)</span><br><span class="line">        z = <span class="variable language_">self</span>.reparameterize(mu, logvar)</span><br><span class="line">        recon_x = <span class="variable language_">self</span>.decode(z)</span><br><span class="line">        <span class="keyword">return</span> recon_x, mu, logvar</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">vae_loss</span>(<span class="params">recon_x, x, mu, logvar</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    VAE 损失函数 = -ELBO</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Args:</span></span><br><span class="line"><span class="string">        recon_x: 重构的 x</span></span><br><span class="line"><span class="string">        x: 原始 x</span></span><br><span class="line"><span class="string">        mu: 编码器输出的均值</span></span><br><span class="line"><span class="string">        logvar: 编码器输出的 log(σ²)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Returns:</span></span><br><span class="line"><span class="string">        总损失 = 重构损失 + KL 损失</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 重构损失：-E[log p(x|z)]</span></span><br><span class="line">    <span class="comment"># 对于伯努利分布 = 二元交叉熵</span></span><br><span class="line">    BCE = F.binary_cross_entropy(recon_x, x, reduction=<span class="string">&#x27;sum&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># KL 散度：KL(q(z|x)||p(z))</span></span><br><span class="line">    <span class="comment"># 闭式解：-0.5 * Σ(1 + log(σ²) - μ² - σ²)</span></span><br><span class="line">    KLD = -<span class="number">0.5</span> * torch.<span class="built_in">sum</span>(<span class="number">1</span> + logvar - mu.<span class="built_in">pow</span>(<span class="number">2</span>) - logvar.exp())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> BCE + KLD</span><br><span class="line"></span><br><span class="line"><span class="comment"># 训练循环</span></span><br><span class="line">model = VAE()</span><br><span class="line">optimizer = torch.optim.Adam(model.parameters(), lr=<span class="number">1e-3</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(num_epochs):</span><br><span class="line">    <span class="keyword">for</span> batch_x <span class="keyword">in</span> dataloader:</span><br><span class="line">        optimizer.zero_grad()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 前向传播</span></span><br><span class="line">        recon_x, mu, logvar = model(batch_x)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 计算损失（负 ELBO）</span></span><br><span class="line">        loss = vae_loss(recon_x, batch_x, mu, logvar)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 反向传播</span></span><br><span class="line">        loss.backward()</span><br><span class="line">        optimizer.step()</span><br></pre></td></tr></table></figure>

<h3 id="关键实现细节"><a href="#关键实现细节" class="headerlink" title="关键实现细节"></a>关键实现细节</h3><ol>
<li><strong>使用 log(σ²) 而非 σ</strong>：数值稳定性更好</li>
<li><strong>KL 散度的闭式解</strong>：避免采样估计</li>
<li><strong>重参数化</strong>：使采样过程可微</li>
<li><strong>单样本估计</strong>：重构项通常只采样一次</li>
</ol>
<hr>
<h2 id="正则化的作用"><a href="#正则化的作用" class="headerlink" title="正则化的作用"></a>正则化的作用</h2><h3 id="什么是正则化"><a href="#什么是正则化" class="headerlink" title="什么是正则化"></a>什么是正则化</h3><p>正则化是防止模型过拟合的技术，通过约束模型复杂度：</p>
<p>$$\text{损失函数} &#x3D; \text{数据拟合项} + \lambda \times \text{正则化项}$$</p>
<p><strong>常见类型</strong>：</p>
<ul>
<li><strong>L2 正则</strong>：$\lambda||w||^2$ - 权重衰减</li>
<li><strong>L1 正则</strong>：$\lambda||w||$ - 稀疏性</li>
<li><strong>Dropout</strong>：随机关闭神经元</li>
<li><strong>Early Stopping</strong>：提前停止训练</li>
</ul>
<h3 id="VAE-中的正则化"><a href="#VAE-中的正则化" class="headerlink" title="VAE 中的正则化"></a>VAE 中的正则化</h3><p>ELBO 天然包含正则化：</p>
<p>$$\text{ELBO} &#x3D; \underbrace{\mathbb{E}[\log p(x|z)]}<em>{\text{拟合数据}} - \underbrace{D</em>{KL}(q(z|x)||p(z))}_{\text{正则化}}$$</p>
<p><strong>KL 散度项的作用</strong>：</p>
<ol>
<li><strong>约束隐空间结构</strong>：强制 $q(z|x)$ 接近先验 $p(z) &#x3D; \mathcal{N}(0,I)$</li>
<li>**防止编码器”作弊”**：避免为每个样本学习独特的、互不相关的编码</li>
<li><strong>保证连续性</strong>：使隐空间平滑、可插值</li>
<li><strong>实现解耦表示</strong>：鼓励学习独立的隐变量</li>
</ol>
<h3 id="没有-KL-正则化会怎样？"><a href="#没有-KL-正则化会怎样？" class="headerlink" title="没有 KL 正则化会怎样？"></a>没有 KL 正则化会怎样？</h3><p>如果只优化重构损失：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">loss = reconstruction_loss  <span class="comment"># 没有 KL 项</span></span><br></pre></td></tr></table></figure>

<p><strong>问题</strong>：</p>
<ul>
<li>编码器可能���每个样本映射到隐空间的任意位置</li>
<li>隐空间结构混乱，无法生成新样本</li>
<li>方差 $\sigma$ 可能趋近于 0（退化为确定性编码）</li>
</ul>
<p><strong>KL 正则化的效果</strong>：</p>
<ul>
<li>强制隐变量分布接近标准正态分布</li>
<li>保证隐空间的连续性和平滑性</li>
<li>使得从先验 $p(z)$ 采样可以生成有意义的样本</li>
</ul>
<hr>
<h2 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h2><h3 id="1-变分自编码器（VAE）"><a href="#1-变分自编码器（VAE）" class="headerlink" title="1. 变分自编码器（VAE）"></a>1. 变分自编码器（VAE）</h3><p><strong>用途</strong>：生成模型、表示学习</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 训练后生成新样本</span></span><br><span class="line">z = torch.randn(batch_size, latent_dim)  <span class="comment"># 从先验采样</span></span><br><span class="line">generated_x = model.decode(z)</span><br></pre></td></tr></table></figure>

<h3 id="2-主题模型（LDA）"><a href="#2-主题模型（LDA）" class="headerlink" title="2. 主题模型（LDA）"></a>2. 主题模型（LDA）</h3><p><strong>用途</strong>：文档主题发现</p>
<ul>
<li>隐变量 $z$：文档的主题分布</li>
<li>ELBO 用于推断主题</li>
</ul>
<h3 id="3-贝叶斯神经网络"><a href="#3-贝叶斯神经网络" class="headerlink" title="3. 贝叶斯神经网络"></a>3. 贝叶斯神经网络</h3><p><strong>用途</strong>：不确定性量化</p>
<ul>
<li>隐变量 $z$：网络权重</li>
<li>ELBO 用于近似权重的后验分布</li>
</ul>
<h3 id="4-隐马尔可夫模型（HMM）"><a href="#4-隐马尔可夫模型（HMM）" class="headerlink" title="4. 隐马尔可夫模型（HMM）"></a>4. 隐马尔可夫模型（HMM）</h3><p><strong>用途</strong>：序列建模</p>
<ul>
<li>隐变量 $z$：隐藏状态序列</li>
<li>ELBO 用于推断状态</li>
</ul>
<h3 id="5-高斯混合模型（GMM）"><a href="#5-高斯混合模型（GMM）" class="headerlink" title="5. 高斯混合模型（GMM）"></a>5. 高斯混合模型（GMM）</h3><p><strong>用途</strong>：聚类分析</p>
<ul>
<li>隐变量 $z$：样本所属的簇</li>
<li>ELBO 用于推断簇分配</li>
</ul>
<hr>
<h2 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h2><h3 id="1-平衡重构与-KL-损失"><a href="#1-平衡重构与-KL-损失" class="headerlink" title="1. 平衡重构与 KL 损失"></a>1. 平衡重构与 KL 损失</h3><p>有时需要调整 KL 项的权重：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">loss = reconstruction_loss + beta * kl_loss  <span class="comment"># β-VAE</span></span><br></pre></td></tr></table></figure>

<ul>
<li><strong>β &lt; 1</strong>：更注重重构质量</li>
<li><strong>β &gt; 1</strong>：更注重解耦表示</li>
<li><strong>β &#x3D; 1</strong>：标准 VAE</li>
</ul>
<h3 id="2-KL-退火（KL-Annealing）"><a href="#2-KL-退火（KL-Annealing）" class="headerlink" title="2. KL 退火（KL Annealing）"></a>2. KL 退火（KL Annealing）</h3><p>训练初期降低 KL 权重，逐渐增加：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">beta = <span class="built_in">min</span>(<span class="number">1.0</span>, epoch / warmup_epochs)</span><br><span class="line">loss = reconstruction_loss + beta * kl_loss</span><br></pre></td></tr></table></figure>

<p><strong>原因</strong>：避免”后验坍缩”（posterior collapse），即 $q(z|x)$ 过早收敛到先验。</p>
<h3 id="3-自由比特（Free-Bits）"><a href="#3-自由比特（Free-Bits）" class="headerlink" title="3. 自由比特（Free Bits）"></a>3. 自由比特（Free Bits）</h3><p>为每个隐变量维度设置最小 KL 值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kl_per_dim = kl_loss / latent_dim</span><br><span class="line">kl_loss = torch.<span class="built_in">sum</span>(torch.<span class="built_in">max</span>(kl_per_dim, free_bits_threshold))</span><br></pre></td></tr></table></figure>

<p><strong>作用</strong>：防止某些维度被忽略。</p>
<h3 id="4-数值稳定性"><a href="#4-数值稳定性" class="headerlink" title="4. 数值稳定性"></a>4. 数值稳定性</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 log(σ²) 而非 σ</span></span><br><span class="line">logvar = <span class="variable language_">self</span>.fc_logvar(h)</span><br><span class="line">std = torch.exp(<span class="number">0.5</span> * logvar)  <span class="comment"># 避免负数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 避免 log(0)</span></span><br><span class="line">recon_x = torch.clamp(recon_x, <span class="built_in">min</span>=<span class="number">1e-7</span>, <span class="built_in">max</span>=<span class="number">1</span>-<span class="number">1e-7</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><h3 id="问题-1：ELBO-为什么是下界？"><a href="#问题-1：ELBO-为什么是下界？" class="headerlink" title="问题 1：ELBO 为什么是下界？"></a>问题 1：ELBO 为什么是下界？</h3><p><strong>解答</strong>：根据 Jensen 不等式，对于凹函数 $\log$：</p>
<p>$$\log \mathbb{E}[X] \geq \mathbb{E}[\log X]$$</p>
<p>因此：</p>
<p>$$\log p(x) &#x3D; \log \mathbb{E}<em>{q(z|x)}\left[\frac{p(x,z)}{q(z|x)}\right] \geq \mathbb{E}</em>{q(z|x)}\left[\log\frac{p(x,z)}{q(z|x)}\right] &#x3D; \text{ELBO}$$</p>
<hr>
<h3 id="问题-2：为什么叫”证据”下界？"><a href="#问题-2：为什么叫”证据”下界？" class="headerlink" title="问题 2：为什么叫”证据”下界？"></a>问题 2：为什么叫”证据”下界？</h3><p><strong>解答</strong>：在贝叶斯推断中，$p(x)$ 被称为”证据”（evidence）或”边缘似然”（marginal likelihood），因为它是观测数据 $x$ 的概率。ELBO 是这个证据的下界。</p>
<hr>
<h3 id="问题-3：重参数化技巧为什么有效？"><a href="#问题-3：重参数化技巧为什么有效？" class="headerlink" title="问题 3：重参数化技巧为什么有效？"></a>问题 3：重参数化技巧为什么有效？</h3><p><strong>解答</strong>：重参数化将随机性从参数中分离出来：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">z = μ(x; θ) + σ(x; θ) ⊙ ε,  ε ~ N(0,I)</span><br></pre></td></tr></table></figure>

<ul>
<li>$\varepsilon$ 不依赖于 $\theta$，是外部噪声</li>
<li>$\mu$ 和 $\sigma$ 依赖于 $\theta$，可以求梯度</li>
<li>梯度可以通过 $\mu$ 和 $\sigma$ 反向传播到编码器</li>
</ul>
<hr>
<h3 id="问题-4：VAE-生成的图像为什么模糊？"><a href="#问题-4：VAE-生成的图像为什么模糊？" class="headerlink" title="问题 4：VAE 生成的图像为什么模糊？"></a>问题 4：VAE 生成的图像为什么模糊？</h3><p><strong>原因</strong>：</p>
<ol>
<li><strong>高斯似然假设</strong>：$p(x|z) &#x3D; \mathcal{N}(\text{Decoder}(z), I)$ 倾向于生成平均化的结果</li>
<li><strong>重构损失</strong>：MSE 或 BCE 惩罚像素级差异，导致模糊</li>
</ol>
<p><strong>改进方法</strong>：</p>
<ul>
<li>使用更复杂的似然分布（如混合高斯）</li>
<li>使用感知损失（perceptual loss）</li>
<li>结合 GAN（VAE-GAN）</li>
</ul>
<hr>
<h2 id="参考资源"><a href="#参考资源" class="headerlink" title="参考资源"></a>参考资源</h2><ul>
<li><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1312.6114">Auto-Encoding Variational Bayes (VAE 原论文)</a></li>
<li><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1606.05908">Tutorial on Variational Autoencoders</a></li>
<li><a target="_blank" rel="noopener" href="https://openreview.net/forum?id=Sy2fzU9gl">β-VAE: Learning Basic Visual Concepts with a Constrained Variational Framework</a></li>
<li><a target="_blank" rel="noopener" href="https://arxiv.org/abs/1804.03599">Understanding disentangling in β-VAE</a></li>
<li><a target="_blank" rel="noopener" href="https://www.microsoft.com/en-us/research/publication/pattern-recognition-machine-learning/">Pattern Recognition and Machine Learning - Christopher Bishop</a></li>
</ul>
<hr>
</div><script src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.0/dist/js/lightgallery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-fullscreen.js@1.2.0/dist/lg-fullscreen.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.3.0/dist/lg-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-autoplay.js@1.2.0/dist/lg-autoplay.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-video.js@1.3.0/dist/lg-video.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-hash.js@1.0.0/dist/lg-hash.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-pager.js@1.0.0/dist/lg-pager.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script></div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2026/01/29/%5BOBS%5DAI-KL-Divergence-Basics/"><img class="fill" src="/gallery/AI.png" alt="KL 散度基础理论与数学推导" referrerpolicy="no-referrer"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2026-01-29T11:00:00.000Z" title="1/29/2026, 7:00:00 PM">2026-01-29</time></span><span class="level-item">Updated&nbsp;<time dateTime="2026-02-14T16:35:53.762Z" title="2/15/2026, 12:35:53 AM">2026-02-15</time></span><span class="level-item"><a class="link-muted" href="/categories/Note/">Note</a></span><span class="level-item">19 minutes read (About 2920 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2026/01/29/%5BOBS%5DAI-KL-Divergence-Basics/">KL 散度基础理论与数学推导</a></p><div class="content"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.0/dist/css/lightgallery.min.css" /><div class=".article-gallery"><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Information_theory">Information Theory</a> | <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Kullback%E2%80%93Leibler_divergence">Kullback-Leibler Divergence</a></p>
<hr>
<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>KL 散度（Kullback-Leibler Divergence），也称为<strong>相对熵</strong>（Relative Entropy），是信息论和统计学中用于衡量两个概率分布差异的重要度量。它在机器学习、深度学习、变分推断等领域有广泛应用。<br>本笔记重点介绍 KL 散度的基础定义、数学推导、核心性质以及其在机器学习中的意义。</p>
<hr>
<h2 id="数学定义"><a href="#数学定义" class="headerlink" title="数学定义"></a>数学定义</h2><h3 id="离散概率分布"><a href="#离散概率分布" class="headerlink" title="离散概率分布"></a>离散概率分布</h3><p>对于离散概率分布 $P$ 和 $Q$，KL 散度定义为：</p>
<p>$$D_{KL}(P||Q) &#x3D; \sum_{x} P(x) \log\frac{P(x)}{Q(x)}$$</p>
<h3 id="连续概率分布"><a href="#连续概率分布" class="headerlink" title="连续概率分布"></a>连续概率分布</h3><p>对于连续概率分布，KL 散度定义为：</p>
<p>$$D_{KL}(P||Q) &#x3D; \int p(x) \log\frac{p(x)}{q(x)} dx$$</p>
<p>其中：</p>
<ul>
<li>$P$ 是真实分布（或目标分布）</li>
<li>$Q$ 是近似分布（或模型分布）</li>
<li>$\log$ 通常使用自然对数（以 $e$ 为底），单位为 nats；使用以 2 为底的对数时，单位为 bits</li>
</ul>
<hr>
<h2 id="核心性质"><a href="#核心性质" class="headerlink" title="核心性质"></a>核心性质</h2><h3 id="1-非负性"><a href="#1-非负性" class="headerlink" title="1. 非负性"></a>1. 非负性</h3><p>$$D_{KL}(P||Q) \geq 0$$</p>
<p>当��仅当 $P &#x3D; Q$ 时，等号成立（即 $D_{KL}(P||Q) &#x3D; 0$）。</p>
<h3 id="2-非对称性"><a href="#2-非对称性" class="headerlink" title="2. 非对称性"></a>2. 非对称性</h3><p>$$D_{KL}(P||Q) \neq D_{KL}(Q||P)$$</p>
<p>这意味着 KL 散度<strong>不是真正的距离度量</strong>，因为它不满足对称性。</p>
<h3 id="3-不满足三角不等式"><a href="#3-不满足三角不等式" class="headerlink" title="3. 不满足三角不等式"></a>3. 不满足三角不等式</h3><p>KL 散度不满足三角不等式：</p>
<p>$$D_{KL}(P||R) \not\leq D_{KL}(P||Q) + D_{KL}(Q||R)$$</p>
<p>因此，KL 散度不是度量空间中的距离函数。</p>
<h3 id="4-凸性"><a href="#4-凸性" class="headerlink" title="4. 凸性"></a>4. 凸性</h3><p>KL 散度关于第一个参数 $P$ 是凸函数。</p>
<hr>
<h2 id="直观理解"><a href="#直观理解" class="headerlink" title="直观理解"></a>直观理解</h2><h3 id="信息论角度"><a href="#信息论角度" class="headerlink" title="信息论角度"></a>信息论角度</h3><p>KL 散度表示：<strong>用分布 $Q$ 来编码分布 $P$ 的样本时，相比用 $P$ 自身编码所需的额外信息量</strong>（以比特或 nats 为单位）。</p>
<ul>
<li>如果 $Q$ 与 $P$ 完全相同，则不需要额外信息，$D_{KL}(P||Q) &#x3D; 0$</li>
<li>如果 $Q$ 与 $P$ 差异很大，则需要更多额外信息来补偿编码效率的损失</li>
</ul>
<h3 id="统计学角度"><a href="#统计学角度" class="headerlink" title="统计学角度"></a>统计学角度</h3><p>KL 散度衡量<strong>分布 $Q$ 对分布 $P$ 的近似程度</strong>：</p>
<ul>
<li>值越小，$Q$ 越接近 $P$</li>
<li>值越大，$Q$ 与 $P$ 的差异越大</li>
</ul>
<h3 id="机器学习角度"><a href="#机器学习角度" class="headerlink" title="机器学习角度"></a>机器学习角度</h3><p>在机器学习中，通常：</p>
<ul>
<li>$P$ 是真实数据分布（未知但可以从数据中采样）</li>
<li>$Q$ 是模型学习的分布（由参数 $\theta$ 决定）</li>
<li>最小化 $D_{KL}(P||Q)$ 等价于让模型分布尽可能接近真实分布</li>
</ul>
<hr>
<h2 id="数学推导"><a href="#数学推导" class="headerlink" title="数学推导"></a>数学推导</h2><h3 id="1-从信息熵推导"><a href="#1-从信息熵推导" class="headerlink" title="1. 从信息熵推导"></a>1. 从信息熵推导</h3><h4 id="信息熵（Entropy）"><a href="#信息熵（Entropy）" class="headerlink" title="信息熵（Entropy）"></a>信息熵（Entropy）</h4><p>分布 $P$ 的信息熵定义为：</p>
<p>$$H(P) &#x3D; -\sum_{x} P(x) \log P(x)$$</p>
<p>它表示编码分布 $P$ 的样本所需的<strong>平均最小比特数</strong>。</p>
<h4 id="交叉熵（Cross-Entropy）"><a href="#交叉熵（Cross-Entropy）" class="headerlink" title="交叉熵（Cross Entropy）"></a>交叉熵（Cross Entropy）</h4><p>用分布 $Q$ 来编码分布 $P$ 的样本所需的平均比特数：</p>
<p>$$H(P, Q) &#x3D; -\sum_{x} P(x) \log Q(x)$$</p>
<h4 id="KL-散度-x3D-交叉熵-信息熵"><a href="#KL-散度-x3D-交叉熵-信息熵" class="headerlink" title="KL 散度 &#x3D; 交叉熵 - 信息熵"></a>KL 散度 &#x3D; 交叉熵 - 信息熵</h4><p>$$\begin{align}<br>D_{KL}(P||Q) &amp;&#x3D; H(P, Q) - H(P) \<br>&amp;&#x3D; -\sum_{x} P(x) \log Q(x) + \sum_{x} P(x) \log P(x) \<br>&amp;&#x3D; \sum_{x} P(x) [\log P(x) - \log Q(x)] \<br>&amp;&#x3D; \sum_{x} P(x) \log\frac{P(x)}{Q(x)}<br>\end{align}$$</p>
<p>这表明 KL 散度是<strong>使用次优编码方案 $Q$ 相比最优编码方案 $P$ 所需的额外信息量</strong>。</p>
<hr>
<h3 id="2-非负性证明（Gibbs-不等式）"><a href="#2-非负性证明（Gibbs-不等式）" class="headerlink" title="2. 非负性证明（Gibbs 不等式）"></a>2. 非负性证明（Gibbs 不等式）</h3><p>我们使用 <strong>Jensen 不等式</strong>来证明 KL 散度的非负性。</p>
<h4 id="Jensen-不等式"><a href="#Jensen-不等式" class="headerlink" title="Jensen 不等式"></a>Jensen 不等式</h4><p>对于凸函数 $f(x)$ 和概率分布 $P$：</p>
<p>$$f\left(\sum_{x} P(x) \cdot x\right) \leq \sum_{x} P(x) \cdot f(x)$$</p>
<p>对于凹函数（如 $\log$），不等号反向。</p>
<h4 id="证明过程"><a href="#证明过程" class="headerlink" title="证明过程"></a>证明过程</h4><p>由于 $f(x) &#x3D; -\log(x)$ 是凸函数，我们有：</p>
<p>$$\begin{align}<br>D_{KL}(P||Q) &amp;&#x3D; \sum_{x} P(x) \log\frac{P(x)}{Q(x)} \<br>&amp;&#x3D; -\sum_{x} P(x) \log\frac{Q(x)}{P(x)} \<br>&amp;\geq -\log\left(\sum_{x} P(x) \cdot \frac{Q(x)}{P(x)}\right) \quad \text{[Jensen 不等式]} \<br>&amp;&#x3D; -\log\left(\sum_{x} Q(x)\right) \<br>&amp;&#x3D; -\log(1) \<br>&amp;&#x3D; 0<br>\end{align}$$</p>
<p>等号成立当且仅当 $\frac{Q(x)}{P(x)}$ 为常数，即 $P(x) &#x3D; Q(x)$ 对所有 $x$ 成立。</p>
<p><strong>结论</strong>：$D_{KL}(P||Q) \geq 0$，且仅当 $P &#x3D; Q$ 时等号成立。</p>
<hr>
<h3 id="3-与最大似然估计的关系"><a href="#3-与最大似然估计的关系" class="headerlink" title="3. 与最大似然估计的关系"></a>3. 与最大似然估计的关系</h3><p>在机器学习中，我们通常希望找到参数 $\theta$ 使得模型分布 $P_\theta$ 尽可能接近真实数据分布 $P_{data}$。</p>
<h4 id="最小化-KL-散度"><a href="#最小化-KL-散度" class="headerlink" title="最小化 KL 散度"></a>最小化 KL 散度</h4><p>$$\begin{align}<br>\min_\theta D_{KL}(P_{data}||P_\theta) &amp;&#x3D; \min_\theta \sum_{x} P_{data}(x) \log\frac{P_{data}(x)}{P_\theta(x)} \<br>&amp;&#x3D; \min_\theta \left[\sum_{x} P_{data}(x) \log P_{data}(x) - \sum_{x} P_{data}(x) \log P_\theta(x)\right] \<br>&amp;&#x3D; \min_\theta \left[-\sum_{x} P_{data}(x) \log P_\theta(x)\right] \quad \text{[第一项与 $\theta$ 无关]} \<br>&amp;&#x3D; \max_\theta \sum_{x} P_{data}(x) \log P_\theta(x)<br>\end{align}$$</p>
<h4 id="经验分布近似"><a href="#经验分布近似" class="headerlink" title="经验分布近似"></a>经验分布近似</h4><p>在实践中，我们无法直接访问 $P_{data}$，但可以从数据集 ${x_1, x_2, \ldots, x_N}$ 中采样。使用经验分布：<br>$$P_{data}(x) \approx \frac{1}{N} \sum_{i&#x3D;1}^{N} \delta(x - x_i)$$</p>
<p>代入上式：</p>
<p>$$\max_\theta \sum_{x} P_{data}(x) \log P_\theta(x) \approx \max_\theta \frac{1}{N} \sum_{i&#x3D;1}^{N} \log P_\theta(x_i)$$</p>
<p>这正是最大似然估计（Maximum Likelihood Estimation, MLE）的目标函数！<br>结论：最小化 KL 散度等价于最大化似然函数。</p>
<hr>
<h2 id="实际计算示例"><a href="#实际计算示例" class="headerlink" title="实际计算示例"></a>实际计算示例</h2><h3 id="示例-1：离散分布"><a href="#示例-1：离散分布" class="headerlink" title="示例 1：离散分布"></a>示例 1：离散分布</h3><p>假设真实分布 $P &#x3D; [0.5, 0.3, 0.2]$，近似分布 $Q &#x3D; [0.4, 0.4, 0.2]$。</p>
<p>计算 $D_{KL}(P||Q)$：</p>
<p>$$\begin{align}<br>D_{KL}(P||Q) &amp;&#x3D; 0.5 \cdot \log\frac{0.5}{0.4} + 0.3 \cdot \log\frac{0.3}{0.4} + 0.2 \cdot \log\frac{0.2}{0.2} \<br>&amp;&#x3D; 0.5 \cdot \log(1.25) + 0.3 \cdot \log(0.75) + 0.2 \cdot \log(1) \<br>&amp;&#x3D; 0.5 \times 0.2231 + 0.3 \times (-0.2877) + 0 \<br>&amp;&#x3D; 0.1116 - 0.0863 \<br>&amp;\approx 0.0253 \text{ nats}<br>\end{align}$$</p>
<p>转换为 bits（除以 $\ln 2 \approx 0.693$）：</p>
<p>$$D_{KL}(P||Q) \approx 0.0365 \text{ bits}$$</p>
<h3 id="示例-2：高斯分布"><a href="#示例-2：高斯分布" class="headerlink" title="示例 2：高斯分布"></a>示例 2：高斯分布</h3><p>对于两个一维高斯分布：</p>
<ul>
<li>$P &#x3D; \mathcal{N}(\mu_1, \sigma_1^2)$</li>
<li>$Q &#x3D; \mathcal{N}(\mu_2, \sigma_2^2)$</li>
</ul>
<p>KL 散度的闭式解为：</p>
<p>$$D_{KL}(P||Q) &#x3D; \log\frac{\sigma_2}{\sigma_1} + \frac{\sigma_1^2 + (\mu_1 - \mu_2)^2}{2\sigma_2^2} - \frac{1}{2}$$</p>
<p><strong>特殊情况</strong>：当 $Q &#x3D; \mathcal{N}(0, 1)$（标准正态分布）时：</p>
<p>$$D_{KL}(P||Q) &#x3D; \frac{1}{2}\left(\mu_1^2 + \sigma_1^2 - \log\sigma_1^2 - 1\right)$$</p>
<p>这个公式在 VAE（变分自编码器）中被广泛使用。</p>
<hr>
<h2 id="机器学习中的应用"><a href="#机器学习中的应用" class="headerlink" title="机器学习中的应用"></a>机器学习中的应用</h2><h3 id="1-变分推断（Variational-Inference）"><a href="#1-变分推断（Variational-Inference）" class="headerlink" title="1. 变分推断（Variational Inference）"></a>1. 变分推断（Variational Inference）</h3><p>在贝叶斯推断中，我们希望计算后验分布 $P(\theta|X)$，但通常难以直接计算。变分推断使用一个简单的分布 $Q(\theta)$ 来近似：<br>$$\min_Q D_{KL}(Q(\theta)||P(\theta|X))$$</p>
<h3 id="2-变分自编码器（VAE）"><a href="#2-变分自编码器（VAE）" class="headerlink" title="2. 变分自编码器（VAE）"></a>2. 变分自编码器（VAE）</h3><p>VAE 的损失函数包含 KL 散度项，用于正则化潜在空间：</p>
<p>$$\mathcal{L} &#x3D; \mathbb{E}<em>{q(z|x)}[\log p(x|z)] - D</em>{KL}(q(z|x)||p(z))$$</p>
<p>其中：</p>
<ul>
<li>第一项是重建损失</li>
<li>第二项是 KL 散度，约束编码器输出接近先验分布</li>
</ul>
<h3 id="3-策略优化（强化学习）"><a href="#3-策略优化（强化学习）" class="headerlink" title="3. 策略优化（强化学习）"></a>3. 策略优化（强化学习）</h3><p>在强化学习中，KL 散度用于约束策略更新的幅度：<br>$$\max_\theta \mathbb{E}<em>{\pi_\theta}[R] \quad \text{s.t.} \quad D</em>{KL}(\pi_{old}||\pi_\theta) \leq \delta$$</p>
<p>这是 TRPO（Trust Region Policy Optimization）和 PPO（Proximal Policy Optimization）的核心思想。</p>
<h3 id="4-模型蒸馏（Knowledge-Distillation）"><a href="#4-模型蒸馏（Knowledge-Distillation）" class="headerlink" title="4. 模型蒸馏（Knowledge Distillation）"></a>4. 模型蒸馏（Knowledge Distillation）</h3><p>使用 KL 散度让小模型（学生）学习大模型（教师）的输出分布：</p>
<p>$$\mathcal{L} &#x3D; D_{KL}(P_{teacher}||P_{student})$$</p>
<h3 id="5-生成对抗网络（GAN）"><a href="#5-生成对抗网络（GAN）" class="headerlink" title="5. 生成对抗网络（GAN）"></a>5. 生成对抗网络（GAN）</h3><p>虽然 GAN 不直接优化 KL 散度，但理论分析表明，GAN 的目标函数与 JS 散度（Jensen-Shannon Divergence）相关，而 JS 散度是基于 KL 散度定义的：</p>
<p>$$D_{JS}(P||Q) &#x3D; \frac{1}{2}D_{KL}(P||M) + \frac{1}{2}D_{KL}(Q||M)$$</p>
<p>其中 $M &#x3D; \frac{1}{2}(P + Q)$。</p>
<hr>
<h2 id="前向-KL-与反向-KL"><a href="#前向-KL-与反向-KL" class="headerlink" title="前向 KL 与反向 KL"></a>前向 KL 与反向 KL</h2><h3 id="前向-KL：-D-KL-P-Q"><a href="#前向-KL：-D-KL-P-Q" class="headerlink" title="前向 KL：$D_{KL}(P||Q)$"></a>前向 KL：$D_{KL}(P||Q)$</h3><ul>
<li><strong>含义</strong>：用 $Q$ 近似 $P$</li>
<li><strong>特点</strong>：<ul>
<li>当 $P(x) &gt; 0$ 但 $Q(x) &#x3D; 0$ 时，散度为无穷大</li>
<li>要求 $Q$ 覆盖 $P$ 的所有支撑集（zero-avoiding）</li>
<li>$Q$ 倾向于覆盖 $P$ 的所有模式，可能过于分散</li>
</ul>
</li>
</ul>
<h3 id="反向-KL：-D-KL-Q-P"><a href="#反向-KL：-D-KL-Q-P" class="headerlink" title="反向 KL：$D_{KL}(Q||P)$"></a>反向 KL：$D_{KL}(Q||P)$</h3><ul>
<li><strong>含义</strong>：用 $Q$ 近似 $P$（但优化方向相反）</li>
<li><strong>特点</strong>：<ul>
<li>当 $Q(x) &gt; 0$ 但 $P(x) &#x3D; 0$ 时，散度为无穷大</li>
<li>要求 $Q$ 集中在 $P$ 的高概率区域（zero-forcing）</li>
<li>$Q$ 倾向于选择 $P$ 的某一个模式，可能过于集中</li>
</ul>
</li>
</ul>
<h3 id="对比表格"><a href="#对比表格" class="headerlink" title="对比表格"></a>对比表格</h3><table>
<thead>
<tr>
<th>特性</th>
<th>前向 KL $D_{KL}(P||Q)$</th>
<th>反向 KL $D_{KL}(Q||P)$</th>
</tr>
</thead>
<tbody><tr>
<td><strong>优化目标</strong></td>
<td>最大似然估计</td>
<td>变分推断</td>
</tr>
<tr>
<td><strong>行为</strong></td>
<td>Zero-avoiding（避免零概率）</td>
<td>Zero-forcing（强制零概率）</td>
</tr>
<tr>
<td><strong>多模态处理</strong></td>
<td>覆盖所有模式（分散）</td>
<td>选择单一模式（集中）</td>
</tr>
<tr>
<td><strong>应用</strong></td>
<td>监督学习、MLE</td>
<td>VAE、变分推断</td>
</tr>
</tbody></table>
<hr>
<h2 id="与其他散度的关系"><a href="#与其他散度的关系" class="headerlink" title="与其他散度的关系"></a>与其他散度的关系</h2><h3 id="1-JS-散度（Jensen-Shannon-Divergence）"><a href="#1-JS-散度（Jensen-Shannon-Divergence）" class="headerlink" title="1. JS 散度（Jensen-Shannon Divergence）"></a>1. JS 散度（Jensen-Shannon Divergence）</h3><p>JS 散度是 KL 散度的对称化版本：</p>
<p>$$D_{JS}(P||Q) &#x3D; \frac{1}{2}D_{KL}(P||M) + \frac{1}{2}D_{KL}(Q||M)$$<br>其中 $M &#x3D; \frac{1}{2}(P + Q)$。<br><strong>性质</strong>：</p>
<ul>
<li>对称：$D_{JS}(P||Q) &#x3D; D_{JS}(Q||P)$</li>
<li>有界：$0 \leq D_{JS}(P||Q) \leq \log 2$</li>
<li>满足三角不等式的平方根</li>
</ul>
<h3 id="2-Wasserstein-距离"><a href="#2-Wasserstein-距离" class="headerlink" title="2. Wasserstein 距离"></a>2. Wasserstein 距离</h3><p>Wasserstein 距离（也称为 Earth Mover’s Distance）是另一种衡量分布差异的度量，在 GAN 中被广泛使用（WGAN）。<br>与 KL 散度相比：</p>
<ul>
<li>Wasserstein 距离是真正的度量（满足对称性和三角不等式）</li>
<li>即使两个分布没有重叠，Wasserstein 距离仍然有意义</li>
<li>KL 散度在分布不重叠时可能为无穷大</li>
</ul>
<h3 id="3-chi-2-散度"><a href="#3-chi-2-散度" class="headerlink" title="3. $\chi^2$ 散度"></a>3. $\chi^2$ 散度</h3><p>$$D_{\chi^2}(P||Q) &#x3D; \sum_{x} \frac{(P(x) - Q(x))^2}{Q(x)}$$<br>与 KL 散度相比，$\chi^2$ 散度对分布差异更敏感。</p>
<hr>
<h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><h3 id="问题-1：为什么-KL-散度不对称？"><a href="#问题-1：为什么-KL-散度不对称？" class="headerlink" title="问题 1：为什么 KL 散度不对称？"></a>问题 1：为什么 KL 散度不对称？</h3><p><strong>原因</strong>：KL 散度的定义中，$P$ 和 $Q$ 的角色不同：</p>
<p>$$D_{KL}(P||Q) &#x3D; \sum_{x} P(x) \log\frac{P(x)}{Q(x)}$$</p>
<ul>
<li>$P$ 作为权重出现在求和中</li>
<li>$Q$ 出现在对数的分母中</li>
</ul>
<p>交换 $P$ 和 $Q$ 会得到不同的结果。</p>
<p><strong>直观理解</strong>：</p>
<ul>
<li>$D_{KL}(P||Q)$ 衡量”用 $Q$ 编码 $P$ 的样本”的额外信息</li>
<li>$D_{KL}(Q||P)$ 衡量”用 $P$ 编码 $Q$ 的样本”的额外信息</li>
<li>这两者通常不相等</li>
</ul>
<hr>
<h3 id="问题-2：什么时候使用前向-KL，什么时候使用反向-KL？"><a href="#问题-2：什么时候使用前向-KL，什么时候使用反向-KL？" class="headerlink" title="问题 2：什么时候使用前向 KL，什么时候使用反向 KL？"></a>问题 2：什么时候使用前向 KL，什么时候使用反向 KL？</h3><p>**前向 KL $D_{KL}(P||Q)$**：</p>
<ul>
<li>当你希望 $Q$ 覆盖 $P$ 的所有模式时</li>
<li>最大似然估计</li>
<li>监督学习<br>**反向 KL $D_{KL}(Q||P)$**：</li>
<li>当你希望 $Q$ 集中在 $P$ 的高概率区域时</li>
<li>变分推断</li>
<li>VAE、变分贝叶斯</li>
</ul>
<hr>
<h3 id="问题-3：KL-散度可以为负吗？"><a href="#问题-3：KL-散度可以为负吗？" class="headerlink" title="问题 3：KL 散度可以为负吗？"></a>问题 3：KL 散度可以为负吗？</h3><p><strong>不可以</strong>。根据 Gibbs 不等式，KL 散度始终非负：</p>
<p>$$D_{KL}(P||Q) \geq 0$$<br>当且仅当 $P &#x3D; Q$ 时，$D_{KL}(P||Q) &#x3D; 0$。</p>
<hr>
<h3 id="问题-4：如何处理-Q-x-x3D-0-的情况？"><a href="#问题-4：如何处理-Q-x-x3D-0-的情况？" class="headerlink" title="问题 4：如何处理 $Q(x) &#x3D; 0$ 的情况？"></a>问题 4：如何处理 $Q(x) &#x3D; 0$ 的情况？</h3><p>当 $P(x) &gt; 0$ 但 $Q(x) &#x3D; 0$ 时，$\log\frac{P(x)}{Q(x)} &#x3D; \infty$，导致 KL 散度为无穷大。</p>
<p><strong>解决方法</strong>：</p>
<ol>
<li><strong>拉普拉斯平滑</strong>：给 $Q(x)$ 加一个小的常数 $\epsilon$</li>
<li><strong>确保支撑集匹配</strong>：保证 $Q$ 的支撑集包含 $P$ 的支撑集</li>
<li><strong>使用其他散度</strong>：如 Wasserstein 距离，对不重叠分布更鲁棒</li>
</ol>
<hr>
<h2 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h2><h3 id="1-数值稳定性"><a href="#1-数值稳定性" class="headerlink" title="1. 数值稳定性"></a>1. 数值稳定性</h3><h2 id="在实现-KL-散度时，避免直接计算-log-frac-P-x-Q-x-，而是使用：-2-处理零概率-3-使用库函数大多数深度学习框架提供了优化的-KL-散度实现："><a href="#在实现-KL-散度时，避免直接计算-log-frac-P-x-Q-x-，而是使用：-2-处理零概率-3-使用库函数大多数深度学习框架提供了优化的-KL-散度实现：" class="headerlink" title="在实现 KL 散度时，避免直接计算 $\log\frac{P(x)}{Q(x)}$，而是使用：### 2. 处理零概率### 3. 使用库函数大多数深度学习框架提供了优化的 KL 散度实现："></a>在实现 KL 散度时，避免直接计算 $\log\frac{P(x)}{Q(x)}$，而是使用：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不稳定的实现</span></span><br><span class="line">kl = P * np.log(P / Q)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 稳定的实现</span></span><br><span class="line">kl = P * (np.log(P) - np.log(Q))</span><br></pre></td></tr></table></figure><br>### 2. 处理零概率<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加小的 epsilon 避免 log(0)</span></span><br><span class="line">epsilon = <span class="number">1e-10</span></span><br><span class="line">kl = P * (np.log(P + epsilon) - np.log(Q + epsilon))</span><br></pre></td></tr></table></figure><br>### 3. 使用库函数<br>大多数深度学习框架提供了优化的 KL 散度实现：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># PyTorch</span></span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line">kl_loss = F.kl_div(Q.log(), P, reduction=<span class="string">&#x27;batchmean&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># TensorFlow</span></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line">kl_loss = tf.keras.losses.KLDivergence()(P, Q)</span><br><span class="line"></span><br><span class="line"><span class="comment"># SciPy</span></span><br><span class="line"><span class="keyword">from</span> scipy.stats <span class="keyword">import</span> entropy</span><br><span class="line">kl_div = entropy(P, Q)</span><br></pre></td></tr></table></figure></h2><h2 id="参考资源"><a href="#参考资源" class="headerlink" title="参考资源"></a>参考资源</h2><ul>
<li><a target="_blank" rel="noopener" href="http://www.inference.org.uk/mackay/itila/">Information Theory, Inference, and Learning Algorithms - David MacKay</a></li>
<li><a target="_blank" rel="noopener" href="https://www.microsoft.com/en-us/research/publication/pattern-recognition-machine-learning/">Pattern Recognition and Machine Learning - Christopher Bishop</a></li>
<li><a target="_blank" rel="noopener" href="https://www.deeplearningbook.org/">Deep Learning Book - Ian Goodfellow et al.</a></li>
<li><a target="_blank" rel="noopener" href="https://www.countbayesie.com/blog/2017/5/9/kullback-leibler-divergence-explained">Kullback-Leibler Divergence Explained</a></li>
</ul>
<hr>
</div><script src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.0/dist/js/lightgallery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-fullscreen.js@1.2.0/dist/lg-fullscreen.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.3.0/dist/lg-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-autoplay.js@1.2.0/dist/lg-autoplay.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-video.js@1.3.0/dist/lg-video.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-hash.js@1.0.0/dist/lg-hash.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-pager.js@1.0.0/dist/lg-pager.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script></div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2026/01/29/%5BOBS%5DAI-Claude%20Code-Claude%20Code%20Skills/"><img class="fill" src="/gallery/AI.png" alt="Claude Code Skills" referrerpolicy="no-referrer"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2026-01-29T00:00:00.000Z" title="1/29/2026, 8:00:00 AM">2026-01-29</time></span><span class="level-item">Updated&nbsp;<time dateTime="2026-02-14T16:35:53.752Z" title="2/15/2026, 12:35:53 AM">2026-02-15</time></span><span class="level-item"><a class="link-muted" href="/categories/Note/">Note</a></span><span class="level-item">13 minutes read (About 1978 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2026/01/29/%5BOBS%5DAI-Claude%20Code-Claude%20Code%20Skills/">Claude Code Skills</a></p><div class="content"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.0/dist/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="Claude-Code-Skills-使用指南"><a href="#Claude-Code-Skills-使用指南" class="headerlink" title="Claude Code Skills 使用指南"></a>Claude Code Skills 使用指南</h1><p><a target="_blank" rel="noopener" href="https://code.claude.com/docs/en/skills.md">官方文档</a> | <a target="_blank" rel="noopener" href="https://agentskills.io/">Agent Skills 标准</a></p>
<hr>
<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p><strong>Skills（技能）</strong> 是扩展 Claude Code 能力的自定义工作流。通过 Markdown 文件定义，可以用斜杠命令调用或自动加载。<br>Skills 遵循开放的 <a target="_blank" rel="noopener" href="https://agentskills.io/">Agent Skills</a> 标准，可跨多个 AI 工具使用。</p>
<hr>
<h2 id="核心概念"><a href="#核心概念" class="headerlink" title="核心概念"></a>核心概念</h2><h3 id="Skills-的作用"><a href="#Skills-的作用" class="headerlink" title="Skills 的作用"></a>Skills 的作用</h3><ul>
<li><strong>自定义斜杠命令</strong>：直接调用专门的工作流（如 <code>/commit</code>、<code>/review</code>）</li>
<li><strong>领域知识注入</strong>：为 Claude 提供特定领域的上下文</li>
<li><strong>任务指令</strong>：定义复杂操作的步骤流程</li>
<li><strong>工具集成</strong>：连接外部工具和脚本</li>
</ul>
<h3 id="文件结构"><a href="#文件结构" class="headerlink" title="文件结构"></a>文件结构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">skill-name/</span><br><span class="line">├── SKILL.md          # 必需：主要技能定义</span><br><span class="line">├── reference.md      # 可选：详细文档</span><br><span class="line">├── examples.md       # 可选：使用示例</span><br><span class="line">└── scripts/          # 可选：辅助脚本</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="Skill-位置与作用域"><a href="#Skill-位置与作用域" class="headerlink" title="Skill 位置与作用域"></a>Skill 位置与作用域</h2><table>
<thead>
<tr>
<th>位置</th>
<th>路径</th>
<th>作用域</th>
</tr>
</thead>
<tbody><tr>
<td><strong>个人级</strong></td>
<td><code>~/.claude/skills/&lt;skill-name&gt;/SKILL.md</code></td>
<td>用户所有项目</td>
</tr>
<tr>
<td><strong>项目级</strong></td>
<td><code>.claude/skills/&lt;skill-name&gt;/SKILL.md</code></td>
<td>仅当前项目</td>
</tr>
<tr>
<td><strong>企业级</strong></td>
<td>通过设置管理</td>
<td>组织范围</td>
</tr>
</tbody></table>
<p><strong>优先级</strong>：项目级 &gt; 个人级 &gt; 企业级</p>
<hr>
<h2 id="创建-Skill"><a href="#创建-Skill" class="headerlink" title="创建 Skill"></a>创建 Skill</h2><h3 id="基本结构"><a href="#基本结构" class="headerlink" title="基本结构"></a>基本结构</h3><p>最简单的 skill 只需一个带 YAML 头的 <code>SKILL.md</code> 文件：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">explain-code</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">用图表和类比解释代码。当用户询问&quot;这段代码如何工作&quot;时使用</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="string">解释代码时，始终包含：</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span><span class="string">.</span> <span class="string">**类比**：用日常生活中的事物比喻代码</span></span><br><span class="line"><span class="number">2</span><span class="string">.</span> <span class="string">**图表**：用</span> <span class="string">ASCII</span> <span class="string">艺术展示流程或结构</span></span><br><span class="line"><span class="number">3</span><span class="string">.</span> <span class="string">**逐步讲解**：���释每一步发生了什么</span></span><br><span class="line"><span class="number">4</span><span class="string">.</span> <span class="string">**常见误区**：指出容易混淆的点</span></span><br></pre></td></tr></table></figure>

<h3 id="配置选项-Frontmatter"><a href="#配置选项-Frontmatter" class="headerlink" title="配置选项 (Frontmatter)"></a>配置选项 (Frontmatter)</h3><table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>name</code></td>
<td>string</td>
<td>显示名称（成为 <code>/斜杠命令</code>）</td>
</tr>
<tr>
<td><code>description</code></td>
<td>string</td>
<td>功能描述 - 用于自动调用判断</td>
</tr>
<tr>
<td><code>disable-model-invocation</code></td>
<td>boolean</td>
<td>为 <code>true</code> 时仅用户可调用（禁止自动加载）</td>
</tr>
<tr>
<td><code>user-invocable</code></td>
<td>boolean</td>
<td>为 <code>false</code> 时仅 Claude 可调用（菜单中隐藏）</td>
</tr>
<tr>
<td><code>allowed-tools</code></td>
<td>array</td>
<td>Claude 可使用的工具列表（无需权限提示）</td>
</tr>
<tr>
<td><code>context</code></td>
<td>string</td>
<td>设为 <code>fork</code> 在隔离的子代理中运行</td>
</tr>
<tr>
<td><code>agent</code></td>
<td>string</td>
<td>指定代理类型（如 <code>Explore</code>、<code>Plan</code>）</td>
</tr>
<tr>
<td><code>argument-hint</code></td>
<td>string</td>
<td>自动补全提示（如 <code>[issue-number]</code>）</td>
</tr>
</tbody></table>
<hr>
<h2 id="调用方式"><a href="#调用方式" class="headerlink" title="调用方式"></a>调用方式</h2><h3 id="1-直接调用"><a href="#1-直接调用" class="headerlink" title="1. 直接调用"></a>1. 直接调用</h3><p>用户显式使用斜杠命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/skill-name</span><br><span class="line">/fix-issue 123</span><br><span class="line">/explain-code src/auth/login.ts</span><br></pre></td></tr></table></figure>

<h3 id="2-自动调用"><a href="#2-自动调用" class="headerlink" title="2. 自动调用"></a>2. 自动调用</h3><p>当用户请求匹配 skill 的 <code>description</code> 时，Claude 自动加载：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">用户：&quot;这个认证流程是如何工作的？&quot;</span><br><span class="line">→ Claude 自动加载 /explain-code skill</span><br></pre></td></tr></table></figure>

<p><strong>控制自动调用：</strong></p>
<ul>
<li>设置 <code>disable-model-invocation: true</code> 禁止自动加载</li>
<li>让 description 更具体以避免误触发</li>
</ul>
<hr>
<h2 id="传递参数"><a href="#传递参数" class="headerlink" title="传递参数"></a>传递参数</h2><h3 id="使用-ARGUMENTS"><a href="#使用-ARGUMENTS" class="headerlink" title="使用 $ARGUMENTS"></a>使用 $ARGUMENTS</h3><p><code>$ARGUMENTS</code> 占位符捕获所有参数为单个字符串：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">fix-issue</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">修复</span> <span class="string">GitHub</span> <span class="string">issue</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="string">修复</span> <span class="string">GitHub</span> <span class="string">issue</span> <span class="string">$ARGUMENTS，遵循我们的编码标准。</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span><span class="string">.</span> <span class="string">从</span> <span class="string">GitHub</span> <span class="string">读取</span> <span class="string">issue</span> <span class="string">描述</span></span><br><span class="line"><span class="number">2</span><span class="string">.</span> <span class="string">理解需求</span></span><br><span class="line"><span class="number">3</span><span class="string">.</span> <span class="string">实现修复</span></span><br><span class="line"><span class="number">4</span><span class="string">.</span> <span class="string">编写测试</span></span><br><span class="line"><span class="number">5</span><span class="string">.</span> <span class="string">创建提交</span></span><br></pre></td></tr></table></figure>

<p><strong>用法</strong>：<code>/fix-issue 123</code> → “修复 GitHub issue 123…”</p>
<h3 id="使用位置参数"><a href="#使用位置参数" class="headerlink" title="使用位置参数"></a>使用位置参数</h3><p>用 <code>$0</code>、<code>$1</code>、<code>$2</code> 等访问单个参数：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">migrate-component</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">在框架间迁移组件</span></span><br><span class="line"><span class="attr">argument-hint:</span> [<span class="string">组件名</span>] [<span class="string">源框架</span>] [<span class="string">目标框架</span>]</span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="string">将</span> <span class="string">$0</span> <span class="string">组件从</span> <span class="string">$1</span> <span class="string">迁移到</span> <span class="string">$2。</span></span><br><span class="line"></span><br><span class="line"><span class="string">要求：</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">保留所有现有行为</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">维持测试覆盖率</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">更新文档</span></span><br></pre></td></tr></table></figure>

<p><strong>用法</strong>：<code>/migrate-component SearchBar React Vue</code></p>
<ul>
<li><code>$0</code> &#x3D; SearchBar</li>
<li><code>$1</code> &#x3D; React</li>
<li><code>$2</code> &#x3D; Vue</li>
</ul>
<hr>
<h2 id="高级模式"><a href="#高级模式" class="headerlink" title="高级模式"></a>高级模式</h2><h3 id="动态上下文注入"><a href="#动态上下文注入" class="headerlink" title="动态上下文注入"></a>动态上下文注入</h3><p>使用反引号`和 <code>!</code> 在 skill 运行前执行 shell 命令：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">pr-summary</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">总结</span> <span class="string">Pull</span> <span class="string">Request</span> <span class="string">的变更</span></span><br><span class="line"><span class="attr">context:</span> <span class="string">fork</span></span><br><span class="line"><span class="attr">agent:</span> <span class="string">Explore</span></span><br><span class="line"><span class="attr">allowed-tools:</span> <span class="string">Bash(gh</span> <span class="string">*)</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="comment">## Pull Request 上下文</span></span><br><span class="line"></span><br><span class="line"><span class="string">**差异：**</span></span><br><span class="line"><span class="string">!`gh</span> <span class="string">pr</span> <span class="string">diff`</span></span><br><span class="line"></span><br><span class="line"><span class="string">**评论：**</span></span><br><span class="line"><span class="string">!`gh</span> <span class="string">pr</span> <span class="string">view</span> <span class="string">--comments`</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 任务</span></span><br><span class="line"></span><br><span class="line"><span class="string">总结这个</span> <span class="string">PR，重点关注：</span></span><br><span class="line"><span class="number">1</span><span class="string">.</span> <span class="string">主要变更及其目的</span></span><br><span class="line"><span class="number">2</span><span class="string">.</span> <span class="string">审查者的潜在关注点</span></span><br><span class="line"><span class="number">3</span><span class="string">.</span> <span class="string">测试覆盖情况</span></span><br></pre></td></tr></table></figure>

<h3 id="隔离子代理执行"><a href="#隔离子代理执行" class="headerlink" title="隔离子代理执行"></a>隔离子代理执行</h3><p>在隔离上下文中运行 skill，避免污染主对话：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">deep-research</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">深入研究某个主题而不影响主上下文</span></span><br><span class="line"><span class="attr">context:</span> <span class="string">fork</span></span><br><span class="line"><span class="attr">agent:</span> <span class="string">Explore</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="string">深入研究</span> <span class="string">$ARGUMENTS：</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span><span class="string">.</span> <span class="string">使用</span> <span class="string">Glob</span> <span class="string">和</span> <span class="string">Grep</span> <span class="string">查找相关文件</span></span><br><span class="line"><span class="number">2</span><span class="string">.</span> <span class="string">阅读并分析代码</span></span><br><span class="line"><span class="number">3</span><span class="string">.</span> <span class="string">识别模式和关系</span></span><br><span class="line"><span class="number">4</span><span class="string">.</span> <span class="string">用具体的文件引用（file:line</span> <span class="string">格式）总结发现</span></span><br></pre></td></tr></table></figure>

<h3 id="工具限制"><a href="#工具限制" class="headerlink" title="工具限制"></a>工具限制</h3><p>限制 Claude 在 skill 中可使用的工具：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">read-only-analysis</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">分析代码但不做修改</span></span><br><span class="line"><span class="attr">allowed-tools:</span> <span class="string">Read,</span> <span class="string">Grep,</span> <span class="string">Glob,</span> <span class="string">Bash(git</span> <span class="string">*)</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="string">分析代码库中的</span> <span class="string">$ARGUMENTS。</span></span><br><span class="line"></span><br><span class="line"><span class="string">你只能读取文件和运行</span> <span class="string">git</span> <span class="string">命令。</span></span><br><span class="line"><span class="string">不要修改任何文件。</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h2><h3 id="Skill-设计原则"><a href="#Skill-设计原则" class="headerlink" title="Skill 设计原则"></a>Skill 设计原则</h3><ol>
<li><strong>单一职责</strong>：每个 skill 应有一个明确目的</li>
<li><strong>清晰描述</strong>：description 应匹配用户的自然语言</li>
<li><strong>明确指令</strong>：为复杂工作流提供分步指导</li>
<li><strong>错误处理</strong>：包含常见失败场景的处理说明</li>
</ol>
<h3 id="命名规范"><a href="#命名规范" class="headerlink" title="命名规范"></a>命名规范</h3><ul>
<li>使用小写加连字符：<code>fix-issue</code>、<code>explain-code</code></li>
<li>保持简短易记</li>
<li>使用动词导向的名称</li>
</ul>
<hr>
<h2 id="示例-Skills"><a href="#示例-Skills" class="headerlink" title="示例 Skills"></a>示例 Skills</h2><h3 id="代码审查"><a href="#代码审查" class="headerlink" title="代码审查"></a>代码审查</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">review</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">对变更进行全面的代码审查</span></span><br><span class="line"><span class="attr">disable-model-invocation:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">allowed-tools:</span> <span class="string">Read,</span> <span class="string">Grep,</span> <span class="string">Bash(git</span> <span class="string">*)</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="string">执行全面的代码审查：</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 审查清单</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span><span class="string">.</span> <span class="string">**正确性**：代码是否实现了预期功能？</span></span><br><span class="line"><span class="number">2</span><span class="string">.</span> <span class="string">**安全性**：是否存在安全漏洞？</span></span><br><span class="line"><span class="number">3</span><span class="string">.</span> <span class="string">**性能**：是否有明显的性能问题？</span></span><br><span class="line"><span class="number">4</span><span class="string">.</span> <span class="string">**可维护性**：代码是否可读且结构良好？</span></span><br><span class="line"><span class="number">5</span><span class="string">.</span> <span class="string">**测试**：测试覆盖是否充分？</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 流程</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span><span class="string">.</span> <span class="string">运行</span> <span class="string">`git</span> <span class="string">diff`</span> <span class="string">查看所有变更</span></span><br><span class="line"><span class="number">2</span><span class="string">.</span> <span class="string">完整阅读修改的文件</span></span><br><span class="line"><span class="number">3</span><span class="string">.</span> <span class="string">检查常见问题：SQL</span> <span class="string">注入、XSS、命令注入、竞态条件、内存泄漏、硬编码凭证</span></span><br><span class="line"><span class="number">4</span><span class="string">.</span> <span class="string">提供具体反馈，使用</span> <span class="string">file:line</span> <span class="string">引用</span></span><br></pre></td></tr></table></figure>

<h3 id="文档生成"><a href="#文档生成" class="headerlink" title="文档生成"></a>文档生成</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">document</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">为代码生成文档</span></span><br><span class="line"><span class="attr">argument-hint:</span> [<span class="string">文件路径</span>]</span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="string">为</span> <span class="string">$ARGUMENTS</span> <span class="string">生成全面的文档：</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span><span class="string">.</span> <span class="string">阅读文件并理解其目的</span></span><br><span class="line"><span class="number">2</span><span class="string">.</span> <span class="string">记录：</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">文件概述和用途</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">公共</span> <span class="string">API（函数、类、接口）</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">使用示例</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">依赖和要求</span></span><br><span class="line"><span class="number">3</span><span class="string">.</span> <span class="string">格式化为</span> <span class="string">markdown</span></span><br><span class="line"><span class="number">4</span><span class="string">.</span> <span class="string">在有帮助的地方包含代码示例</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><h3 id="Skill-未自动触发"><a href="#Skill-未自动触发" class="headerlink" title="Skill 未自动触发"></a>Skill 未自动触发</h3><p><strong>问题</strong>：Claude 没有在预期时加载你的 skill。</p>
<p><strong>解决方案</strong>：</p>
<ul>
<li>让 <code>description</code> 更具体，包含用户会自然说出的关键词</li>
<li>检查 <code>/context</code> 确保 skill 描述未超出字符预算</li>
<li>验证 skill 文件在正确位置</li>
</ul>
<h3 id="Skill-触发过于频繁"><a href="#Skill-触发过于频繁" class="headerlink" title="Skill 触发过于频繁"></a>Skill 触发过于频繁</h3><p><strong>问题</strong>：Skill 在不需要时加载。</p>
<p><strong>解决方案</strong>：</p>
<ul>
<li>让 description 更具体</li>
<li>添加 <code>disable-model-invocation: true</code> 要求显式调用</li>
<li>在 description 中使用更独特的关键词</li>
</ul>
<h3 id="参数不工作"><a href="#参数不工作" class="headerlink" title="参数不工作"></a>参数不工作</h3><p><strong>问题</strong>：<code>$ARGUMENTS</code> 或 <code>$0</code>、<code>$1</code> 未被替换。</p>
<p><strong>解决方案</strong>：</p>
<ul>
<li>确保传递了参数：<code>/skill-name arg1 arg2</code></li>
<li>检查占位符在 skill 正文中，而非仅在 frontmatter 中</li>
<li>验证占位符语法无拼写错误</li>
</ul>
<hr>
<h2 id="工作流集成示例"><a href="#工作流集成示例" class="headerlink" title="工作流集成示例"></a>工作流集成示例</h2><h3 id="Git-工作流"><a href="#Git-工作流" class="headerlink" title="Git 工作流"></a>Git 工作流</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">feature</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">创建新的功能分支并进行适当设置</span></span><br><span class="line"><span class="attr">argument-hint:</span> [<span class="string">功能名称</span>]</span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="string">为</span> <span class="string">$ARGUMENTS</span> <span class="string">创建新的功能分支：</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span><span class="string">.</span> <span class="string">确保工作目录干净</span></span><br><span class="line"><span class="number">2</span><span class="string">.</span> <span class="string">从</span> <span class="string">main</span> <span class="string">拉取最新变更</span></span><br><span class="line"><span class="number">3</span><span class="string">.</span> <span class="string">创建分支：`feature/$ARGUMENTS`</span></span><br><span class="line"><span class="number">4</span><span class="string">.</span> <span class="string">设置分支跟踪</span></span><br><span class="line"><span class="number">5</span><span class="string">.</span> <span class="string">创建初始提交</span></span><br></pre></td></tr></table></figure>

<h3 id="测试工作流"><a href="#测试工作流" class="headerlink" title="测试工作流"></a>测试工作流</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">test-fix</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">修复失败的测试</span></span><br><span class="line"><span class="attr">context:</span> <span class="string">fork</span></span><br><span class="line"><span class="attr">allowed-tools:</span> <span class="string">Bash,</span> <span class="string">Read,</span> <span class="string">Edit</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="string">修复失败的测试：</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span><span class="string">.</span> <span class="string">运行测试套件识别失败</span></span><br><span class="line"><span class="number">2</span><span class="string">.</span> <span class="string">对每个失败：</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">阅读测试文件</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">理解测试内容</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">阅读实现代码</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">识别问题</span></span><br><span class="line">   <span class="bullet">-</span> <span class="string">修复代码或更新测试</span></span><br><span class="line"><span class="number">3</span><span class="string">.</span> <span class="string">重新运行测试验证</span></span><br><span class="line"><span class="number">4</span><span class="string">.</span> <span class="string">创建修复提交</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="参考资源"><a href="#参考资源" class="headerlink" title="参考资源"></a>参考资源</h2><ul>
<li><a target="_blank" rel="noopener" href="https://code.claude.com/docs/en/skills.md">官方 Skills 文档</a></li>
<li><a target="_blank" rel="noopener" href="https://agentskills.io/">Agent Skills 标准</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/anthropics/claude-code">Claude Code GitHub</a></li>
</ul>
<hr>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ul>
<li>Skills 评估顺序：项目级 → 个人级 → 企业级</li>
<li><code>/</code> 命令显示所有可用 skills 并支持自动补全</li>
<li>Skills 可以在指令中调用其他 skills</li>
<li>对于耗时操作使用 <code>context: fork</code> 保持主上下文清洁</li>
<li>Skills 支持 markdown 格式，包括表格、代码块和列表</li>
</ul>
</div><script src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.0/dist/js/lightgallery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-fullscreen.js@1.2.0/dist/lg-fullscreen.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.3.0/dist/lg-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-autoplay.js@1.2.0/dist/lg-autoplay.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-video.js@1.3.0/dist/lg-video.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-hash.js@1.0.0/dist/lg-hash.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-pager.js@1.0.0/dist/lg-pager.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script></div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2025/08/13/%5BOBS%5DAI-RAG-Graph/"><img class="fill" src="/gallery/AI.png" alt="RAG-Graph" referrerpolicy="no-referrer"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2025-08-13T13:41:44.000Z" title="8/13/2025, 9:41:44 PM">2025-08-13</time></span><span class="level-item">Updated&nbsp;<time dateTime="2026-02-14T16:35:53.763Z" title="2/15/2026, 12:35:53 AM">2026-02-15</time></span><span class="level-item"><a class="link-muted" href="/categories/Note/">Note</a></span><span class="level-item">13 minutes read (About 1964 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2025/08/13/%5BOBS%5DAI-RAG-Graph/">RAG-Graph</a></p><div class="content"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.0/dist/css/lightgallery.min.css" /><div class=".article-gallery"><p>在大型语言模型（LLM）驱动的问答和内容生成领域，检索增强生成（Retrieval-Augmented Generation, RAG）已成为一项基础技术。然而，传统的 RAG 依赖于向量相似度搜索，如同在图书馆中寻找内容相似的书籍，却常常忽略了书籍之间、作者之间以及知识点之间错综复杂的关系。为了突破这一局限，<strong>Graph RAG</strong> 应运而生，它通过引入“知识图谱”，为 RAG 系统装上了能够理解和导航数据关系的“智慧大脑”，实现了从“相关性检索”到“关联性推理”的重大飞跃。</p>
<h3 id="核心概念：从“文档块”到“知识网络”"><a href="#核心概念：从“文档块”到“知识网络”" class="headerlink" title="核心概念：从“文档块”到“知识网络”"></a>核心概念：从“文档块”到“知识网络”</h3><p><strong>标准 RAG</strong> 的工作流程通常是：</p>
<ol>
<li><p>将大量文档切分成独立的文本块（chunks）。</p>
</li>
<li><p>将这些文本块向量化后存入向量数据库。</p>
</li>
<li><p>当用户提问时，将问题向量化并在数据库中进行相似度搜索，找出最相关的几个文本块。</p>
</li>
<li><p>将这些文本块作为上下文（Context）连同问题一起提供给 LLM，生成最终答案。</p>
</li>
</ol>
<p>这种方法的缺陷在于，它处理的是孤立的信息片段。如果一个答案需要整合来自多个不同但相互关联的文档中的信息，标准 RAG 就可能力不从心。</p>
<p><strong>Graph RAG</strong> 则彻底改变了数据的组织和检索方式：</p>
<ol>
<li><p><strong>构建知识图谱：</strong> 它不再仅仅是切分文档，而是利用 LLM 从非结构化文本中提取出关键的<strong>实体（Entities）</strong>和它们之间的<strong>关系（Relationships）</strong>。例如，从“埃隆·马斯克是特斯拉的CEO，该公司总部位于美国”这句话中，可以提取出实体“埃隆·G马斯克”、“特斯拉”、“CEO”、“美国”，以及关系“（马斯克）-是-（CEO）-属于-（特斯拉）”和“（特斯拉）-总部位于-（美国）”。</p>
</li>
<li><p><strong>图谱化存储：</strong> 这些实体作为“节点（Nodes）”，关系作为“边（Edges）”，共同构建成一个庞大而精细的知识网络，并存储在专门的图数据库中。</p>
</li>
<li><p><strong>基于关系的检索：</strong> 当用户提问时，Graph RAG 不仅进行语义搜索，更重要的是在图谱上进行<strong>遍历和路径查找</strong>。它能识别问题中的核心实体，然后在图谱中探索这些实体的邻近节点和多层关系，从而收集到一个结构化、高度关联且富有深度的上下文。</p>
</li>
<li><p><strong>生成精准答案：</strong> 最后，将这个包含丰富实体和关系信息的子图（sub-graph）作为上下文提供给 LLM，使其能够基于清晰的逻辑链条进行推理，生成更精准、更具解释性的答案。</p>
</li>
</ol>
<p>简单来说，<strong>标准 RAG 问的是“哪些文档与我的问题最像？”，而 Graph RAG 问的是“与我问题相关的实体有哪些？它们之间存在什么样的联系？这些联系如何共同解答我的问题？”</strong></p>
<h3 id="用到的关键技术"><a href="#用到的关键技术" class="headerlink" title="用到的关键技术"></a>用到的关键技术</h3><p>Graph RAG 的实现依赖于一个强大的技术栈，它融合了自然语言处理、图技术和大型模型。</p>
<ol>
<li><p><strong>大型语言模型 (LLMs):</strong> 在 Graph RAG 中扮演双重角色。</p>
<ul>
<li><p><strong>知识提取器：</strong> 在构建图谱阶段，使用 LLM 强大的自然语言理解能力，从海量非结构化或半结构化文本中自动识别实体和关系，极大地降低了知识图谱的构建门槛。</p>
</li>
<li><p><strong>推理与生成器：</strong> 在查询阶段，LLM 负责理解从图谱中检索到的结构化上下文，并基于这些关系进行推理，最终生成流畅、准确的自然语言答案。</p>
</li>
</ul>
</li>
<li><p><strong>知识图谱 (Knowledge Graphs):</strong> 这是 Graph RAG 的核心。它以图的形式组织信息，完美地契合了真实世界中知识相互关联的特性，使得复杂的“多跳问题”（需要跨越多个信息点才能回答的问题）得以解决。</p>
</li>
<li><p><strong>图数据库 (Graph Databases):</strong> 专为存储和查询知识图谱而设计的数据库，如 <strong>Neo4j</strong>, <strong>NebulaGraph</strong>, <strong>Amazon Neptune</strong> 等。与传统关系型数据库相比，图数据库能以极高的效率执行关系遍历和路径查找操作，这对于实时响应 Graph RAG 的复杂查询至关重要。</p>
</li>
<li><p><strong>图算法与图机器学习:</strong></p>
<ul>
<li><p><strong>社区发现算法 (e.g., Leiden):</strong> 在构建图谱后，可以对节点进行聚类，形成不同的“社区”或“主题域”。这使得 Graph RAG 可以实现“全局搜索”，先定位到最相关的社区，再进行细粒度检索。</p>
</li>
<li><p><strong>图嵌入 (Graph Embeddings):</strong> 将图中的节点和关系也表示为向量，使得图结构信息可以和文本语义信息在同一个向量空间中进行融合与检索。</p>
</li>
</ul>
</li>
</ol>
<h3 id="主要应用领域"><a href="#主要应用领域" class="headerlink" title="主要应用领域"></a>主要应用领域</h3><p>Graph RAG 的优势在于处理需要深度推理、上下文理解和关系挖掘的复杂场景，因此在以下领域展现出巨大潜力：</p>
<ul>
<li><p><strong>金融风控与合规：</strong> 在反欺诈场景中，Graph RAG 可以轻松识别出看似无关的交易、账户和个人之间隐藏的关联，揭示复杂的欺诈网络。在合规审查中，它可以将法规条款、公司行为和交易数据连接起来，提供可追溯、可解释的合规判断。</p>
</li>
<li><p><strong>生物医学与药物研发：</strong> 生物医学领域充满了复杂的相互作用，如基因、蛋白质、疾病和药物之间的关系。Graph RAG 能够整合海量论文、临床试验数据和基因数据库，帮助研究人员发现新的药物靶点、预测药物副作用，或为特定患者提供个性化的治疗方案建议。</p>
</li>
<li><p><strong>供应链管理：</strong> 现代供应链是一个复杂的全球网络。Graph RAG 可以整合供应商、物流、库存、市场需求和地缘政治风险等数据，当出现“某国港口关闭”等事件时，能迅速分析出受影响的上下游企业和产品，并推荐替代方案。</p>
</li>
<li><p><strong>企业智能知识管理：</strong> 大型企业内部知识分散在不同部门的文档、报告和数据库中。Graph RAG 可以将这些知识整合成一个统一的、相互关联的企业知识图谱，让员工能以自然语言提问，获得跨部门、高精度的答案，例如“去年哪个产品的研发项目同时涉及了上海和硅谷的团队，并且项目负责人是谁？”</p>
</li>
<li><p><strong>个人化推荐系统：</strong> 通过构建用户、产品、偏好和行为之间的关系图谱，Graph RAG 能够提供超越“购买此商品的人也购买了…”的简单推荐，实现更深层次的、基于兴趣和逻辑关联的个性化内容或产品推荐。</p>
</li>
</ul>
</div><script src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.0/dist/js/lightgallery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-fullscreen.js@1.2.0/dist/lg-fullscreen.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.3.0/dist/lg-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-autoplay.js@1.2.0/dist/lg-autoplay.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-video.js@1.3.0/dist/lg-video.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-hash.js@1.0.0/dist/lg-hash.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-pager.js@1.0.0/dist/lg-pager.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script></div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2025/08/13/%5BOBS%5DAI-LangChain%20and%20LangGraph/"><img class="fill" src="/gallery/AI.png" alt="LangChain and LangGraph" referrerpolicy="no-referrer"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2025-08-13T13:39:40.000Z" title="8/13/2025, 9:39:40 PM">2025-08-13</time></span><span class="level-item">Updated&nbsp;<time dateTime="2026-02-14T16:35:53.749Z" title="2/15/2026, 12:35:53 AM">2026-02-15</time></span><span class="level-item"><a class="link-muted" href="/categories/Note/">Note</a></span><span class="level-item">23 minutes read (About 3493 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2025/08/13/%5BOBS%5DAI-LangChain%20and%20LangGraph/">LangChain and LangGraph</a></p><div class="content"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.0/dist/css/lightgallery.min.css" /><div class=".article-gallery"><p><a target="_blank" rel="noopener" href="https://www.ibm.com/think/topics/langchain">What is LangChain</a><br><a target="_blank" rel="noopener" href="https://www.ibm.com/think/topics/langgraph">What is LangGraph</a></p>
<hr>
<h2 id="LangChain-与-LangGraph：引领大型语言模型应用的双雄"><a href="#LangChain-与-LangGraph：引领大型语言模型应用的双雄" class="headerlink" title="LangChain 与 LangGraph：引领大型语言模型应用的双雄"></a>LangChain 与 LangGraph：引领大型语言模型应用的双雄</h2><p>在人工智能应用的浪潮中，大型语言模型（LLM）无疑是当前最耀眼的明星。然而，<strong>要将其强大的能力转化为实际、可靠且功能丰富的应用程序</strong>，开发者需要一套强而有力的<strong>框架</strong>。LangChain 和 LangGraph 正是为此而生的两大核心工具，它们极大地简化了 LLM 应用的开发流程，并为构建复杂的智能代理（Agent）提供了无限可能。</p>
<h3 id="LangChain：串联智慧的应用框架"><a href="#LangChain：串联智慧的应用框架" class="headerlink" title="LangChain：串联智慧的应用框架"></a>LangChain：串联智慧的应用框架</h3><p><strong>核心概念：</strong></p>
<p>LangChain 是一个开源的应用程序开发框架，其核心理念在于“链（Chain）”的概念。它旨在将大型语言模型与外部资源（如数据库、API、文件等）以及其他计算逻辑无缝地“链接”起来。通过模块化的组件，开发者可以轻松地构建、组合和扩展 LLM 应用，从而实现超越简单文本生成的功能。</p>
<p>LangChain 的主要构成部分包括：</p>
<ul>
<li><p><strong>模型（Models）：</strong> 整合了各类大型语言模型和嵌入模型的标准接口，开发者可以轻松切换和使用不同的模型。</p>
</li>
<li><p><strong>提示（Prompts）：</strong> 提供强大的提示模板管理功能，让开发者能够动态地生成和优化给予模型的指令。</p>
</li>
<li><p><strong>索引（Indexes）：</strong> 用于结构化和检索外部数据，是实现如“检索增强生成（Retrieval-Augmented Generation, RAG）”等应用的关键，让模型能够基于特定知识库回答问题。</p>
</li>
<li><p><strong>链（Chains）：</strong> 这是 LangChain 的核心，用于将多个组件（包括其他链）按顺序组合起来，形成一个完整的应用逻辑。</p>
</li>
<li><p><strong>代理（Agents）：</strong> 赋予 LLM 推理和行动的能力。代理程序可以使用一系列工具（Tools），并根据用户输入自主决定调用哪个工具来完成任务。</p>
</li>
<li><p><strong>记忆（Memory）：</strong> 让应用程序能够记住先前的对话内容，从而进行有上下文的、连贯的交流。</p>
</li>
</ul>
<p><strong>应用样例：</strong></p>
<p>LangChain 的应用极为广泛，几乎涵盖了所有需要利用 LLM 进行自然语言处理的场景：</p>
<ul>
<li><p><strong>智能问答机器人：</strong> 结合企业内部文件或特定领域的知识库，打造能够精准回答专业问题的问答系统。例如，一个能够读取公司所有技术文档，并回答工程师技术问题的聊天机器人。</p>
</li>
<li><p><strong>文件分析与摘要：</strong> 快速读取长篇报告、法律文件或学术论文，并生成简洁的摘要或提取关键信息。</p>
</li>
<li><p><strong>数据分析与洞察：</strong> 通过自然语言查询，与结构化（如 SQL 数据库）或非结构化数据进行互动，生成分析报告和可视化图表。</p>
</li>
<li><p><strong>自动化代码生成与解释：</strong> 根据需求描述自动生成代码片段，或对现有代码进行解释和除错。</p>
</li>
<li><p><strong>个性化内容推荐：</strong> 根据用户的历史行为和偏好，生成个性化的新闻摘要、产品推荐或旅行计划。</p>
</li>
</ul>
<h3 id="LangGraph：驾驭复杂性的图形化流程引擎"><a href="#LangGraph：驾驭复杂性的图形化流程引擎" class="headerlink" title="LangGraph：驾驭复杂性的图形化流程引擎"></a>LangGraph：驾驭复杂性的图形化流程引擎</h3><p><strong>核心概念：</strong></p>
<p>随着应用需求的日益复杂，单纯的线性“链”式结构有时会显得力不从心。特别是在需要<strong>处理循环、条件分支和多个智能代理协同工作的场景下</strong>，LangGraph 应运而生。</p>
<p>LangGraph 是 LangChain 生态系中的一个扩展，它将 LLM 应用的流程从线性的“链”提升到了更灵活、更强大的“图（Graph）”的层次。在 LangGraph 中，应用的执行流程被定义为一个有向图，其中：</p>
<ul>
<li><p><strong>节点（Nodes）：</strong> 代表工作流程中的一个步骤，可以是一个 LLM 的调用、一个工具的执行或一段自定义的 Python 代码。</p>
</li>
<li><p><strong>边（Edges）：</strong> 连接不同的节点，定义了信息在图中的流动方向。特别是“条件边（Conditional Edges）”，可以根据节点的输出结果，动态地决定下一步要跳转到哪个节点。</p>
</li>
<li><p><strong>状态（State）：</strong> 这是 LangGraph 的一个核心概念，它是一个在整个图形执行过程中持续存在的对象，用于存储和传递信息。每个节点都可以读取和更新这个共享的状态，从而实现了比线性链更复杂的记忆和上下文管理。</p>
</li>
</ul>
<p><strong>与 LangChain 的主要区别：</strong></p>
<table>
<thead>
<tr>
<th>特性</th>
<th>LangChain</th>
<th>LangGraph</th>
</tr>
</thead>
<tbody><tr>
<td><strong>核心结构</strong></td>
<td>线性、顺序执行的“链”</td>
<td>灵活、可循环的“图”</td>
</tr>
<tr>
<td><strong>适用场景</strong></td>
<td>简单到中等复杂度的顺序性任务</td>
<td>需要条件逻辑、循环和状态管理的复杂任务</td>
</tr>
<tr>
<td><strong>流程控制</strong></td>
<td>预先定义好的固定流程</td>
<td>动态、可根据执行结果改变的流程</td>
</tr>
<tr>
<td><strong>复杂性</strong></td>
<td>学习曲线相对平缓，易于上手</td>
<td>提供了更高的自由度和控制力，学习曲线稍陡</td>
</tr>
<tr>
<td><strong>错误处理</strong></td>
<td>需要在链的逻辑中自行定义重试机制</td>
<td>可以将错误处理设计为图中的一个独立节点</td>
</tr>
<tr>
<td><strong>代表应用</strong></td>
<td>问答系统、文件摘要、简单的工具调用</td>
<td>多代理协作、可自主修正的智能代理、人机协作流程</td>
</tr>
</tbody></table>
<p><strong>应用样例：</strong></p>
<p>LangGraph 特别擅长于构建需要更强控制力和灵活性的高级应用：</p>
<ul>
<li><p><strong>多代理协同工作（Multi-agent Collaboration）：</strong> 构建一个研究团队，其中一个代理负责上网搜索资料，另一个代理负责分析和整合资料，最后一个代理负责撰写报告。LangGraph 可以清晰地定义它们之间的协作流程、信息传递和审核机制。</p>
</li>
<li><p><strong>具有自我修正能力的代理：</strong> 当一个代理执行的工具出错或结果不理想时，可以通过条件边将流程导向一个“反思与修正”的节点，让代理重新评估策略并尝试新的方法，形成一个不断试错和优化的循环。</p>
</li>
<li><p><strong>人机协作（Human-in-the-loop）：</strong> 在关键决策点，可以设计一个节点来暂停流程，并请求人类用户的输入或批准。例如，在一个自动下单的代理中，最终下单前需要由人类确认订单细节。</p>
</li>
<li><p><strong>互动式故事生成：</strong> 根据用户的选择，故事的情节可以走向完全不同的分支，甚至可以回到之前的某个情节点，产生高度互动和非线性的叙事体验。</p>
</li>
</ul>
<h3 id="关键对比：何时用-LangChain，何时用-LangGraph？"><a href="#关键对比：何时用-LangChain，何时用-LangGraph？" class="headerlink" title="关键对比：何时用 LangChain，何时用 LangGraph？"></a>关键对比：何时用 LangChain，何时用 LangGraph？</h3><table>
<thead>
<tr>
<th>特性</th>
<th>LangChain (Chains)</th>
<th>LangGraph</th>
</tr>
</thead>
<tbody><tr>
<td><strong>结构</strong></td>
<td>**线性 (Linear)**：一步接一步，像流水线。</td>
<td>**图形化 (Graphical)**：支持分支、合并和循环，像流程图。</td>
</tr>
<tr>
<td><strong>控制流</strong></td>
<td><strong>预定义</strong>：流程在开始前就已固定。</td>
<td><strong>动态</strong>：流程可以根据节点的输出实时改变。</td>
</tr>
<tr>
<td><strong>核心场景</strong></td>
<td><strong>工具链&#x2F;RAG</strong>：快速构建顺序性任务，如文档问答、API 调用。</td>
<td>**智能代理 (Agents)**：构建需要决策、重试、多代理协作的复杂系统。</td>
</tr>
<tr>
<td><strong>状态管理</strong></td>
<td><strong>简单</strong>：通常只在链的内部传递，难以实现全局、持久的状态。</td>
<td><strong>核心特性</strong>：拥有一个明确的、贯穿始终的 State 对象，方便管理复杂上下文。</td>
</tr>
<tr>
<td><strong>举例</strong></td>
<td>“读取 PDF -&gt; 总结内容 -&gt; 发送邮件”</td>
<td>“搜索信息 -&gt; LLM 判断信息是否足够 -&gt; 如果不足，重新搜索 -&gt; 如果足够，撰写报告”</td>
</tr>
</tbody></table>
<h3 id="目前的发展与未来趋势"><a href="#目前的发展与未来趋势" class="headerlink" title="目前的发展与未来趋势"></a>目前的发展与未来趋势</h3><p>LangChain 和 LangGraph 正处于高速发展和迭代的阶段，整个生态系也日益成熟和完善。</p>
<p><strong>LangChain 的发展：</strong></p>
<ul>
<li><p><strong>架构模块化：</strong> LangChain 逐渐将其核心功能拆分为 <code>langchain-core</code> 和 <code>langchain-community</code> 等多个包。<code>langchain-core</code> 提供了稳定和核心的抽象接口，而 <code>langchain-community</code> 则包含了大量的第三方集成，这样的架构使得核心框架更加稳定，同时也方便社区贡献和维护。</p>
</li>
<li><p><strong>LangChain 表达式语言（LCEL）：</strong> 这是 LangChain 近期最重要的更新之一。LCEL 提供了一种声明式的方式来组合链，使得代码更为简洁、直观，并且原生支持批量处理、并行执行、流式输出等高级功能。</p>
</li>
<li><p><strong>LangSmith 的成熟：</strong> LangSmith 是一个用于监控、调试和评估 LLM 应用的平台。它提供了对应用执行过程的“X光”般的洞察力，让开发者可以清晰地看到每一步的输入、输出、延迟和令牌消耗，极大地提升了开发和维护效率。</p>
</li>
<li><p><strong>LangServe 的推出：</strong> 为了方便将开发好的链或代理部署为生产级的 API，LangChain 推出了 LangServe，让开发者可以一键将应用发布为 REST API。</p>
</li>
</ul>
<p><strong>LangGraph 的崛起与未来：</strong></p>
<p>LangGraph 被视为构建下一代复杂智能代理的关键框架。其发展重点在于：</p>
<ul>
<li><p><strong>成为代理架构的首选：</strong> 官方明确表示，LangGraph 将是未来构建代理架构（Agentic Architectures）的重点发展方向。</p>
</li>
<li><p><strong>增强可控性和可靠性：</strong> LangGraph 的图形化结构和状态管理机制，为设计能够处理复杂任务且行为可预测的代理提供了坚实的基础。</p>
</li>
<li><p><strong>人机协作的无缝整合：</strong> 其内置的状态持久化和流程控制能力，使得在代理的执行过程中无缝地加入人类的审核和指导成为可能。</p>
</li>
<li><p><strong>可视化与开发工具：</strong> 配合 LangGraph Studio 等可视化开发工具的推出，开发者可以更直观地设计、调试和迭代复杂的代理流程。</p>
</li>
</ul>
<h4 id="LangChain-RAG-代码示例"><a href="#LangChain-RAG-代码示例" class="headerlink" title="LangChain RAG 代码示例"></a>LangChain RAG 代码示例</h4><p>在实践中，使用 LangChain 来构建一个基于公司内部文档的问答机器人。整个流程非常清晰：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 伪代码和步骤解释 (面试时口述)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 0. 安装依赖</span></span><br><span class="line"><span class="comment"># pip install langchain langchain-openai langchain-community faiss-cpu</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 加载数据 (Load)</span></span><br><span class="line"><span class="comment"># 我会用 DocumentLoaders (比如 TextLoader 或 PyPDFLoader) 来加载内部文档。</span></span><br><span class="line"><span class="keyword">from</span> langchain_community.document_loaders <span class="keyword">import</span> TextLoader</span><br><span class="line">loader = TextLoader(<span class="string">&quot;internal_faq.txt&quot;</span>)</span><br><span class="line">documents = loader.load()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 分割文本 (Split)</span></span><br><span class="line"><span class="comment"># 为了便于检索，需要将长文档切分成小块。</span></span><br><span class="line"><span class="keyword">from</span> langchain.text_splitter <span class="keyword">import</span> RecursiveCharacterTextSplitter</span><br><span class="line">text_splitter = RecursiveCharacterTextSplitter(chunk_size=<span class="number">500</span>, chunk_overlap=<span class="number">0</span>)</span><br><span class="line">docs = text_splitter.split_documents(documents)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 向量化与存储 (Store)</span></span><br><span class="line"><span class="comment"># 我会使用 OpenAIEmbeddings 将文本块转换为向量，并存入 FAISS 这样的向量数据库中，以便快速搜索。</span></span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> OpenAIEmbeddings</span><br><span class="line"><span class="keyword">from</span> langchain_community.vectorstores <span class="keyword">import</span> FAISS</span><br><span class="line">embeddings = OpenAIEmbeddings()</span><br><span class="line">vectorstore = FAISS.from_documents(docs, embeddings)</span><br><span class="line">retriever = vectorstore.as_retriever()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 创建检索链 (Chain)</span></span><br><span class="line"><span class="comment"># 这是核心步骤。我使用 LangChain 表达式语言 (LCEL) 来构建一个链：</span></span><br><span class="line"><span class="comment"># 它接收问题，使用 retriever 找到相关文档，然后将问题和文档一起传给 LLM 生成答案。</span></span><br><span class="line"><span class="keyword">from</span> langchain_core.prompts <span class="keyword">import</span> ChatPromptTemplate</span><br><span class="line"><span class="keyword">from</span> langchain_core.runnables <span class="keyword">import</span> RunnablePassthrough</span><br><span class="line"><span class="keyword">from</span> langchain_core.output_parsers <span class="keyword">import</span> StrOutputParser</span><br><span class="line"><span class="keyword">from</span> langchain_openai <span class="keyword">import</span> ChatOpenAI</span><br><span class="line"></span><br><span class="line">template = <span class="string">&quot;&quot;&quot;Answer the question based only on the following context:</span></span><br><span class="line"><span class="string">&#123;context&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Question: &#123;question&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">prompt = ChatPromptTemplate.from_template(template)</span><br><span class="line">model = ChatOpenAI()</span><br><span class="line"></span><br><span class="line">retrieval_chain = (</span><br><span class="line">    &#123;<span class="string">&quot;context&quot;</span>: retriever, <span class="string">&quot;question&quot;</span>: RunnablePassthrough()&#125;</span><br><span class="line">    | prompt</span><br><span class="line">    | model</span><br><span class="line">    | StrOutputParser()</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. 调用链</span></span><br><span class="line"><span class="comment"># print(retrieval_chain.invoke(&quot;How to apply for a vacation?&quot;))</span></span><br></pre></td></tr></table></figure>

<p>“通过这套流程，我能快速搭建一个功能强大的 RAG 系统，整个逻辑是线性和确定的。”</p>
<h4 id="LangGraph-代理代码示例"><a href="#LangGraph-代理代码示例" class="headerlink" title="LangGraph 代理代码示例"></a>LangGraph 代理代码示例</h4><p>构建一个更智能的研究代理，它能上网搜索，如果结果不满意，还能决定再次搜索。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 伪代码和步骤解释 (面试时口述)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 0. 安装依赖</span></span><br><span class="line"><span class="comment"># pip install langgraph langchain-openai tavily-python</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 定义状态 (State)</span></span><br><span class="line"><span class="comment"># 首先，我定义一个图的共享状态，比如包含问题、搜索结果和最终答案。</span></span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> TypedDict, <span class="type">List</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AgentState</span>(<span class="title class_ inherited__">TypedDict</span>):</span><br><span class="line">    question: <span class="built_in">str</span></span><br><span class="line">    search_results: <span class="type">List</span>[<span class="built_in">str</span>]</span><br><span class="line">    final_answer: <span class="built_in">str</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 定义节点 (Nodes)</span></span><br><span class="line"><span class="comment"># 每个节点都是一个 Python 函数，接收 state，返回一个更新后的 state 的部分。</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">search_tool</span>(<span class="params">state</span>):</span><br><span class="line">    <span class="comment"># 调用搜索工具 (如 Tavily)</span></span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;search_results&quot;</span>: ...&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">llm_evaluator</span>(<span class="params">state</span>):</span><br><span class="line">    <span class="comment"># 调用 LLM 判断搜索结果是否足够回答问题</span></span><br><span class="line">    <span class="comment"># 如果足够，生成答案</span></span><br><span class="line">    <span class="comment"># 如果不够，返回一个需要重新搜索的信号</span></span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;final_answer&quot;</span>: ...&#125; <span class="comment"># 或者返回一个需要再次搜索的标志</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 定义条件边 (Edges)</span></span><br><span class="line"><span class="comment"># 这是 LangGraph 的精髓。我定义一个函数来决定流程走向。</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">should_i_search_again</span>(<span class="params">state</span>):</span><br><span class="line">    <span class="comment"># 检查 llm_evaluator 的输出</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;需要重新搜索&quot;</span> <span class="keyword">in</span> state:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;search_tool&quot;</span> <span class="comment"># 如果需要，就跳回搜索节点</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;__end__&quot;</span> <span class="comment"># 否则结束</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 构建图 (Build Graph)</span></span><br><span class="line"><span class="keyword">from</span> langgraph.graph <span class="keyword">import</span> StateGraph, END</span><br><span class="line">graph_builder = StateGraph(AgentState)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加节点</span></span><br><span class="line">graph_builder.add_node(<span class="string">&quot;search_tool&quot;</span>, search_tool)</span><br><span class="line">graph_builder.add_node(<span class="string">&quot;evaluator&quot;</span>, llm_evaluator)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置入口</span></span><br><span class="line">graph_builder.set_entry_point(<span class="string">&quot;search_tool&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加边</span></span><br><span class="line">graph_builder.add_edge(<span class="string">&quot;search_tool&quot;</span>, <span class="string">&quot;evaluator&quot;</span>)</span><br><span class="line"><span class="comment"># 添加条件边</span></span><br><span class="line">graph_builder.add_conditional_edges(</span><br><span class="line">    <span class="string">&quot;evaluator&quot;</span>,</span><br><span class="line">    should_i_search_again,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">&quot;search_tool&quot;</span>: <span class="string">&quot;search_tool&quot;</span>,</span><br><span class="line">        <span class="string">&quot;__end__&quot;</span>: END</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. 编译和运行</span></span><br><span class="line"><span class="comment"># app = graph_builder.compile()</span></span><br><span class="line"><span class="comment"># app.invoke(&#123;&quot;question&quot;: &quot;What is the future of AI?&quot;&#125;)</span></span><br></pre></td></tr></table></figure>



</div><script src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.0/dist/js/lightgallery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-fullscreen.js@1.2.0/dist/lg-fullscreen.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.3.0/dist/lg-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-autoplay.js@1.2.0/dist/lg-autoplay.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-video.js@1.3.0/dist/lg-video.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-hash.js@1.0.0/dist/lg-hash.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-pager.js@1.0.0/dist/lg-pager.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script></div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2025/04/01/%5BOBS%5DAI-%E8%87%AA%E7%84%B6%E8%BE%A9%E8%AF%81%E6%B3%95%E5%88%86%E4%BA%AB%E4%B9%8BAI%E4%B8%AD%E7%9A%84%E6%B6%8C%E7%8E%B0/"><img class="fill" src="/gallery/AI.png" alt="自然辩证法分享之AI中的涌现" referrerpolicy="no-referrer"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2025-04-01T15:44:28.000Z" title="4/1/2025, 11:44:28 PM">2025-04-01</time></span><span class="level-item">Updated&nbsp;<time dateTime="2026-02-14T16:35:53.751Z" title="2/15/2026, 12:35:53 AM">2026-02-15</time></span><span class="level-item"><a class="link-muted" href="/categories/Note/">Note</a></span><span class="level-item">9 minutes read (About 1383 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2025/04/01/%5BOBS%5DAI-%E8%87%AA%E7%84%B6%E8%BE%A9%E8%AF%81%E6%B3%95%E5%88%86%E4%BA%AB%E4%B9%8BAI%E4%B8%AD%E7%9A%84%E6%B6%8C%E7%8E%B0/">自然辩证法分享之AI中的涌现</a></p><div class="content"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.0/dist/css/lightgallery.min.css" /><div class=".article-gallery"><h2 id="涌现的定义"><a href="#涌现的定义" class="headerlink" title="涌现的定义"></a>涌现的定义</h2><h3 id="西哲中的涌现"><a href="#西哲中的涌现" class="headerlink" title="西哲中的涌现"></a>西哲中的涌现</h3><p>“涌现”（Emergence）最早起源于哲学领域。19世纪，英国哲学家乔治·亨利·刘易斯次用这个词来描述那些无法通过组成部分的性质解释的整体特性，即“整体大于部分之和”的现象。</p>
<blockquote>
<p>将一切都归结为简单基本规律的能力并不意味着有能力从这些规律出发，重建宇宙。在面对规模和复杂度的双重困难时，还原主义假说便崩溃了。在每个复杂度层次上，都会出现全新的性质。心理学不是应用生物学，生物学也不是应用化学。我们现在可以看到，整体不仅变得更多，而且与部分的总和也非常不同。</p>
</blockquote>
<h3 id="复杂系统（计算机）中的涌现"><a href="#复杂系统（计算机）中的涌现" class="headerlink" title="复杂系统（计算机）中的涌现"></a>复杂系统（计算机）中的涌现</h3><p>系统科学家穆雷·盖尔曼和斯图尔特·考夫曼通过对复杂系统中自组织行为的研究，进一步发展了“涌现”的概念。他们认为，“涌现”指的是在复杂系统内，简单组件通过相互作用自然产生的某些特性或现象。这意味着，整体所展现的特征或行为不能简单地从其组成部分的性质中推导出来，而是在这些部分的相互作用中自发产生的。涌现现象侧重于解释复杂系统如何在没有外部指令或中央控制的情况下，通过系统内部的简单规则和相互作用，形成新的有序结构和行为。这表明，复杂性可以自然地产生，而不需要外部干预或预先的详细设计。</p>
<p>在这一方面最具代表性的就是生命游戏：<br>在生命游戏中：</p>
<ul>
<li>规则极其简单（细胞的生死规则）。</li>
<li>初始状态可能看似随机。</li>
<li>但随着演化，整个系统会涌现出复杂的模式，如振荡器、滑翔机等。<br>![[game-of-life-loop-cropped.gif]]</li>
</ul>
<h2 id="AI中的涌现"><a href="#AI中的涌现" class="headerlink" title="AI中的涌现"></a>AI中的涌现</h2><p>关于文本自回归模型chatgpt参数提升带来的<strong>语言理解、推理、编程、创意生成等新能力</strong>的涌现我这里就不过多赘述了，我主要侧重分享一下在自监督视觉领域的涌现现象。</p>
<div class="post-content"><a href="/2025/04/01/[OBS]AI-自然辩证法分享之AI中的涌现/Pasted_image_20250402115603.png" title="" title=" class="gallery-item"><img src="/2025/04/01/[OBS]AI-自然辩证法分享之AI中的涌现/Pasted_image_20250402115603.png" alt="" title=""></a></div>

<p><strong>DINO</strong>（Self-Distillation with No Labels）是一种自监督学习方法，用于无标签学习视觉特征。它基于知识蒸馏（Distillation）和对比学习的思想，使用两组权重共享的网络（教师网络和学生网络）进行训练。</p>
<div class="post-content"><a href="/2025/04/01/[OBS]AI-自然辩证法分享之AI中的涌现/Pasted_image_20250401171026.png" title="" title=" class="gallery-item"><img src="/2025/04/01/[OBS]AI-自然辩证法分享之AI中的涌现/Pasted_image_20250401171026.png" alt="" title=""></a></div>
这个模型的思想是使用学生模型来预测教师模型生成的label，而教师模型的权重则使用学生模型的权重更新。其中学生们模型输入的图像是原始照片中的局部小区域的裁剪，而教师模型的输入是更大更全局的裁剪。
这种自监督的方式将数据集从原先有标注的数据集的百万规模扩展到了无标注网络图片的数亿规模。
在经过训练之后，这个模型能够实现那些起初并没有详细地针对性设计的功能
- 可以在没有做任何微调或者添加映射层的基础上在nearest neighbors classifier (k-NN)达到top-1准确率。
- 其次，在模型的最后一层self-attention layer上可以观察到显著的语义分割信息
    <div class="post-content"><a href="/2025/04/01/[OBS]AI-自然辩证法分享之AI中的涌现/Pasted_image_20250401194020.png" title="" title=" class="gallery-item"><img src="/2025/04/01/[OBS]AI-自然辩证法分享之AI中的涌现/Pasted_image_20250401194020.png" alt="" title=""></a></div>
    <div class="post-content"><a href="/2025/04/01/[OBS]AI-自然辩证法分享之AI中的涌现/Pasted_image_20250401194034.png" title="" title=" class="gallery-item"><img src="/2025/04/01/[OBS]AI-自然辩证法分享之AI中的涌现/Pasted_image_20250401194034.png" alt="" title=""></a></div>
## 体现的自然辩证法规律“量变产生质变”
在 DINO 这一自监督学习方法中，**“量变产生质变”**的自然辩证法规律得到了显著体现。该原理指出，**事物的质变并非突发的，而是由量变的积累达到临界点后发生的飞跃**。在 DINO 中，这一过程主要体现在以下几个方面：
- **训练数据规模的扩展促成能力涌现**
    - 传统的有监督学习依赖人工标注的数据集，规模通常在百万级别，而 DINO 通过自监督学习，使训练数据扩展到了无标注的海量网络图片，规模达到数亿。
    - 这一量的积累，使模型在没有人工监督的情况下，也能自发学会区分物体类别，最终形成具有良好泛化能力的特征表示。
- 特征学习的逐步优化推动了语义信息涌现
    - 训练初期，DINO 学到的特征较为混乱，仅能捕捉低级视觉模式，如边缘和颜色分布。
    - 随着训练的持续，网络的特征表达能力逐步提升，最终在 self-attention 层中涌现出**显式的语义分割能力**，尽管分割能力并非最初的训练目标。
    - 教师-学生架构中不断积累的信息对齐，并通过自蒸馏的方式不断优化自身，局部的优化（量变）最终促成了全局的能力提升（质变）。</div><script src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.0/dist/js/lightgallery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-fullscreen.js@1.2.0/dist/lg-fullscreen.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.3.0/dist/lg-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-autoplay.js@1.2.0/dist/lg-autoplay.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-video.js@1.3.0/dist/lg-video.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-hash.js@1.0.0/dist/lg-hash.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-pager.js@1.0.0/dist/lg-pager.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script></div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2024/10/08/%5BOBS%5Dhexo-Hexo%20AI%20Assistant/"><img class="fill" src="/gallery/Hexo.png" alt="Hexo AI Assistant" referrerpolicy="no-referrer"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2024-10-08T13:44:56.000Z" title="10/8/2024, 9:44:56 PM">2024-10-08</time></span><span class="level-item">Updated&nbsp;<time dateTime="2026-02-14T16:35:53.768Z" title="2/15/2026, 12:35:53 AM">2026-02-15</time></span><span class="level-item"><a class="link-muted" href="/categories/Note/">Note</a></span><span class="level-item">6 minutes read (About 967 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/10/08/%5BOBS%5Dhexo-Hexo%20AI%20Assistant/">Hexo AI Assistant</a></p><div class="content"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.0/dist/css/lightgallery.min.css" /><div class=".article-gallery"><p>参见 <a target="_blank" rel="noopener" href="https://dingfen.github.io/2024/07/21/2024-7-21-ai_assist/">https://dingfen.github.io/2024/07/21/2024-7-21-ai_assist/</a></p>
<p>阿里云的大模型之前在搞wechat bot的时候接触过，这次再加上一个云函数的服务，就搞定了。<br>LLM:<a target="_blank" rel="noopener" href="https://bailian.console.aliyun.com/?spm=a2c4g.11186623.0.0.2db33048PGTSE6#/app-center">https://bailian.console.aliyun.com/?spm=a2c4g.11186623.0.0.2db33048PGTSE6#/app-center</a><br>云函数:<a target="_blank" rel="noopener" href="https://fcnext.console.aliyun.com/applications?spm=5176.fcnext.0.0.65f378c8HmZpOP">https://fcnext.console.aliyun.com/applications?spm=5176.fcnext.0.0.65f378c8HmZpOP</a></p>
<p>在本地主要需要做的是在hexo中注入代码<br>添加文件<code>scripts/injector.js</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">hexo.extend.injector.register(&#x27;body_end&#x27;,`</span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">crossorigin</span> <span class="attr">href</span>=<span class="string">&quot;https://g.alicdn.com/aliyun-documentation/web-chatbot-ui/0.0.11/index.css&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;module&quot;</span> <span class="attr">crossorigin</span> <span class="attr">src</span>=<span class="string">&quot;https://g.alicdn.com/aliyun-documentation/web-chatbot-ui/0.0.11/index.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">window</span>.<span class="property">CHATBOT_CONFIG</span> = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">endpoint</span>: <span class="string">&quot;/chat&quot;</span>, <span class="comment">// 可以替换为 https://&#123;your-fc-http-trigger-domain&#125;/chat</span></span></span><br><span class="line"><span class="language-javascript">    <span class="attr">displayByDefault</span>: <span class="literal">false</span>, <span class="comment">// 默认不展示 AI 助手聊天框</span></span></span><br><span class="line"><span class="language-javascript">    <span class="attr">aiChatOptions</span>: &#123; <span class="comment">// aiChatOptions 中 options 会传递 aiChat 组件，自定义取值参考：https://docs.nlkit.com/nlux/reference/ui/ai-chat</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">conversationOptions</span>: &#123; <span class="comment">// 自定义取值参考：https://docs.nlkit.com/nlux/reference/ui/ai-chat#conversation-options</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">conversationStarters</span>: [</span></span><br><span class="line"><span class="language-javascript">          &#123;<span class="attr">prompt</span>: <span class="string">&#x27;哪款手机续航最长？&#x27;</span>&#125;,</span></span><br><span class="line"><span class="language-javascript">          &#123;<span class="attr">prompt</span>: <span class="string">&#x27;你们有哪些手机型号？&#x27;</span>&#125;,</span></span><br><span class="line"><span class="language-javascript">          &#123;<span class="attr">prompt</span>: <span class="string">&#x27;有折叠屏手机吗?&#x27;</span>&#125;,</span></span><br><span class="line"><span class="language-javascript">        ]</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">displayOptions</span>: &#123; <span class="comment">// 自定义取值参考：https://docs.nlkit.com/nlux/reference/ui/ai-chat#display-options</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">height</span>: <span class="number">600</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">personaOptions</span>: &#123; <span class="comment">// 自定义取值参考：https://docs.nlkit.com/nlux/reference/ui/ai-chat#chat-personas</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">assistant</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">name</span>: <span class="string">&#x27;你好，我是你的 AI 助手&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// AI 助手的图标</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">avatar</span>: <span class="string">&#x27;https://img.alicdn.com/imgextra/i2/O1CN01Pda9nq1YDV0mnZ31H_!!6000000003025-54-tps-120-120.apng&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">tagline</span>: <span class="string">&#x27;您可以尝试点击下方的快捷入口开启体验！&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-pseudo">:root</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="comment">/* webchat 工具栏的颜色 */</span></span></span><br><span class="line"><span class="language-css">    <span class="attr">--webchat-toolbar-background-color</span>: <span class="number">#1464E4</span>;</span></span><br><span class="line"><span class="language-css">    <span class="comment">/* webchat 工具栏文字和按钮的颜色 */</span></span></span><br><span class="line"><span class="language-css">    <span class="attr">--webchat-toolbar-text-color</span>: <span class="number">#FFF</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="comment">/* webchat 对话框如果被遮挡，可以尝试通过 z-index、bottom、right 等设置来调整位置 */</span></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.webchat-container</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">z-index</span>: <span class="number">100</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">bottom</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">right</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="comment">/* webchat 的唤起按钮如果被遮挡，可以尝试通过 z-index、bottom、right 等设置来调整位置 */</span></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.webchat-bubble-tip</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">z-index</span>: <span class="number">99</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">bottom</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">right</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span>`</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>主要要更改的是<code>window.CHATBOT_CONFIG.endpoint</code>, 改为触发器的公网访问地址</p>
<div class="post-content"><a href="/2024/10/08/[OBS]hexo-Hexo AI Assistant/Pasted_image_20241008193641.png" title="" title=" class="gallery-item"><img src="/2024/10/08/[OBS]hexo-Hexo AI Assistant/Pasted_image_20241008193641.png" alt="" title=""></a></div>
然后更改avatar，添加浮动的对话泡图标balabala
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">hexo.extend.injector.register(&#x27;body_end&#x27;,`</span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">crossorigin</span> <span class="attr">href</span>=<span class="string">&quot;https://g.alicdn.com/aliyun-documentation/web-chatbot-ui/0.0.11/index.css&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;module&quot;</span> <span class="attr">crossorigin</span> <span class="attr">src</span>=<span class="string">&quot;https://g.alicdn.com/aliyun-documentation/web-chatbot-ui/0.0.11/index.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">window</span>.<span class="property">CHATBOT_CONFIG</span> = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">endpoint</span>: <span class="string">&quot;https://webchat-bot-iqu-knzhgrvznd.cn-hangzhou.fcapp.run/chat&quot;</span>, <span class="comment">// 可以替换为 https://&#123;your-fc-http-trigger-domain&#125;/chat</span></span></span><br><span class="line"><span class="language-javascript">    <span class="attr">displayByDefault</span>: <span class="literal">false</span>, <span class="comment">// 默认不展示 AI 助手聊天框</span></span></span><br><span class="line"><span class="language-javascript">    <span class="attr">aiChatOptions</span>: &#123; <span class="comment">// aiChatOptions 中 options 会传递 aiChat 组件，自定义取值参考：https://docs.nlkit.com/nlux/reference/ui/ai-chat</span></span></span><br><span class="line"><span class="language-javascript">      <span class="attr">conversationOptions</span>: &#123; <span class="comment">// 自定义取值参考：https://docs.nlkit.com/nlux/reference/ui/ai-chat#conversation-options</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">conversationStarters</span>: [</span></span><br><span class="line"><span class="language-javascript">          &#123;<span class="attr">prompt</span>: <span class="string">&#x27;你是谁？&#x27;</span>&#125;,</span></span><br><span class="line"><span class="language-javascript">          &#123;<span class="attr">prompt</span>: <span class="string">&#x27;博主又是谁？&#x27;</span>&#125;,</span></span><br><span class="line"><span class="language-javascript">          &#123;<span class="attr">prompt</span>: <span class="string">&#x27;博主喜欢的人是？&#x27;</span>&#125;,</span></span><br><span class="line"><span class="language-javascript">          &#123;<span class="attr">prompt</span>: <span class="string">&#x27;想要博主联系方式！&#x27;</span>&#125;,</span></span><br><span class="line"><span class="language-javascript">        ]</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">displayOptions</span>: &#123; <span class="comment">// 自定义取值参考：https://docs.nlkit.com/nlux/reference/ui/ai-chat#display-options</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">height</span>: <span class="number">600</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">personaOptions</span>: &#123; <span class="comment">// 自定义取值参考：https://docs.nlkit.com/nlux/reference/ui/ai-chat#chat-personas</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">assistant</span>: &#123;          <span class="attr">name</span>: <span class="string">&#x27;博主的AI助手，十四行诗参上！&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// AI 助手的图标</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">avatar</span>: <span class="string">&#x27;https://chen-yulin.github.io/thumb/14.png&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">tagline</span>: <span class="string">&#x27;要不要试试问下面的问题呢？&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-pseudo">:root</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="comment">/* webchat 工具栏的颜色 */</span></span></span><br><span class="line"><span class="language-css">    <span class="attr">--webchat-toolbar-background-color</span>: <span class="number">#1464E4</span>;</span></span><br><span class="line"><span class="language-css">    <span class="comment">/* webchat 工具栏文字和按钮的颜色 */</span></span></span><br><span class="line"><span class="language-css">    <span class="attr">--webchat-toolbar-text-color</span>: <span class="number">#FFF</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="comment">/* webchat 对话框如果被遮挡，可以尝试通过 z-index、bottom、left 等设置来调整位置 */</span></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.webchat-container</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">z-index</span>: <span class="number">100</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">bottom</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">right</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="comment">/* webchat 的唤起按钮如果被遮挡，可以尝试通过 z-index、bottom、left 等设置来调整位置 */</span></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.webchat-bubble-tip</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">z-index</span>: <span class="number">99</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">bottom</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">right</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.webchat-bubble-tip</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">overflow</span>: visible <span class="meta">!important</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="keyword">@keyframes</span> float &#123;</span></span><br><span class="line"><span class="language-css">    <span class="number">0%</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">0px</span>) <span class="built_in">translateX</span>(-<span class="number">50%</span>);</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="number">50%</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">10px</span>) <span class="built_in">translateX</span>(-<span class="number">50%</span>);</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="number">100%</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">0px</span>) <span class="built_in">translateX</span>(-<span class="number">50%</span>);</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.webchat-bubble-tip</span><span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">top</span>: -<span class="number">25px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">left</span>: <span class="number">70%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">40px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">40px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&quot;data:image/svg+xml,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 24 24&#x27; fill=&#x27;white&#x27;%3E%3Cpath d=&#x27;M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z&#x27;/%3E%3C/svg%3E&quot;</span>);</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-repeat</span>: no-repeat;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-position</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-size</span>: contain;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">filter</span>: <span class="built_in">drop-shadow</span>(<span class="number">0</span> <span class="number">4px</span> <span class="number">6px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.5</span>));</span></span><br><span class="line"><span class="language-css">    <span class="attribute">animation</span>: float <span class="number">3s</span> ease-in-out infinite;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>最终效果：</p>
<div class="post-content"><a href="/2024/10/08/[OBS]hexo-Hexo AI Assistant/Pasted_image_20241008193811.png" title="" title=" class="gallery-item"><img src="/2024/10/08/[OBS]hexo-Hexo AI Assistant/Pasted_image_20241008193811.png" alt="" title=""></a></div>
<div class="post-content"><a href="/2024/10/08/[OBS]hexo-Hexo AI Assistant/Pasted_image_20241008193823.png" title="" title=" class="gallery-item"><img src="/2024/10/08/[OBS]hexo-Hexo AI Assistant/Pasted_image_20241008193823.png" alt="" title=""></a></div>
<div class="post-content"><a href="/2024/10/08/[OBS]hexo-Hexo AI Assistant/Pasted_image_20241008194013.png" title="" title=" class="gallery-item"><img src="/2024/10/08/[OBS]hexo-Hexo AI Assistant/Pasted_image_20241008194013.png" alt="" title=""></a></div>

<p>将网站文件同步到数据库：<a target="_blank" rel="noopener" href="https://bailian.console.aliyun.com/?spm=a2c4g.11186623.0.0.2db33048PGTSE6&accounttraceid=8eb35596f08b4ee8886d83e9c3342721fzps#/data-center">阿里云数据管理</a><br>并且在<a target="_blank" rel="noopener" href="https://bailian.console.aliyun.com/?spm=a2c4g.11186623.0.0.2db33048PGTSE6&accounttraceid=8eb35596f08b4ee8886d83e9c3342721fzps#/knowledge-base">知识索引</a>中进行添加</p>
</div><script src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.0/dist/js/lightgallery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-fullscreen.js@1.2.0/dist/lg-fullscreen.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.3.0/dist/lg-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-autoplay.js@1.2.0/dist/lg-autoplay.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-video.js@1.3.0/dist/lg-video.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-hash.js@1.0.0/dist/lg-hash.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-pager.js@1.0.0/dist/lg-pager.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script></div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2024/10/07/%5BOBS%5Dnvim-Neovim%20Cursor%20(avante.nvim)/"><img class="fill" src="/gallery/Nvim.png" alt="Neovim Cursor (avante.nvim)" referrerpolicy="no-referrer"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2024-10-07T14:03:02.000Z" title="10/7/2024, 10:03:02 PM">2024-10-07</time></span><span class="level-item">Updated&nbsp;<time dateTime="2026-02-14T16:35:53.617Z" title="2/15/2026, 12:35:53 AM">2026-02-15</time></span><span class="level-item"><a class="link-muted" href="/categories/Note/">Note</a></span><span class="level-item">11 minutes read (About 1651 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/10/07/%5BOBS%5Dnvim-Neovim%20Cursor%20(avante.nvim)/">Neovim Cursor (avante.nvim)</a></p><div class="content"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.0/dist/css/lightgallery.min.css" /><div class=".article-gallery"><p>n仓库地址: <a target="_blank" rel="noopener" href="https://github.com/yetone/avante.nvim">https://github.com/yetone/avante.nvim</a></p>
<h2 id="Accounts"><a href="#Accounts" class="headerlink" title="Accounts"></a>Accounts</h2><p>虚拟手机号: <a target="_blank" rel="noopener" href="https://sms-activate.io/en">https://sms-activate.io/en</a><br>（学校邮箱，密码需要大写）</p>
<p>注册Claude-chat<br>授权Claude-api(<a target="_blank" rel="noopener" href="https://console.anthropic.com/">https://console.anthropic.com/</a>)</p>
<h2 id="Apply-Claude-API"><a href="#Apply-Claude-API" class="headerlink" title="Apply Claude API"></a>Apply Claude API</h2><div class="post-content"><a href="/2024/10/07/[OBS]nvim-Neovim Cursor (avante.nvim)/Pasted_image_20241007142632.png" title="" title=" class="gallery-item"><img src="/2024/10/07/[OBS]nvim-Neovim Cursor (avante.nvim)/Pasted_image_20241007142632.png" alt="" title=""></a></div>

<h2 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h2><p>我使用lazy.nvim插件管理器所以非常方便，只需要在<code>lazy_setup.lua</code>里加上</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;yetone/avante.nvim&quot;</span>,</span><br><span class="line">  event = <span class="string">&quot;VeryLazy&quot;</span>,</span><br><span class="line">  lazy = <span class="literal">false</span>,</span><br><span class="line">  version = <span class="literal">false</span>, <span class="comment">-- set this if you want to always pull the latest change</span></span><br><span class="line">  opts = &#123;</span><br><span class="line">    <span class="comment">-- add any opts here</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">-- if you want to build from source then do `make BUILD_FROM_SOURCE=true`</span></span><br><span class="line">  build = <span class="string">&quot;make&quot;</span>,</span><br><span class="line">  <span class="comment">-- build = &quot;powershell -ExecutionPolicy Bypass -File Build.ps1 -BuildFromSource false&quot; -- for windows</span></span><br><span class="line">  dependencies = &#123;</span><br><span class="line">    <span class="string">&quot;nvim-treesitter/nvim-treesitter&quot;</span>,</span><br><span class="line">    <span class="string">&quot;stevearc/dressing.nvim&quot;</span>,</span><br><span class="line">    <span class="string">&quot;nvim-lua/plenary.nvim&quot;</span>,</span><br><span class="line">    <span class="string">&quot;MunifTanjim/nui.nvim&quot;</span>,</span><br><span class="line">    <span class="comment">--- The below dependencies are optional,</span></span><br><span class="line">    <span class="string">&quot;nvim-tree/nvim-web-devicons&quot;</span>, <span class="comment">-- or echasnovski/mini.icons</span></span><br><span class="line">    <span class="string">&quot;zbirenbaum/copilot.lua&quot;</span>, <span class="comment">-- for providers=&#x27;copilot&#x27;</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">-- support for image pasting</span></span><br><span class="line">      <span class="string">&quot;HakonHarnes/img-clip.nvim&quot;</span>,</span><br><span class="line">      event = <span class="string">&quot;VeryLazy&quot;</span>,</span><br><span class="line">      opts = &#123;</span><br><span class="line">        <span class="comment">-- recommended settings</span></span><br><span class="line">        default = &#123;</span><br><span class="line">          embed_image_as_base64 = <span class="literal">false</span>,</span><br><span class="line">          prompt_for_file_name = <span class="literal">false</span>,</span><br><span class="line">          drag_and_drop = &#123;</span><br><span class="line">            insert_mode = <span class="literal">true</span>,</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="comment">-- required for Windows users</span></span><br><span class="line">          use_absolute_path = <span class="literal">true</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="comment">-- Make sure to set this up properly if you have lazy=true</span></span><br><span class="line">      <span class="string">&#x27;MeanderingProgrammer/render-markdown.nvim&#x27;</span>,</span><br><span class="line">      opts = &#123;</span><br><span class="line">        file_types = &#123; <span class="string">&quot;markdown&quot;</span>, <span class="string">&quot;Avante&quot;</span> &#125;,</span><br><span class="line">      &#125;,</span><br><span class="line">      ft = &#123; <span class="string">&quot;markdown&quot;</span>, <span class="string">&quot;Avante&quot;</span> &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>lazy安装完毕之后会有报错：<br><a target="_blank" rel="noopener" href="https://github.com/yetone/avante.nvim/issues/612">https://github.com/yetone/avante.nvim/issues/612</a><br>解决方案为</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/.local/share/nvim/lazy/avante.nvim</span><br><span class="line">make BUILD_FROM_SOURCE=<span class="literal">true</span>  </span><br></pre></td></tr></table></figure>
<div class="post-content"><a href="/2024/10/07/[OBS]nvim-Neovim Cursor (avante.nvim)/Pasted_image_20241007150254.png" title="" title=" class="gallery-item"><img src="/2024/10/07/[OBS]nvim-Neovim Cursor (avante.nvim)/Pasted_image_20241007150254.png" alt="" title=""></a></div>

<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>添加<code>~/.config/nvim/lua/avante.lua</code></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">---<span class="doctag">NOTE:</span> user will be merged with defaults and</span></span><br><span class="line"><span class="comment">---we add a default var_accessor for this table to config values.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">local</span> Utils = <span class="built_in">require</span>(<span class="string">&quot;avante.utils&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">---@class avante.CoreConfig: avante.Config</span></span><br><span class="line"><span class="keyword">local</span> M = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">---@class avante.Config</span></span><br><span class="line">M.defaults = &#123;</span><br><span class="line">	<span class="built_in">debug</span> = <span class="literal">false</span>,</span><br><span class="line">	<span class="comment">---@alias Provider &quot;claude&quot; | &quot;openai&quot; | &quot;azure&quot; | &quot;gemini&quot; | &quot;cohere&quot; | &quot;copilot&quot; | [string]</span></span><br><span class="line">	provider = <span class="string">&quot;claude&quot;</span>, <span class="comment">-- Only recommend using Claude</span></span><br><span class="line">	auto_suggestions_provider = <span class="string">&quot;claude&quot;</span>,</span><br><span class="line">	<span class="comment">---@alias Tokenizer &quot;tiktoken&quot; | &quot;hf&quot;</span></span><br><span class="line">	<span class="comment">-- Used for counting tokens and encoding text.</span></span><br><span class="line">	<span class="comment">-- By default, we will use tiktoken.</span></span><br><span class="line">	<span class="comment">-- For most providers that we support we will determine this automatically.</span></span><br><span class="line">	<span class="comment">-- If you wish to use a given implementation, then you can override it here.</span></span><br><span class="line">	tokenizer = <span class="string">&quot;tiktoken&quot;</span>,</span><br><span class="line">	<span class="comment">---@alias AvanteSystemPrompt string</span></span><br><span class="line">	<span class="comment">-- Default system prompt. Users can override this with their own prompt</span></span><br><span class="line">	<span class="comment">-- You can use `require(&#x27;avante.config&#x27;).override(&#123;system_prompt = &quot;MY_SYSTEM_PROMPT&quot;&#125;) conditionally</span></span><br><span class="line">	<span class="comment">-- in your own autocmds to do it per directory, or that fit your needs.</span></span><br><span class="line">	system_prompt = <span class="string">[[</span></span><br><span class="line"><span class="string">Act as an expert software developer.</span></span><br><span class="line"><span class="string">Always use best practices when coding.</span></span><br><span class="line"><span class="string">Respect and use existing conventions, libraries, etc that are already present in the code base.</span></span><br><span class="line"><span class="string">]]</span>,</span><br><span class="line">	<span class="comment">---@type AvanteSupportedProvider</span></span><br><span class="line">	openai = &#123;</span><br><span class="line">		endpoint = <span class="string">&quot;https://api.openai.com/v1&quot;</span>,</span><br><span class="line">		model = <span class="string">&quot;gpt-4o&quot;</span>,</span><br><span class="line">		timeout = <span class="number">30000</span>, <span class="comment">-- Timeout in milliseconds</span></span><br><span class="line">		temperature = <span class="number">0</span>,</span><br><span class="line">		max_tokens = <span class="number">4096</span>,</span><br><span class="line">		[<span class="string">&quot;local&quot;</span>] = <span class="literal">false</span>,</span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="comment">---@type AvanteSupportedProvider</span></span><br><span class="line">	copilot = &#123;</span><br><span class="line">		endpoint = <span class="string">&quot;https://api.githubcopilot.com&quot;</span>,</span><br><span class="line">		model = <span class="string">&quot;gpt-4o-2024-05-13&quot;</span>,</span><br><span class="line">		proxy = <span class="literal">nil</span>, <span class="comment">-- [protocol://]host[:port] Use this proxy</span></span><br><span class="line">		allow_insecure = <span class="literal">false</span>, <span class="comment">-- Allow insecure server connections</span></span><br><span class="line">		timeout = <span class="number">30000</span>, <span class="comment">-- Timeout in milliseconds</span></span><br><span class="line">		temperature = <span class="number">0</span>,</span><br><span class="line">		max_tokens = <span class="number">4096</span>,</span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="comment">---@type AvanteAzureProvider</span></span><br><span class="line">	azure = &#123;</span><br><span class="line">		endpoint = <span class="string">&quot;&quot;</span>, <span class="comment">-- example: &quot;https://&lt;your-resource-name&gt;.openai.azure.com&quot;</span></span><br><span class="line">		deployment = <span class="string">&quot;&quot;</span>, <span class="comment">-- Azure deployment name (e.g., &quot;gpt-4o&quot;, &quot;my-gpt-4o-deployment&quot;)</span></span><br><span class="line">		api_version = <span class="string">&quot;2024-06-01&quot;</span>,</span><br><span class="line">		timeout = <span class="number">30000</span>, <span class="comment">-- Timeout in milliseconds</span></span><br><span class="line">		temperature = <span class="number">0</span>,</span><br><span class="line">		max_tokens = <span class="number">4096</span>,</span><br><span class="line">		[<span class="string">&quot;local&quot;</span>] = <span class="literal">false</span>,</span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="comment">---@type AvanteSupportedProvider</span></span><br><span class="line">	claude = &#123;</span><br><span class="line">		endpoint = <span class="string">&quot;https://api.anthropic.com&quot;</span>,</span><br><span class="line">		model = <span class="string">&quot;claude-3-5-sonnet-20240620&quot;</span>,</span><br><span class="line">		timeout = <span class="number">30000</span>, <span class="comment">-- Timeout in milliseconds</span></span><br><span class="line">		temperature = <span class="number">0</span>,</span><br><span class="line">		max_tokens = <span class="number">8000</span>,</span><br><span class="line">		[<span class="string">&quot;local&quot;</span>] = <span class="literal">false</span>,</span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="comment">---@type AvanteSupportedProvider</span></span><br><span class="line">	gemini = &#123;</span><br><span class="line">		endpoint = <span class="string">&quot;https://generativelanguage.googleapis.com/v1beta/models&quot;</span>,</span><br><span class="line">		model = <span class="string">&quot;gemini-1.5-flash-latest&quot;</span>,</span><br><span class="line">		timeout = <span class="number">30000</span>, <span class="comment">-- Timeout in milliseconds</span></span><br><span class="line">		temperature = <span class="number">0</span>,</span><br><span class="line">		max_tokens = <span class="number">4096</span>,</span><br><span class="line">		[<span class="string">&quot;local&quot;</span>] = <span class="literal">false</span>,</span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="comment">---@type AvanteSupportedProvider</span></span><br><span class="line">	cohere = &#123;</span><br><span class="line">		endpoint = <span class="string">&quot;https://api.cohere.com/v1&quot;</span>,</span><br><span class="line">		model = <span class="string">&quot;command-r-plus-08-2024&quot;</span>,</span><br><span class="line">		timeout = <span class="number">30000</span>, <span class="comment">-- Timeout in milliseconds</span></span><br><span class="line">		temperature = <span class="number">0</span>,</span><br><span class="line">		max_tokens = <span class="number">4096</span>,</span><br><span class="line">		[<span class="string">&quot;local&quot;</span>] = <span class="literal">false</span>,</span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="comment">---To add support for custom provider, follow the format below</span></span><br><span class="line">	<span class="comment">---See https://github.com/yetone/avante.nvim/README.md#custom-providers for more details</span></span><br><span class="line">	<span class="comment">---@type &#123;[string]: AvanteProvider&#125;</span></span><br><span class="line">	vendors = &#123;&#125;,</span><br><span class="line">	<span class="comment">---Specify the behaviour of avante.nvim</span></span><br><span class="line">	<span class="comment">---1. auto_apply_diff_after_generation: Whether to automatically apply diff after LLM response.</span></span><br><span class="line">	<span class="comment">---                                     This would simulate similar behaviour to cursor. Default to false.</span></span><br><span class="line">	<span class="comment">---2. auto_set_keymaps                : Whether to automatically set the keymap for the current line. Default to true.</span></span><br><span class="line">	<span class="comment">---                                     Note that avante will safely set these keymap. See https://github.com/yetone/avante.nvim/wiki#keymaps-and-api-i-guess for more details.</span></span><br><span class="line">	<span class="comment">---3. auto_set_highlight_group        : Whether to automatically set the highlight group for the current line. Default to true.</span></span><br><span class="line">	<span class="comment">---4. support_paste_from_clipboard    : Whether to support pasting image from clipboard. This will be determined automatically based whether img-clip is available or not.</span></span><br><span class="line">	behaviour = &#123;</span><br><span class="line">		auto_suggestions = <span class="literal">false</span>, <span class="comment">-- Experimental stage</span></span><br><span class="line">		auto_set_highlight_group = <span class="literal">true</span>,</span><br><span class="line">		auto_set_keymaps = <span class="literal">true</span>,</span><br><span class="line">		auto_apply_diff_after_generation = <span class="literal">false</span>,</span><br><span class="line">		support_paste_from_clipboard = <span class="literal">false</span>,</span><br><span class="line">	&#125;,</span><br><span class="line">	history = &#123;</span><br><span class="line">		storage_path = vim.fn.stdpath(<span class="string">&quot;state&quot;</span>) .. <span class="string">&quot;/avante&quot;</span>,</span><br><span class="line">		paste = &#123;</span><br><span class="line">			extension = <span class="string">&quot;png&quot;</span>,</span><br><span class="line">			filename = <span class="string">&quot;pasted-%Y-%m-%d-%H-%M-%S&quot;</span>,</span><br><span class="line">		&#125;,</span><br><span class="line">	&#125;,</span><br><span class="line">	highlights = &#123;</span><br><span class="line">		<span class="comment">---@type AvanteConflictHighlights</span></span><br><span class="line">		diff = &#123;</span><br><span class="line">			current = <span class="string">&quot;DiffText&quot;</span>,</span><br><span class="line">			incoming = <span class="string">&quot;DiffAdd&quot;</span>,</span><br><span class="line">		&#125;,</span><br><span class="line">	&#125;,</span><br><span class="line">	mappings = &#123;</span><br><span class="line">		<span class="comment">---@class AvanteConflictMappings</span></span><br><span class="line">		diff = &#123;</span><br><span class="line">			ours = <span class="string">&quot;co&quot;</span>,</span><br><span class="line">			theirs = <span class="string">&quot;ct&quot;</span>,</span><br><span class="line">			all_theirs = <span class="string">&quot;ca&quot;</span>,</span><br><span class="line">			both = <span class="string">&quot;cb&quot;</span>,</span><br><span class="line">			cursor = <span class="string">&quot;cc&quot;</span>,</span><br><span class="line">			<span class="built_in">next</span> = <span class="string">&quot;]x&quot;</span>,</span><br><span class="line">			prev = <span class="string">&quot;[x&quot;</span>,</span><br><span class="line">		&#125;,</span><br><span class="line">		suggestion = &#123;</span><br><span class="line">			accept = <span class="string">&quot;&lt;M-l&gt;&quot;</span>,</span><br><span class="line">			<span class="built_in">next</span> = <span class="string">&quot;&lt;M-]&gt;&quot;</span>,</span><br><span class="line">			prev = <span class="string">&quot;&lt;M-[&gt;&quot;</span>,</span><br><span class="line">			dismiss = <span class="string">&quot;&lt;C-]&gt;&quot;</span>,</span><br><span class="line">		&#125;,</span><br><span class="line">		jump = &#123;</span><br><span class="line">			<span class="built_in">next</span> = <span class="string">&quot;]]&quot;</span>,</span><br><span class="line">			prev = <span class="string">&quot;[[&quot;</span>,</span><br><span class="line">		&#125;,</span><br><span class="line">		submit = &#123;</span><br><span class="line">			normal = <span class="string">&quot;&lt;CR&gt;&quot;</span>,</span><br><span class="line">			<span class="built_in">insert</span> = <span class="string">&quot;&lt;C-s&gt;&quot;</span>,</span><br><span class="line">		&#125;,</span><br><span class="line">		<span class="comment">-- <span class="doctag">NOTE:</span> The following will be safely set by avante.nvim</span></span><br><span class="line">		ask = <span class="string">&quot;&lt;leader&gt;aa&quot;</span>,</span><br><span class="line">		edit = <span class="string">&quot;&lt;leader&gt;ae&quot;</span>,</span><br><span class="line">		refresh = <span class="string">&quot;&lt;leader&gt;ar&quot;</span>,</span><br><span class="line">		toggle = &#123;</span><br><span class="line">			default = <span class="string">&quot;&lt;leader&gt;at&quot;</span>,</span><br><span class="line">			<span class="built_in">debug</span> = <span class="string">&quot;&lt;leader&gt;ad&quot;</span>,</span><br><span class="line">			hint = <span class="string">&quot;&lt;leader&gt;ah&quot;</span>,</span><br><span class="line">			suggestion = <span class="string">&quot;&lt;leader&gt;as&quot;</span>,</span><br><span class="line">		&#125;,</span><br><span class="line">		sidebar = &#123;</span><br><span class="line">			switch_windows = <span class="string">&quot;&lt;Tab&gt;&quot;</span>,</span><br><span class="line">			reverse_switch_windows = <span class="string">&quot;&lt;S-Tab&gt;&quot;</span>,</span><br><span class="line">		&#125;,</span><br><span class="line">	&#125;,</span><br><span class="line">	windows = &#123;</span><br><span class="line">		<span class="comment">---@alias AvantePosition &quot;right&quot; | &quot;left&quot; | &quot;top&quot; | &quot;bottom&quot;</span></span><br><span class="line">		position = <span class="string">&quot;right&quot;</span>,</span><br><span class="line">		<span class="built_in">wrap</span> = <span class="literal">true</span>, <span class="comment">-- similar to vim.o.wrap</span></span><br><span class="line">		width = <span class="number">30</span>, <span class="comment">-- default % based on available width in vertical layout</span></span><br><span class="line">		height = <span class="number">30</span>, <span class="comment">-- default % based on available height in horizontal layout</span></span><br><span class="line">		sidebar_header = &#123;</span><br><span class="line">			align = <span class="string">&quot;center&quot;</span>, <span class="comment">-- left, center, right for title</span></span><br><span class="line">			rounded = <span class="literal">true</span>,</span><br><span class="line">		&#125;,</span><br><span class="line">		<span class="built_in">input</span> = &#123;</span><br><span class="line">			prefix = <span class="string">&quot;&gt; &quot;</span>,</span><br><span class="line">		&#125;,</span><br><span class="line">		edit = &#123;</span><br><span class="line">			border = <span class="string">&quot;rounded&quot;</span>,</span><br><span class="line">		&#125;,</span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="comment">--- @class AvanteConflictConfig</span></span><br><span class="line">	diff = &#123;</span><br><span class="line">		autojump = <span class="literal">true</span>,</span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="comment">--- @class AvanteHintsConfig</span></span><br><span class="line">	hints = &#123;</span><br><span class="line">		enabled = <span class="literal">true</span>,</span><br><span class="line">	&#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">---@type avante.Config</span></span><br><span class="line">M.options = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">---@class avante.ConflictConfig: AvanteConflictConfig</span></span><br><span class="line"><span class="comment">---@field mappings AvanteConflictMappings</span></span><br><span class="line"><span class="comment">---@field highlights AvanteConflictHighlights</span></span><br><span class="line">M.diff = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">---@type Provider[]</span></span><br><span class="line">M.providers = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">---@param opts? avante.Config</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">M.setup</span><span class="params">(opts)</span></span></span><br><span class="line">	vim.validate(&#123; opts = &#123; opts, <span class="string">&quot;table&quot;</span>, <span class="literal">true</span> &#125; &#125;)</span><br><span class="line"></span><br><span class="line">	M.options = vim.tbl_deep_extend(</span><br><span class="line">		<span class="string">&quot;force&quot;</span>,</span><br><span class="line">		M.defaults,</span><br><span class="line">		opts <span class="keyword">or</span> &#123;&#125;,</span><br><span class="line">		<span class="comment">---@type avante.Config</span></span><br><span class="line">		&#123;</span><br><span class="line">			behaviour = &#123;</span><br><span class="line">				support_paste_from_clipboard = M.support_paste_image(),</span><br><span class="line">			&#125;,</span><br><span class="line">		&#125;</span><br><span class="line">	)</span><br><span class="line">	M.providers = vim.iter(M.defaults)</span><br><span class="line">		:filter(<span class="function"><span class="keyword">function</span><span class="params">(_, value)</span></span></span><br><span class="line">			<span class="keyword">return</span> <span class="built_in">type</span>(value) == <span class="string">&quot;table&quot;</span> <span class="keyword">and</span> value.endpoint ~= <span class="literal">nil</span></span><br><span class="line">		<span class="keyword">end</span>)</span><br><span class="line">		:fold(&#123;&#125;, <span class="function"><span class="keyword">function</span><span class="params">(acc, k)</span></span></span><br><span class="line">			acc = vim.list_extend(&#123;&#125;, acc)</span><br><span class="line">			acc = vim.list_extend(acc, &#123; k &#125;)</span><br><span class="line">			<span class="keyword">return</span> acc</span><br><span class="line">		<span class="keyword">end</span>)</span><br><span class="line"></span><br><span class="line">	vim.validate(&#123; provider = &#123; M.options.provider, <span class="string">&quot;string&quot;</span>, <span class="literal">false</span> &#125; &#125;)</span><br><span class="line"></span><br><span class="line">	M.diff = vim.tbl_deep_extend(</span><br><span class="line">		<span class="string">&quot;force&quot;</span>,</span><br><span class="line">		&#123;&#125;,</span><br><span class="line">		M.options.diff,</span><br><span class="line">		&#123; mappings = M.options.mappings.diff, highlights = M.options.highlights.diff &#125;</span><br><span class="line">	)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">next</span>(M.options.vendors) ~= <span class="literal">nil</span> <span class="keyword">then</span></span><br><span class="line">		<span class="keyword">for</span> k, v <span class="keyword">in</span> <span class="built_in">pairs</span>(M.options.vendors) <span class="keyword">do</span></span><br><span class="line">			M.options.vendors[k] = <span class="built_in">type</span>(v) == <span class="string">&quot;function&quot;</span> <span class="keyword">and</span> v() <span class="keyword">or</span> v</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">		vim.validate(&#123; vendors = &#123; M.options.vendors, <span class="string">&quot;table&quot;</span>, <span class="literal">true</span> &#125; &#125;)</span><br><span class="line">		M.providers = vim.list_extend(M.providers, vim.tbl_keys(M.options.vendors))</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">---@param opts? avante.Config</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">M.override</span><span class="params">(opts)</span></span></span><br><span class="line">	vim.validate(&#123; opts = &#123; opts, <span class="string">&quot;table&quot;</span>, <span class="literal">true</span> &#125; &#125;)</span><br><span class="line"></span><br><span class="line">	M.options = vim.tbl_deep_extend(<span class="string">&quot;force&quot;</span>, M.options, opts <span class="keyword">or</span> &#123;&#125;)</span><br><span class="line">	M.diff = vim.tbl_deep_extend(</span><br><span class="line">		<span class="string">&quot;force&quot;</span>,</span><br><span class="line">		&#123;&#125;,</span><br><span class="line">		M.options.diff,</span><br><span class="line">		&#123; mappings = M.options.mappings.diff, highlights = M.options.highlights.diff &#125;</span><br><span class="line">	)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">next</span>(M.options.vendors) ~= <span class="literal">nil</span> <span class="keyword">then</span></span><br><span class="line">		<span class="keyword">for</span> k, v <span class="keyword">in</span> <span class="built_in">pairs</span>(M.options.vendors) <span class="keyword">do</span></span><br><span class="line">			M.options.vendors[k] = <span class="built_in">type</span>(v) == <span class="string">&quot;function&quot;</span> <span class="keyword">and</span> v() <span class="keyword">or</span> v</span><br><span class="line">			<span class="keyword">if</span> <span class="keyword">not</span> vim.tbl_contains(M.providers, k) <span class="keyword">then</span></span><br><span class="line">				M.providers = vim.list_extend(M.providers, &#123; k &#125;)</span><br><span class="line">			<span class="keyword">end</span></span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">		vim.validate(&#123; vendors = &#123; M.options.vendors, <span class="string">&quot;table&quot;</span>, <span class="literal">true</span> &#125; &#125;)</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">M = <span class="built_in">setmetatable</span>(M, &#123;</span><br><span class="line">	<span class="built_in">__index</span> = <span class="function"><span class="keyword">function</span><span class="params">(_, k)</span></span></span><br><span class="line">		<span class="keyword">if</span> M.options[k] <span class="keyword">then</span></span><br><span class="line">			<span class="keyword">return</span> M.options[k]</span><br><span class="line">		<span class="keyword">end</span></span><br><span class="line">	<span class="keyword">end</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">M.support_paste_image = <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">	<span class="keyword">return</span> Utils.has(<span class="string">&quot;img-clip.nvim&quot;</span>) <span class="keyword">or</span> Utils.has(<span class="string">&quot;img-clip&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">M.get_window_width = <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">math</span>.<span class="built_in">ceil</span>(vim.o.columns * (M.windows.width / <span class="number">100</span>))</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">---@param provider Provider</span></span><br><span class="line"><span class="comment">---@return boolean</span></span><br><span class="line">M.has_provider = <span class="function"><span class="keyword">function</span><span class="params">(provider)</span></span></span><br><span class="line">	<span class="keyword">return</span> M.options[provider] ~= <span class="literal">nil</span> <span class="keyword">or</span> M.vendors[provider] ~= <span class="literal">nil</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">---get supported providers</span></span><br><span class="line"><span class="comment">---@param provider Provider</span></span><br><span class="line"><span class="comment">---@return AvanteProviderFunctor</span></span><br><span class="line">M.get_provider = <span class="function"><span class="keyword">function</span><span class="params">(provider)</span></span></span><br><span class="line">	<span class="keyword">if</span> M.options[provider] ~= <span class="literal">nil</span> <span class="keyword">then</span></span><br><span class="line">		<span class="keyword">return</span> vim.deepcopy(M.options[provider], <span class="literal">true</span>)</span><br><span class="line">	<span class="keyword">elseif</span> M.vendors[provider] ~= <span class="literal">nil</span> <span class="keyword">then</span></span><br><span class="line">		<span class="keyword">return</span> vim.deepcopy(M.vendors[provider], <span class="literal">true</span>)</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">error</span>(<span class="string">&quot;Failed to find provider: &quot;</span> .. provider, <span class="number">2</span>)</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">M.BASE_PROVIDER_KEYS = &#123;</span><br><span class="line">	<span class="string">&quot;endpoint&quot;</span>,</span><br><span class="line">	<span class="string">&quot;model&quot;</span>,</span><br><span class="line">	<span class="string">&quot;deployment&quot;</span>,</span><br><span class="line">	<span class="string">&quot;api_version&quot;</span>,</span><br><span class="line">	<span class="string">&quot;proxy&quot;</span>,</span><br><span class="line">	<span class="string">&quot;allow_insecure&quot;</span>,</span><br><span class="line">	<span class="string">&quot;api_key_name&quot;</span>,</span><br><span class="line">	<span class="string">&quot;timeout&quot;</span>,</span><br><span class="line">	<span class="comment">-- internal</span></span><br><span class="line">	<span class="string">&quot;local&quot;</span>,</span><br><span class="line">	<span class="string">&quot;_shellenv&quot;</span>,</span><br><span class="line">	<span class="string">&quot;tokenizer_id&quot;</span>,</span><br><span class="line">	<span class="string">&quot;use_xml_format&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> M</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>~/.config/nvim/init.lua</code>中添加</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&quot;plugin-config.avante&quot;</span>).setup()</span><br></pre></td></tr></table></figure>

<p>在<code>~/.bashrc</code>添加api key </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> ANTHROPIC_API_KEY=*** <span class="comment">#码了</span></span><br></pre></td></tr></table></figure>
<div class="post-content"><a href="/2024/10/07/[OBS]nvim-Neovim Cursor (avante.nvim)/Pasted_image_20241007150217.png" title="" title=" class="gallery-item"><img src="/2024/10/07/[OBS]nvim-Neovim Cursor (avante.nvim)/Pasted_image_20241007150217.png" alt="" title=""></a></div>

<h2 id="Fix-Error"><a href="#Fix-Error" class="headerlink" title="Fix Error"></a>Fix Error</h2><h3 id="Error-1"><a href="#Error-1" class="headerlink" title="Error #1"></a>Error #1</h3><p>运行时出现这个报错</p>
<div class="post-content"><a href="/2024/10/07/[OBS]nvim-Neovim Cursor (avante.nvim)/Pasted_image_20241007151413.png" title="" title=" class="gallery-item"><img src="/2024/10/07/[OBS]nvim-Neovim Cursor (avante.nvim)/Pasted_image_20241007151413.png" alt="" title=""></a></div>
参见 https://github.com/yetone/avante.nvim/pull/560/files

<p>由于这个PR没有被merge所以决定fork一下这个仓库再应用更改</p>
<div class="post-content"><a href="/2024/10/07/[OBS]nvim-Neovim Cursor (avante.nvim)/Pasted_image_20241007154329.png" title="" title=" class="gallery-item"><img src="/2024/10/07/[OBS]nvim-Neovim Cursor (avante.nvim)/Pasted_image_20241007154329.png" alt="" title=""></a></div>
push到远程仓库后记得release一下

<p>然后将该plugin的仓库地址改为我自己的</p>
<div class="post-content"><a href="/2024/10/07/[OBS]nvim-Neovim Cursor (avante.nvim)/Pasted_image_20241007155603.png" title="" title=" class="gallery-item"><img src="/2024/10/07/[OBS]nvim-Neovim Cursor (avante.nvim)/Pasted_image_20241007155603.png" alt="" title=""></a></div>
成功消除了这个报错
> 现已切换回原仓库的main branch

<h3 id="Error-2"><a href="#Error-2" class="headerlink" title="Error #2"></a>Error #2</h3><div class="post-content"><a href="/2024/10/07/[OBS]nvim-Neovim Cursor (avante.nvim)/Pasted_image_20241007155718.png" title="" title=" class="gallery-item"><img src="/2024/10/07/[OBS]nvim-Neovim Cursor (avante.nvim)/Pasted_image_20241007155718.png" alt="" title=""></a></div>
没有回复
访问 https://console.anthropic.com/settings/plans 发现是 没有Funds（说好的注册送5刀的额度的呢。。。）

<p>使用WildCard服务 <a target="_blank" rel="noopener" href="https://bewildcard.com/card">https://bewildcard.com/card</a> ，具体账密见密码簿</p>
<h3 id="Error-3"><a href="#Error-3" class="headerlink" title="Error #3"></a>Error #3</h3><p>发现服务器无响应</p>
<ul>
<li>设置终端proxy <code>export https_proxy=127.0.0.1:7897</code><br>尝试输入<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">curl https://api.anthropic.com/v1/messages \                                                                                                   </span><br><span class="line">  -H <span class="string">&quot;x-api-key: &lt;api-key&gt;&quot;</span> \</span><br><span class="line">  -H <span class="string">&quot;anthropic-version: 2023-06-01&quot;</span> \</span><br><span class="line">  -H <span class="string">&quot;content-type: application/json&quot;</span> \</span><br><span class="line">  -d <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">    &quot;model&quot;: &quot;claude-3-sonnet-20240229&quot;,</span></span><br><span class="line"><span class="string">    &quot;max_tokens&quot;: 1024,</span></span><br><span class="line"><span class="string">    &quot;messages&quot;: [</span></span><br><span class="line"><span class="string">      &#123;</span></span><br><span class="line"><span class="string">        &quot;role&quot;: &quot;user&quot;,</span></span><br><span class="line"><span class="string">        &quot;content&quot;: &quot;What is the capital of France?&quot;</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">    ]</span></span><br><span class="line"><span class="string">  &#125;&#x27;</span></span><br></pre></td></tr></table></figure></li>
<li><code>sudo conda update curl</code> to solve curl(77) error</li>
<li><code>export CURL_CA_BUNDLE=/etc/ssl/certs/ca-certificates.crt</code></li>
</ul>
<h3 id="Error-4"><a href="#Error-4" class="headerlink" title="Error #4"></a>Error #4</h3><p>更新编译报错</p>
<div class="post-content"><a href="/2024/10/07/[OBS]nvim-Neovim Cursor (avante.nvim)/Pasted_image_20250410200428.png" title="" title=" class="gallery-item"><img src="/2024/10/07/[OBS]nvim-Neovim Cursor (avante.nvim)/Pasted_image_20250410200428.png" alt="" title=""></a></div>
ISSUE: https://github.com/yetone/avante.nvim/issues/612#issuecomment-2375729928

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/.local/share/nvim/lazy/avante.nvim</span><br><span class="line">make <span class="comment"># or BUILD_FROM_SOURCE=true make</span></span><br><span class="line"><span class="built_in">ls</span> ./build/</span><br><span class="line">avante_html2md.so  avante_repo_map.so  avante_templates.so  avante_tokenizers.so</span><br></pre></td></tr></table></figure>

</div><script src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.0/dist/js/lightgallery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-fullscreen.js@1.2.0/dist/lg-fullscreen.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.3.0/dist/lg-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-autoplay.js@1.2.0/dist/lg-autoplay.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-video.js@1.3.0/dist/lg-video.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-hash.js@1.0.0/dist/lg-hash.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-pager.js@1.0.0/dist/lg-pager.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script></div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2024/04/08/%5BOBS%5DAI-Amazon%20Echo%20Alexa%20persuade%20people%20to%20commit%20suicide/"><img class="fill" src="/gallery/AI.png" alt="Amazon Echo Alexa persuade people to commit suicide" referrerpolicy="no-referrer"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2024-04-07T19:38:23.000Z" title="4/8/2024, 3:38:23 AM">2024-04-08</time></span><span class="level-item">Updated&nbsp;<time dateTime="2026-02-14T16:35:53.764Z" title="2/15/2026, 12:35:53 AM">2026-02-15</time></span><span class="level-item">8 minutes read (About 1235 words)</span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/04/08/%5BOBS%5DAI-Amazon%20Echo%20Alexa%20persuade%20people%20to%20commit%20suicide/">Amazon Echo Alexa persuade people to commit suicide</a></p><div class="content"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.0/dist/css/lightgallery.min.css" /><div class=".article-gallery"><h2 id="Case-description"><a href="#Case-description" class="headerlink" title="Case description"></a>Case description</h2><p>reference link:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.newsweek.com/amazon-echo-tells-uk-woman-stab-herself-1479074">https://www.newsweek.com/amazon-echo-tells-uk-woman-stab-herself-1479074</a></li>
<li><a target="_blank" rel="noopener" href="https://www.news18.com/news/tech/amazon-alexa-told-this-lady-to-kill-herself-because-humans-are-bad-for-the-planet-2434375.html">https://www.news18.com/news/tech/amazon-alexa-told-this-lady-to-kill-herself-because-humans-are-bad-for-the-planet-2434375.html</a></li>
<li><a target="_blank" rel="noopener" href="https://www.ibtimes.co.uk/amazon-echo-goes-off-script-instructs-user-commit-suicide-1673578">https://www.ibtimes.co.uk/amazon-echo-goes-off-script-instructs-user-commit-suicide-1673578</a></li>
<li><a target="_blank" rel="noopener" href="https://www.mirror.co.uk/news/uk-news/my-amazon-echo-went-rogue-21127994">https://www.mirror.co.uk/news/uk-news/my-amazon-echo-went-rogue-21127994</a></li>
</ul>
<p>Amazon Echo devices, equipped with the Alexa voice assistant, are marketed as multifunctional smart home hubs that aim to simplify and enhance daily life. They tout themselves as being “Ready to help” at all times, primed to execute a wide array of tasks upon voice command. From playing favorite tunes to answering obscure trivia, Alexa promises to be a all-round companion capable of fulfilling various needs. Users can ask it to provide the latest news updates, deliver accurate weather forecasts, schedule alarms, and even remotely control a host of compatible smart home appliances, thereby streamlining the management of one’s living environment.</p>
<p>However, despite Alexa’s advertised prowess in providing reliable information and performing numerous practical functions, an alarming event involving a 29-year-old student, Danni Morritt, highlighted a rare yet significant flaw. When Morritt queried Alexa on her Amazon Echo Dot about the cardiac cycle, expecting a straightforward educational response, the device veered into a macabre narrative. Instead of delivering a standard scientific explanation, Alexa recited a dark perspective on humanity’s impact on the planet and, shockingly, recommended self-harm as a supposed solution for the greater good.</p>
<p>Upon hearing this disturbing advice, Morritt discerned that Alexa attributed its unusual reply to a Wikipedia page, a platform known for its open-editing policy. Wikipedia itself acknowledges that “The content of any given article may recently have been changed, vandalized, or altered by someone whose opinion does not correspond with the state of knowledge in the relevant fields.” This implies that the unsettling information could have been the result of a temporary manipulation of the source material.</p>
<p>Wikipedia operates on an open editing model, allowing registered users to collaboratively create and modify articles using wiki markup. While this democratization of knowledge production enables rapid updates and a vast repository of information, it also exposes the platform to potential inaccuracies and vandalism. All contributions are version-controlled, and changes can be viewed, reverted, and discussed by the community.</p>
<p>Regarding credibility, Wikipedia insists on citing reliable sources for all factual statements. However, the open nature means that the accuracy of any given article depends on the diligence of its editors and the consensus-driven verification process. Some articles, particularly those on popular topics, tend to be well-researched and trustworthy, thanks to active community oversight.</p>
<p>In the context of the Alexa incident, it seems that a temporarily vandalized Wikipedia entry may have been accessed and repeated by Alexa. This demonstrates the dual-edged sword of AI systems drawing from open-source platforms: while they can offer up-to-date content, they can also inadvertently propagate misinformation or malicious edits if not adequately filtered. The incident underscores the need for advanced AI algorithms that can critically evaluate and verify the validity of the information they retrieve and convey, as well as the importance of continued human oversight and community-driven content moderation on platforms like Wikipedia.</p>
<p>In response to the incident, Amazon neither denied nor dismissed the occurrence but rather took swift action. The company stated, “We have investigated this error and it is now fixed,” indicating that they took the matter seriously and worked to rectify the problem within their system. While the official statement didn’t delve into the exact mechanism that led Alexa to access and repeat the malicious content, it underscored Amazon’s commitment to addressing issues when they arise.</p>
<p>The episode raised broader concerns about the reliability and safety of AI-powered devices that rely on internet-based sources for information. Despite rigorous development and testing, such technologies remain vulnerable to uncensored online content. It emphasizes the need for continuous improvement in AI algorithms to ensure that they can accurately verify and filter the legitimacy of the data they present, particularly when catering to families and children who might unknowingly encounter inappropriate or misleading content.</p>
<p>This incident also reinforces the importance of vigilance among consumers and tech companies alike, highlighting the necessity for comprehensive safeguards against misinformation and malicious edits infiltrating intelligent devices. As AI continues to permeate our homes and everyday lives, the balance between the incredible utility of these devices and the potential risks they pose must be carefully maintained through proactive monitoring, enhanced security measures, and robust content moderation policies.</p>
<h2 id="10-Steps-Case-Analysis"><a href="#10-Steps-Case-Analysis" class="headerlink" title="10 Steps Case Analysis"></a>10 Steps Case Analysis</h2><p>1. Identify Ethical Issues</p>
<p>Reliance on Dynamic Sources: The core ethical issue revolves around the dependency of AI systems like Alexa on dynamically changing sources, such as Wikipedia, which can be subjected to vandalism or misinformation. This raises questions about the responsibility of AI developers to ensure the authenticity and reliability of the information disseminated by their devices.</p>
<p>User Safety and Well-being: The incident endangered the mental health and emotional well-being of the user, specifically considering the sensitive topic of self-harm, and could have had an adverse impact on children exposed to such content.</p>
<p>Transparency and Consent: The case brings up the need for transparent communication with users about the potential pitfalls of relying solely on AI-generated responses and obtaining implicit or explicit consent for sharing possibly contentious information.</p>
<p>2. Narrow the Focus</p>
<p>Quality Control for Open-Edit Platforms: Focusing on the specific issue of how AI integrations handle content sourced from open-edit platforms, including the processes used to validate, monitor, and update the information.</p>
<p>Response to Malicious Edits: Exploring how quickly and effectively AI providers respond to incidents where maliciously altered content is distributed, and what preventive measures they can implement to avoid recurrence.</p>
<p>3. Identify Relevant and Missing Facts</p>
<p>Detection and Correction Timeline: Determining when the malicious edit occurred on Wikipedia, how long it remained undetected, and the time it took for Amazon to identify and rectify the issue.</p>
<p>Pre-existing Safeguards: Investigating whether Amazon had established any content-filtering protocols specifically for handling information from open-edit platforms before this incident.</p>
<p>Extent of Exposure: Assessing the number of users affected by this misinformation before the correction was made and if there are any similar reported incidents.</p>
<p>4. Make Assumptions</p>
<p>Motivation Behind the Edit: Assuming the Wikipedia edit was a deliberate act of sabotage or a thoughtless prank, and reflecting on the ease with which such incidents can occur on open-source platforms.</p>
<p>Enhanced Content Moderation: Speculating that Amazon would fortify its content validation procedures to prevent similar occurrences in the future, perhaps by incorporating additional layers of AI-based content moderation.</p>
<p>Education and Awareness: Assuming Amazon will engage in user education initiatives to emphasize the importance of cross-verifying AI-provided information and to caution against taking AI-generated responses as gospel truth.</p>
<p>5. Clarify Terminology</p>
<p>Malicious Edits: Content alterations made with the intent to deceive, harm, or provoke an inappropriate response, which can affect AI systems relying on these platforms.</p>
<p>Dynamic Data Sourcing: The practice of AI systems accessing and utilizing data from constantly changing web sources, requiring real-time validation checks to maintain data integrity.</p>
<p>AI Content Moderation: The process by which AI algorithms analyze, verify, and filter the information they collect from diverse sources to ensure its accuracy and appropriateness before presenting it to users.</p>
</div><script src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.4.0/dist/js/lightgallery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-fullscreen.js@1.2.0/dist/lg-fullscreen.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.3.0/dist/lg-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-autoplay.js@1.2.0/dist/lg-autoplay.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-video.js@1.3.0/dist/lg-video.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-hash.js@1.0.0/dist/lg-hash.min.js"></script><script src="https://cdn.jsdelivr.net/npm/lg-pager.js@1.0.0/dist/lg-pager.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script></div></article></div><nav class="pagination is-centered mt-4" role="navigation" aria-label="pagination"><div class="pagination-previous is-invisible is-hidden-mobile"><a href="/tags/AI/page/0/">Previous</a></div><div class="pagination-next"><a href="/tags/AI/page/2/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link is-current" href="/tags/AI/">1</a></li><li><a class="pagination-link" href="/tags/AI/page/2/">2</a></li></ul></nav></div><style>.column.column-left,.column.column-right{display:none}</style><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/avatar.png" alt="Chen Yulin"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Chen Yulin</p><p class="is-size-6 is-block">SJTU student</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Manchester by the Sea</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives/"><p class="title">312</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories/"><p class="title">10</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags/"><p class="title">235</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/Chen-Yulin" target="_blank" rel="me noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Github" href="https://github.com/Chen-Yulin"><i class="fab fa-github"></i></a></div></div></div><!--!--><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2026/02/"><span class="level-start"><span class="level-item">February 2026</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/archives/2026/01/"><span class="level-start"><span class="level-item">January 2026</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/12/"><span class="level-start"><span class="level-item">December 2025</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/11/"><span class="level-start"><span class="level-item">November 2025</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/10/"><span class="level-start"><span class="level-item">October 2025</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/09/"><span class="level-start"><span class="level-item">September 2025</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/08/"><span class="level-start"><span class="level-item">August 2025</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/07/"><span class="level-start"><span class="level-item">July 2025</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/06/"><span class="level-start"><span class="level-item">June 2025</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/05/"><span class="level-start"><span class="level-item">May 2025</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/04/"><span class="level-start"><span class="level-item">April 2025</span></span><span class="level-end"><span class="level-item tag">17</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/03/"><span class="level-start"><span class="level-item">March 2025</span></span><span class="level-end"><span class="level-item tag">45</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/02/"><span class="level-start"><span class="level-item">February 2025</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/01/"><span class="level-start"><span class="level-item">January 2025</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/12/"><span class="level-start"><span class="level-item">December 2024</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/11/"><span class="level-start"><span class="level-item">November 2024</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/10/"><span class="level-start"><span class="level-item">October 2024</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/09/"><span class="level-start"><span class="level-item">September 2024</span></span><span class="level-end"><span class="level-item tag">16</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/08/"><span class="level-start"><span class="level-item">August 2024</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/07/"><span class="level-start"><span class="level-item">July 2024</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/06/"><span class="level-start"><span class="level-item">June 2024</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/05/"><span class="level-start"><span class="level-item">May 2024</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/04/"><span class="level-start"><span class="level-item">April 2024</span></span><span class="level-end"><span class="level-item tag">17</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/03/"><span class="level-start"><span class="level-item">March 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/01/"><span class="level-start"><span class="level-item">January 2024</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/12/"><span class="level-start"><span class="level-item">December 2023</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2023/05/"><span class="level-start"><span class="level-item">May 2023</span></span><span class="level-end"><span class="level-item tag">46</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/08/"><span class="level-start"><span class="level-item">August 2022</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/05/"><span class="level-start"><span class="level-item">May 2022</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/04/"><span class="level-start"><span class="level-item">April 2022</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><figure class="media-left"><a class="image" href="/2026/02/14/%5BOBS%5Dexist_label/"><img src="/thumb/Research-paper.png" alt="exist_label"></a></figure><div class="media-content"><p class="date"><time dateTime="2026-02-14T12:01:54.000Z">2026-02-14</time></p><p class="title"><a href="/2026/02/14/%5BOBS%5Dexist_label/">exist_label</a></p><p class="categories"><a href="/categories/Note/">Note</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2026/02/06/%5BOBS%5DDeep%20Learning-BAGEL-Unified-Multimodal-Pretraining/"><img src="/thumb/Research-paper.png" alt="BAGEL-Unified-Multimodal-Pretraining"></a></figure><div class="media-content"><p class="date"><time dateTime="2026-02-05T21:30:00.000Z">2026-02-06</time></p><p class="title"><a href="/2026/02/06/%5BOBS%5DDeep%20Learning-BAGEL-Unified-Multimodal-Pretraining/">BAGEL-Unified-Multimodal-Pretraining</a></p><p class="categories"><a href="/categories/Review/">Review</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2026/02/05/%5BOBS%5DDeep%20Learning-LingBot-VLA/"><img src="/thumb/Research-paper.png" alt="LingBot-VLA"></a></figure><div class="media-content"><p class="date"><time dateTime="2026-02-05T15:30:00.000Z">2026-02-05</time></p><p class="title"><a href="/2026/02/05/%5BOBS%5DDeep%20Learning-LingBot-VLA/">LingBot-VLA</a></p><p class="categories"><a href="/categories/Review/">Review</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2026/02/05/%5BOBS%5DDeep%20Learning-Transformer-Mixture-of-Experts-Survey/"><img src="/thumb/LLM.png" alt="Mixture-of-Experts-Survey"></a></figure><div class="media-content"><p class="date"><time dateTime="2026-02-05T15:30:00.000Z">2026-02-05</time></p><p class="title"><a href="/2026/02/05/%5BOBS%5DDeep%20Learning-Transformer-Mixture-of-Experts-Survey/">Mixture-of-Experts-Survey</a></p><p class="categories"><a href="/categories/Review/">Review</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2026-02-05T00:00:00.000Z">2026-02-05</time></p><p class="title"><a href="/2026/02/05/%5BOBS%5DRobotics-Humanoid-Robot-Control-Methods/">人形机器人控制方法综述</a></p><p class="categories"><a href="/categories/Note/">Note</a></p></div></article></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/3D-Scene/"><span class="tag">3D-Scene</span><span class="tag">17</span></a></div><div class="control"><a class="tags has-addons" href="/tags/6-D/"><span class="tag">6-D</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AI/"><span class="tag">AI</span><span class="tag">16</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AIGC/"><span class="tag">AIGC</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/API/"><span class="tag">API</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/AR/"><span class="tag">AR</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Academic/"><span class="tag">Academic</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Algorithm/"><span class="tag">Algorithm</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Aliyun/"><span class="tag">Aliyun</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/App/"><span class="tag">App</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Atlas/"><span class="tag">Atlas</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/BS4/"><span class="tag">BS4</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Bayesian-Inference/"><span class="tag">Bayesian-Inference</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Beautify/"><span class="tag">Beautify</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Behaviorism/"><span class="tag">Behaviorism</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Business/"><span class="tag">Business</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C/"><span class="tag">C</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CADC/"><span class="tag">CADC</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CD/"><span class="tag">CD</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CLI/"><span class="tag">CLI</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CLIP/"><span class="tag">CLIP</span><span class="tag">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CNN/"><span class="tag">CNN</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CV/"><span class="tag">CV</span><span class="tag">68</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Camera/"><span class="tag">Camera</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Capstone/"><span class="tag">Capstone</span><span class="tag">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Chemistry/"><span class="tag">Chemistry</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Claude/"><span class="tag">Claude</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Communication/"><span class="tag">Communication</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Contrastive-Learning/"><span class="tag">Contrastive-Learning</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Control/"><span class="tag">Control</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Csharp/"><span class="tag">Csharp</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Css/"><span class="tag">Css</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Cuda/"><span class="tag">Cuda</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DD/"><span class="tag">DD</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DINO/"><span class="tag">DINO</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DT/"><span class="tag">DT</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Dataframe/"><span class="tag">Dataframe</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Debate/"><span class="tag">Debate</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Debugger/"><span class="tag">Debugger</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Deep-Learning/"><span class="tag">Deep-Learning</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Development-Tools/"><span class="tag">Development-Tools</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Diffusion/"><span class="tag">Diffusion</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Diffusion-Policy/"><span class="tag">Diffusion-Policy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DiffusionModel/"><span class="tag">DiffusionModel</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Discrete-Mathematics/"><span class="tag">Discrete-Mathematics</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Disney/"><span class="tag">Disney</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Docker/"><span class="tag">Docker</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Docs/"><span class="tag">Docs</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Dynamic-programming/"><span class="tag">Dynamic-programming</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ESP32/"><span class="tag">ESP32</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Education/"><span class="tag">Education</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Embeded-System/"><span class="tag">Embeded-System</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Embodied-AI/"><span class="tag">Embodied-AI</span><span class="tag">19</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Emoation/"><span class="tag">Emoation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Emotion/"><span class="tag">Emotion</span><span class="tag">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Ethic/"><span class="tag">Ethic</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Experiment/"><span class="tag">Experiment</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/FL/"><span class="tag">FL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/FPN/"><span class="tag">FPN</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Family/"><span class="tag">Family</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Federated-Learning/"><span class="tag">Federated-Learning</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Foundation/"><span class="tag">Foundation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/FoundationModel/"><span class="tag">FoundationModel</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Functional-programming/"><span class="tag">Functional programming</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GPT/"><span class="tag">GPT</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Game/"><span class="tag">Game</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Gated-NN/"><span class="tag">Gated-NN</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Git/"><span class="tag">Git</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Github/"><span class="tag">Github</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Godot/"><span class="tag">Godot</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Graph/"><span class="tag">Graph</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/HPC/"><span class="tag">HPC</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/HRI/"><span class="tag">HRI</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Haskell/"><span class="tag">Haskell</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Health/"><span class="tag">Health</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Hexo/"><span class="tag">Hexo</span><span class="tag">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Hierarchical/"><span class="tag">Hierarchical</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Html/"><span class="tag">Html</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Humanism/"><span class="tag">Humanism</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Humanoid/"><span class="tag">Humanoid</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/HumanoidRobot/"><span class="tag">HumanoidRobot</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Hybrid-Control/"><span class="tag">Hybrid-Control</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Hyprland/"><span class="tag">Hyprland</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/IK/"><span class="tag">IK</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Image-Grounding/"><span class="tag">Image-Grounding</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Image-Text/"><span class="tag">Image-Text</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Image-generation/"><span class="tag">Image-generation</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Image2Text/"><span class="tag">Image2Text</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ImgGen/"><span class="tag">ImgGen</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ImitationLearning/"><span class="tag">ImitationLearning</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Information-Theory/"><span class="tag">Information-Theory</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Jolt/"><span class="tag">Jolt</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Json/"><span class="tag">Json</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/LLM/"><span class="tag">LLM</span><span class="tag">17</span></a></div><div class="control"><a class="tags has-addons" href="/tags/LSP/"><span class="tag">LSP</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/LatentAction/"><span class="tag">LatentAction</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Latex/"><span class="tag">Latex</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Lego/"><span class="tag">Lego</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Life/"><span class="tag">Life</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/LinearAlgebra/"><span class="tag">LinearAlgebra</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">22</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Live2d/"><span class="tag">Live2d</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Love/"><span class="tag">Love</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Lua/"><span class="tag">Lua</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MBTI/"><span class="tag">MBTI</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ML/"><span class="tag">ML</span><span class="tag">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MPC/"><span class="tag">MPC</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MR-AR/"><span class="tag">MR/AR</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Machine-Learning/"><span class="tag">Machine-Learning</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Mason/"><span class="tag">Mason</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Math/"><span class="tag">Math</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Meme/"><span class="tag">Meme</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Message-Passing/"><span class="tag">Message-Passing</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MindPlus/"><span class="tag">MindPlus</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MoE/"><span class="tag">MoE</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Mod/"><span class="tag">Mod</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Model-Predictive-Control/"><span class="tag">Model-Predictive-Control</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Motivation/"><span class="tag">Motivation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Moveit/"><span class="tag">Moveit</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Movie/"><span class="tag">Movie</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Multi-Agent/"><span class="tag">Multi-Agent</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Multi-modal/"><span class="tag">Multi-modal</span><span class="tag">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Multi-view/"><span class="tag">Multi-view</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/MultiModal/"><span class="tag">MultiModal</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Music/"><span class="tag">Music</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NLP/"><span class="tag">NLP</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NN/"><span class="tag">NN</span><span class="tag">12</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Network/"><span class="tag">Network</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Nodejs/"><span class="tag">Nodejs</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Numpy/"><span class="tag">Numpy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Nvim/"><span class="tag">Nvim</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Object-Detection/"><span class="tag">Object-Detection</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Open-Vocabulary/"><span class="tag">Open-Vocabulary</span><span class="tag">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/OpenCV/"><span class="tag">OpenCV</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Oral/"><span class="tag">Oral</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PHD/"><span class="tag">PHD</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PSY/"><span class="tag">PSY</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Pandas/"><span class="tag">Pandas</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Panoptic/"><span class="tag">Panoptic</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Path/"><span class="tag">Path</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Philosophy/"><span class="tag">Philosophy</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PhysX/"><span class="tag">PhysX</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Physical-Scene/"><span class="tag">Physical-Scene</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Physics-engine/"><span class="tag">Physics-engine</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Pio/"><span class="tag">Pio</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Planning/"><span class="tag">Planning</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Plugin/"><span class="tag">Plugin</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PoseEstimation/"><span class="tag">PoseEstimation</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Postgraduate/"><span class="tag">Postgraduate</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Prefab/"><span class="tag">Prefab</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Probability/"><span class="tag">Probability</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag">30</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Pytorch/"><span class="tag">Pytorch</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/QML/"><span class="tag">QML</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Quantum/"><span class="tag">Quantum</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RAG/"><span class="tag">RAG</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RL/"><span class="tag">RL</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RNN/"><span class="tag">RNN</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ROS/"><span class="tag">ROS</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Reading/"><span class="tag">Reading</span><span class="tag">19</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Real2Sim/"><span class="tag">Real2Sim</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Reconstruct/"><span class="tag">Reconstruct</span><span class="tag">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Regex/"><span class="tag">Regex</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Reinforcement-Learning/"><span class="tag">Reinforcement-Learning</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Reinforcement-learning/"><span class="tag">Reinforcement-learning</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Repository/"><span class="tag">Repository</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Representation-Learning/"><span class="tag">Representation-Learning</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Research-paper/"><span class="tag">Research-paper</span><span class="tag">97</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Robot/"><span class="tag">Robot</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/RobotLearning/"><span class="tag">RobotLearning</span><span class="tag">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Robotics/"><span class="tag">Robotics</span><span class="tag">38</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SJTU-Lecture/"><span class="tag">SJTU-Lecture</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SQL/"><span class="tag">SQL</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SSH/"><span class="tag">SSH</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Scalability/"><span class="tag">Scalability</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Scene-graph/"><span class="tag">Scene-graph</span><span class="tag">34</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Scene-synthesis/"><span class="tag">Scene-synthesis</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Science-fiction/"><span class="tag">Science-fiction</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Scrap/"><span class="tag">Scrap</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Script/"><span class="tag">Script</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Segmentation/"><span class="tag">Segmentation</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Semantic/"><span class="tag">Semantic</span><span class="tag">15</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Shader/"><span class="tag">Shader</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Shell/"><span class="tag">Shell</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Signals-and-Systems/"><span class="tag">Signals and Systems</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Sim2Real/"><span class="tag">Sim2Real</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Sklearn/"><span class="tag">Sklearn</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Snippets/"><span class="tag">Snippets</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Society/"><span class="tag">Society</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Star-rail/"><span class="tag">Star-rail</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Statistics/"><span class="tag">Statistics</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Subgraph/"><span class="tag">Subgraph</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Submodule/"><span class="tag">Submodule</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Supervised-learning/"><span class="tag">Supervised-learning</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Survey/"><span class="tag">Survey</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/TC/"><span class="tag">TC</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/TOEFL/"><span class="tag">TOEFL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Task-Planning/"><span class="tag">Task-Planning</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Tasks/"><span class="tag">Tasks</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Tech-Communication/"><span class="tag">Tech Communication</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Torch/"><span class="tag">Torch</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Transformer/"><span class="tag">Transformer</span><span class="tag">20</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Translation-Embedding/"><span class="tag">Translation-Embedding</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Travel/"><span class="tag">Travel</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/UI/"><span class="tag">UI</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Unified-Multimodal/"><span class="tag">Unified-Multimodal</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Unity/"><span class="tag">Unity</span><span class="tag">20</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Unsupervised-learning/"><span class="tag">Unsupervised-learning</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/VAE/"><span class="tag">VAE</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/VLA/"><span class="tag">VLA</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/VLM/"><span class="tag">VLM</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/VLP/"><span class="tag">VLP</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/VQ-VAE/"><span class="tag">VQ-VAE</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Variational-Inference/"><span class="tag">Variational-Inference</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Version-management/"><span class="tag">Version-management</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ViT/"><span class="tag">ViT</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/VideoEditing/"><span class="tag">VideoEditing</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Vim/"><span class="tag">Vim</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Visual-Relation/"><span class="tag">Visual-Relation</span><span class="tag">23</span></a></div><div class="control"><a class="tags has-addons" href="/tags/WSL/"><span class="tag">WSL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Waybar/"><span class="tag">Waybar</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Wayland/"><span class="tag">Wayland</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Web/"><span class="tag">Web</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Website/"><span class="tag">Website</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Well-being/"><span class="tag">Well-being</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Window-manager/"><span class="tag">Window-manager</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/WorldModel/"><span class="tag">WorldModel</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/YKLL/"><span class="tag">YKLL</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Zen/"><span class="tag">Zen</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E2%99%A5%EF%B8%8F/"><span class="tag">♥️</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AE%9E%E4%B9%A0/"><span class="tag">实习</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%F0%9F%8D%A2/"><span class="tag">🍢</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%F0%9F%8D%B0/"><span class="tag">🍰</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%F0%9F%90%B1/"><span class="tag">🐱</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%F0%9F%A7%80/"><span class="tag">🧀</span><span class="tag">1</span></a></div></div></div></div></div></div><style>.column.column-left,.column.column-right{display:block}</style></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img class="logo-img" src="/img/cyllogo.png" alt="Chen Yulin&#039;s Blog" height="28"><img class="logo-img-dark" src="/img/cyllogonight.png" alt="Chen Yulin&#039;s Blog" height="28"></a><p class="is-size-7"><span>&copy; 2026 Chen Yulin</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/imaegoo/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/Chen-Yulin"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><div class="searchbox-pinyin"><label class="checkbox"><input id="search-by-pinyin" type="checkbox" checked="checked"><span> 拼音检索</span></label></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/imaegoo/pinyin.js" defer></script><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script><script type="text/javascript" src="/js/imaegoo/imaegoo.js"></script><script type="text/javascript" src="/js/imaegoo/universe.js"></script><script type="text/javascript" src="/js/imaegoo/falling-petals.js"></script><!-- hexo injector body_end start -->
<link rel="stylesheet" crossorigin href="https://g.alicdn.com/aliyun-documentation/web-chatbot-ui/0.0.11/index.css" />
<script type="module" crossorigin src="https://g.alicdn.com/aliyun-documentation/web-chatbot-ui/0.0.11/index.js"></script>
<script>
  window.CHATBOT_CONFIG = {
    endpoint: "https://webchat-bot-iqu-knzhgrvznd.cn-hangzhou.fcapp.run/chat", // 可以替换为 https://{your-fc-http-trigger-domain}/chat
    displayByDefault: false, // 默认不展示 AI 助手聊天框
    aiChatOptions: { // aiChatOptions 中 options 会传递 aiChat 组件，自定义取值参考：https://docs.nlkit.com/nlux/reference/ui/ai-chat
      conversationOptions: { // 自定义取值参考：https://docs.nlkit.com/nlux/reference/ui/ai-chat#conversation-options
        conversationStarters: [
          {prompt: '你是谁？'},
          {prompt: '博主又是谁？'},
          {prompt: '怎么使用这个网站？'},
          {prompt: '想要博主联系方式！'},
        ]
      },
      displayOptions: { // 自定义取值参考：https://docs.nlkit.com/nlux/reference/ui/ai-chat#display-options
        height: 600,
        width: 350,
      },
      personaOptions: { // 自定义取值参考：https://docs.nlkit.com/nlux/reference/ui/ai-chat#chat-personas
        assistant: {          name: '博主的AI助手，十四行诗参上！',
          // AI 助手的图标
          avatar: 'https://chen-yulin.github.io/thumb/14.png',
          tagline: '要不要试试问下面的问题呢？',
        }
      }
    }
  };
</script>
<style>
  :root {
    /* webchat 工具栏的颜色 */
    --webchat-toolbar-background-color: #1464E4;
    /* webchat 工具栏文字和按钮的颜色 */
    --webchat-toolbar-text-color: #FFF;
  }
  /* webchat 对话框如果被遮挡，可以尝试通过 z-index、bottom、left 等设置来调整位置 */
  .webchat-container {
    z-index: 100;
    bottom: 10px;
    right: 10px;
  }
  /* webchat 的唤起按钮如果被遮挡，可以尝试通过 z-index、bottom、left 等设置来调整位置 */
  .webchat-bubble-tip {
    z-index: 99;
    bottom: 60px;
    right: 20px;
  }
  .webchat-bubble-tip {
    overflow: visible !important;
  }
  @keyframes float {
    0% {
      transform: translateY(0px) translateX(-50%);
    }
    50% {
      transform: translateY(-10px) translateX(-50%);
    }
    100% {
      transform: translateY(0px) translateX(-50%);
    }
  }

  .webchat-bubble-tip::before {
    content: '';
    position: absolute;
    top: -25px;
    left: 70%;
    width: 40px;
    height: 40px;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3E%3Cpath d='M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: center;
    background-size: contain;
    filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.5));
    animation: float 3s ease-in-out infinite;
  }
</style><script data-pjax src="https://registry.npmmirror.com/oh-my-live2d/latest/files"></script><script>const oml2d = OML2D.loadOml2d({libraryUrls:{"complete":"https://registry.npmmirror.com/oh-my-live2d/latest/files/lib/complete.js","cubism2":"https://registry.npmmirror.com/oh-my-live2d/latest/files/lib/cubism2.js","cubism5":"https://registry.npmmirror.com/oh-my-live2d/latest/files/lib/cubism5.js"},dockedPosition:"left",mobileDisplay:true,models:[{"path":"https://model.hacxy.cn/mai/model.json","mobilePosition":[25,0],"mobileScale":0.1,"mobileStageStyle":{"width":125,"height":175},"motionPreloadStrategy":"ALL","position":[50,0],"scale":0.2,"stageStyle":{"width":250,"height":350}}],parentElement:document.body,primaryColor:"var(--btn-bg)",sayHello:false,tips:{style: {"width":230,"height":120,"left":"calc(50% - 20px)","top":"-100px"},mobileStyle: {"width":180,"height":80,"left":"calc(50% - 30px)","top":"-100px"},idleTips:{interval:15000,message:function(){
  return axios.get('https://v1.hitokoto.cn?c=i')
    .then(function (response) {
      return response.data.hitokoto ;
    })
    .catch(function (error) {
      console.error(error);
    });
}
}}});</script><!-- hexo injector body_end end --></body></html>